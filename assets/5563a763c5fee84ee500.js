"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[31488],{759731:(e,t,n)=>{n.r(t);n.d(t,{default:()=>w});var r=n(785893),s=n(667294),o=n(730381),i=n.n(o),a=n(517563),c=n(675860),l=n(365523),u=n(331535),d=n(823911),f=n(487502),p=n(173879),h=n(462428),m=n(932847),g=n(461061),N=n(959797),_=n(955438),x=n.n(_),v=n(511742),y=n.n(v),O=n(482311),b=n.n(O),j=n(803551),C=n.n(j);function T(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e){E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return E(e)}function P(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e,t){M=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return M(e,t)}var I=function(e){
return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function Z(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=E(e);if(t){var s=E(this).constructor;n=Reflect.construct(r,arguments,s)}else n=r.apply(this,arguments);return P(this,n)}}var B=function(e){var t=e.step,n=e.children;return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(u.X6,{className:x().sectionSubheader,variant:"heading-sm/semibold",children:N.Z.Messages.STEP_NUMBER.format({number:t})}),(0,r.jsx)(h.Z,{className:x().sectionSubtitle,size:h.Z.Sizes.SIZE_24,children:n})]})},S=function(e){var t=e.pin,n=e.timeRemaining;return(0,r.jsxs)(s.Fragment,{children:[(0,r.jsx)(u.xv,{className:x().pinNumber,variant:"text-sm/normal",children:t}),(0,r.jsx)(u.xv,{
className:x().pinExpiresText,tag:"strong",variant:"text-sm/normal",children:n})]})};const w=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&M(e,t)}(n,e);var t=Z(n);function n(){T(this,n);var e;(e=t.apply(this,arguments)).state={pin:"",currentTime:i()(),endTime:null,loading:!0,errorMessage:null};e.tick=function(){var t=e.state.endTime;e.setState({currentTime:i()()});if(null!=t&&i()().isAfter(t)){var n;null===(n=e.interval)||void 0===n||n.stop()}};e.getMinutesLeftText=function(){var t=e.state.endTime;return e.state.loading?N.Z.Messages.LOADING_YOUR_PIN:null!=t&&i()().isAfter(t)?N.Z.Messages.YOUR_PIN_IS_EXPIRED:null!=t?N.Z.Messages.YOUR_PIN_EXPIRES.format({time:t.fromNow()}):void 0};return e}var s=n.prototype;s.componentDidMount=function(){var e=this,t=a.parse(this.props.location.search),n=t.code,r=t.state
;m.default.track(g.rMx.ACCOUNT_LINK_STEP,{previous_step:"microsoft auth",current_step:"PIN code display",session_id:r,platform_type:g.ABu.XBOX});i().locale(window.navigator.userLanguage||window.navigator.language);c.Z.post({url:g.ANM.CONNECTIONS_CALLBACK_CONTINUATION("xbox"),body:{code:n,state:r},oldFormErrors:!0}).then((function(t){e.setState({pin:t.body.short_code,currentTime:i()(),endTime:i()(t.body.expires_at),loading:!1});e.interval=new l.Xp;e.interval.start(1e3,e.tick)})).catch((function(t){var n;try{n=t.body.message}catch(e){n=String(t)}m.default.track(g.rMx.ACCOUNT_LINK_FAILED,{error_message:n,status_code:t.status,link_method:"pin",current_step:"PIN code display",platform_type:g.ABu.XBOX});e.setState({errorMessage:n})}))};s.componentWillUnmount=function(){null!=this.interval&&this.interval.stop()};s.handleDone=function(){window.location=g.Z5c.CONNECTIONS(g.ABu.XBOX)};s.goBack=function(){window.history.back()};s.renderXboxButtons=function(){return(0,r.jsxs)("div",{
className:y().xboxButtonContainer,children:[(0,r.jsx)(d.Z.Button,{type:d.Z.Button.A,text:N.Z.Messages.CLOSE,style:y().gamepadButton,onClick:this.handleDone}),this.renderErrorMessage()]})};s.renderErrorMessage=function(){var e=this.state.errorMessage;return null==e?null:(0,r.jsxs)("div",{className:y().errorMessageContainer,children:[(0,r.jsx)(p.Z,{className:y().errorMessageIcon}),(0,r.jsx)("div",{className:y().errorMessage,children:e})]})};s.renderContent=function(){var e=this.state.pin,t=null==e?null:(0,r.jsx)(S,{pin:e,timeRemaining:this.getMinutesLeftText()});return(0,r.jsxs)("div",{className:y().pageWrapper,children:[(0,r.jsx)("img",{alt:"Discord",className:y().logo,src:b()}),(0,r.jsxs)(f.Z,{className:y().container,justify:f.Z.Justify.CENTER,align:f.Z.Align.CENTER,children:[(0,r.jsxs)(f.Z.Child,{className:x().leftPanel,children:[t,(0,r.jsx)(u.X6,{className:x().sectionTitle,variant:"heading-sm/semibold",children:N.Z.Messages.LINK_YOUR_DISCORD_ACCOUNT}),(0,r.jsx)(B,{step:1,
children:N.Z.Messages.XBOX_PIN_STEP1}),(0,r.jsx)(B,{step:2,children:N.Z.Messages.XBOX_PIN_STEP2}),(0,r.jsx)(B,{step:3,children:N.Z.Messages.XBOX_PIN_STEP3}),this.renderXboxButtons()]}),(0,r.jsx)(f.Z.Child,{className:y().rightPanel,children:(0,r.jsx)("img",{alt:"",className:y().image,src:C()})})]})]})};s.render=function(){return(0,r.jsx)(d.Z,{onAPressed:this.handleDone,onBPressed:this.goBack,children:this.renderContent()})};return n}(s.PureComponent)}}]);
//# sourceMappingURL=5563a763c5fee84ee500.js.map