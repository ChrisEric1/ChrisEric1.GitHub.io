"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[88782],{688782:(t,e,n)=>{n.r(e);n.d(e,{default:()=>V});var r=n(785893),o=n(667294),i=n(441143),c=n.n(i),a=n(363010),s=n(331535),l=n(881548),u=n(549425),p=n(705458),d=n(303540),f=n(23816),h=n(691869),y=n(172458),v=n(741738),b=n(640753),I=n(372196),O=n(367124),P=n(429753),g=n(761434),_=n(757987),x=n(67416),j=n(391595),E=n(461061),T=n(959797),m=n(524771),S=n.n(m);function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n;return t}function A(t){A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)};return A(t)}function C(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n)
;"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))));r.forEach((function(e){w(t,e,n[e])}))}return t}function M(t,e){e=null!=e?e:{};Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):function(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})));n.push.apply(n,r)}return n}(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}));return t}function Z(t,e){return!e||"object"!==k(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function L(t,e){L=Object.setPrototypeOf||function(t,e){t.__proto__=e;return t};return L(t,e)}var k=function(t){
return t&&"undefined"!=typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};function R(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(t){return!1}}();return function(){var n,r=A(t);if(e){var o=A(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Z(this,n)}}var D=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}});e&&L(t,e)}(n,t);var e=R(n);function n(){N(this,n);var t;(t=e.apply(this,arguments)).state=M(C({},(0,y.H2)()),{textFocused:!0,contentWarningProps:null});t.trackInvite=function(e){if(null!=e&&e.ok){var n=t.props,r=n.activity,o=n.channel,i=""
;switch(n.activityActionType){case E.mFx.JOIN:i="Invite to Join";break;case E.mFx.LISTEN:i="Invite to Listen";break;case E.mFx.WATCH:i="Invite to Watch"}f.ZP.trackWithMetadata(E.rMx.INVITE_SENT,{location:"Channel Text Area - ".concat(i),invite_type:r.type===E.IIU.LISTENING?E.dAT.SPOTIFY:E.dAT.APPLICATION,application_id:r.application_id,guild_id:o.getGuildId(),channel_id:o.id,message_id:null!=e?e.body.id:null});return Promise.resolve()}};t.handleTextChange=function(e,n,r){t.setState({textValue:n,richValue:r})};t.handleShare=function(){var e=t.props,n=e.channel,r=e.activity,o=e.activityActionType,i=e.cooldown,c=e.onClose,a=t.state,s=a.textValue,l=a.contentWarningProps;if(i>0)return Promise.resolve({shouldClear:!1,shouldRefocus:!0});var p=b.ZP.parse(n,s),d={activity:r,type:o};if(null!=l){t.setState({contentWarningProps:null});u.Z.sendMessage(n.id,p,!0,{activityAction:d}).then((function(e){return t.trackInvite(e)}));c();return Promise.resolve({shouldClear:!0,shouldRefocus:!0})}return(0,
j.v)({openWarningPopout:function(e){return t.setState({contentWarningProps:e})},type:h.I.FORM,content:s,channel:n}).then((function(e){if(!e.valid)return{shouldClear:!1,shouldRefocus:!1};u.Z.sendMessage(n.id,p,!0,{activityAction:d}).then((function(e){return t.trackInvite(e)}));c();return{shouldClear:!1,shouldRefocus:!1}}))};return t}var o=n.prototype;o.componentDidMount=function(){this.fetchApplication()};o.componentDidUpdate=function(t){this.props.activity.application_id!==t.activity.application_id&&this.fetchApplication()};o.fetchApplication=function(){var t=this.props,e=t.activity,n=t.application;null!=e.application_id&&null==n&&l.Z.fetchApplication(e.application_id)};o.renderTitle=function(){switch(this.props.activity.type){case E.IIU.LISTENING:return T.Z.Messages.INVITE_EMBED_LISTENING_INVITE;case E.IIU.PLAYING:case E.IIU.STREAMING:default:return T.Z.Messages.INVITE_EMBED_GAME_INVITE}};o.render=function(){
var t=this,e=this.state,n=e.textValue,o=e.richValue,i=e.textFocused,a=e.contentWarningProps,l=this.props,u=l.activity,f=l.analyticsLocations,y=l.channel,b=l.activityActionType,I=l.cooldown,O=l.application,P=l.transitionState,j=l.onClose,E=I>0,m=E?T.Z.Messages.CHANNEL_SLOWMODE_COOLDOWN.format({seconds:Math.round((I+1e3)/1e3)}):null;return(0,r.jsxs)(x.Y0,{size:x.Cg.SMALL,transitionState:P,"aria-label":this.renderTitle(),children:[(0,r.jsx)(x.xB,{separator:!1,children:(0,r.jsx)(s.X6,{variant:"heading-lg/semibold",children:this.renderTitle()})}),(0,r.jsxs)(x.hz,{children:[(0,r.jsx)("div",{className:S().subHeader,children:T.Z.Messages.MESSAGE_PREVIEW}),(0,r.jsx)(p.Z,{activityActionType:b,activity:u,className:S().preview,application:O,partyId:null!=u.party?u.party.id:null,isPreview:!0,analyticsLocations:f}),(0,r.jsx)("div",{className:S().subHeader,children:T.Z.Messages.ADD_A_COMMENT_OPTIONAL}),(0,r.jsx)(g.ZP,{position:g.ZP.Positions.TOP,onRequestClose:function(){var e
;null==a||null===(e=a.onCancel)||void 0===e||e.call(a);t.setState({contentWarningProps:null})},shouldShow:null!=a,renderPopout:function(t){var e=t.closePopout;c()(null!=a,"ActivityInvite.render - renderPopout: contentWarningProps cannot be null");return(0,r.jsx)(d.Z,C({onClose:e},a))},children:function(){return(0,r.jsx)(v.Z,{className:S().textArea,textValue:n,richValue:o,focused:i,channel:y,onChange:t.handleTextChange,onSubmit:t.handleShare,type:h.I.FORM})}})]}),(0,r.jsxs)(x.mz,{children:[(0,r.jsx)(_.ZP,{text:m,children:function(e){return(0,r.jsx)("div",M(C({},e),{children:(0,r.jsx)(s.zx,{disabled:E,onClick:t.handleShare,children:T.Z.Messages.INVITE_EMBED_SEND_INVITE})}))}}),(0,r.jsx)(s.zx,{look:s.zx.Looks.LINK,color:s.zx.Colors.PRIMARY,onClick:j,children:T.Z.Messages.CANCEL})]})]})};return n}(o.PureComponent);const V=a.ZP.connectStores([P.Z,O.Z],(function(t){var e=t.channel,n=t.activity;return{cooldown:P.Z.getSlowmodeCooldownGuess(e.id),
application:null!=n.application_id?O.Z.getGame(n.application_id):I.r9}}))(D)}}]);
//# sourceMappingURL=2d9d10fb54c46c2248d1.js.map