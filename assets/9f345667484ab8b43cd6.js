"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[89594],{189594:(e,n,t)=>{t.r(n);t.d(n,{default:()=>k});var r=t(785893),l=t(667294),o=t(294184),a=t.n(o),i=t(202351),s=t(945460),c=t(744564),u=t(486826),d=t(773011),h=t(239813),f=t(61209),p=t(5544),g=t(567403),m=t(682776),b=t(840922),O=t(715107),v=t(473903),y=t(124251),x=t(443812),M=t(777203),_=t(652591),L=t(2590),j=t(473708),w=t(621279),C=t.n(w);function F(e,n,t,r,l,o,a){try{var i=e[o](a),s=i.value}catch(e){t(e);return}i.done?n(s):Promise.resolve(s).then(r,l)}function I(e){return function(){var n=this,t=arguments;return new Promise((function(r,l){var o=e.apply(n,t);function a(e){F(o,r,l,a,i,"next",e)}function i(e){F(o,r,l,a,i,"throw",e)}a(void 0)}))}}function S(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function N(e){N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return N(e)}
function Z(e,n){return!n||"object"!==A(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function E(e,n){E=Object.setPrototypeOf||function(e,n){e.__proto__=n;return e};return E(e,n)}var A=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function T(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var t,r=N(e);if(n){var l=N(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return Z(this,t)}}var P=function(e,n){var t,r,l,o,a={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return o={next:i(0),throw:i(1),return:i(2)},
"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function i(o){return function(i){return function(o){if(t)throw new TypeError("Generator is already executing.");for(;a;)try{if(t=1,r&&(l=2&o[0]?r.return:o[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,o[1])).done)return l;(r=0,l)&&(o=[2&o[0],l.value]);switch(o[0]){case 0:case 1:l=o;break;case 4:a.label++;return{value:o[1],done:!1};case 5:a.label++;r=o[1];o=[0];continue;case 7:o=a.ops.pop();a.trys.pop();continue;default:if(!(l=a.trys,l=l.length>0&&l[l.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!l||o[1]>l[0]&&o[1]<l[3])){a.label=o[1];break}if(6===o[0]&&a.label<l[1]){a.label=l[1];l=o;break}if(l&&a.label<l[2]){a.label=l[2];a.ops.push(o);break}l[2]&&a.ops.pop();a.trys.pop();continue}o=n.call(e,a)}catch(e){o=[6,e];r=0}finally{t=l=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,i])}}};var D=function(e){!function(e,n){
if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}});n&&E(e,n)}(o,e);var n=T(o);function o(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,o);var l;(l=n.call(this,e)).handleGuildSelect=function(e){var n=l.props.guilds,t=l.state.selectedGuildId,r=n[e].channels,o=l.getDefaultChannelId(r);t!==e&&l.setState({selectedGuildId:e,selectedChannelId:o,channels:r})};l.handleChannelSelect=function(e){l.setState({selectedChannelId:e})};l.handleFollow=function(){var e=l.props,n=e.channel,o=e.onClose,a=l.state,i=a.selectedChannelId,d=a.selectedGuildId;if(null!=i){l.setState({submitting:!0});u.Z.createChannelFollower(i,n.id).then((function(){c.Z.dispatch({type:"CHANNEL_FOLLOWER_CREATED",channelId:i,guildId:d});o();(0,s.openModalLazy)(I((function(){var e,n;return P(this,(function(l){switch(l.label){
case 0:return[4,Promise.all([t.e(40532),t.e(92299)]).then(t.bind(t,692299))];case 1:e=l.sent(),n=e.default;return[2,function(e){return(0,r.jsx)(n,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))));r.forEach((function(n){S(e,n,t[n])}))}return e}({},e))}]}}))})))})).catch((function(e){e.body.code===L.evJ.TOO_MANY_WEBHOOKS?l.setState({errorMessage:j.Z.Messages.FOLLOW_MODAL_TOO_MANY_WEBHOOKS,submitting:!1}):l.setState({errorMessage:j.Z.Messages.FOLLOW_MODAL_FAIL,submitting:!1})}))}};var a=e.guilds,i=e.lastChannelFollowingDestination,d=i.guildId,h=i.channelId;l.state={selectedGuildId:d,selectedChannelId:h,channels:null!=d&&null!=a[d]?a[d].channels:[],errorMessage:null,submitting:!1,headerId:(0,x.hQ)("modal")};return l}var i=o.prototype;i.componentDidMount=function(){
_.default.track(L.rMx.OPEN_MODAL,{type:"Follow Channel Modal",num_guild_permissions:Object.keys(this.props.guilds).length,location:"Chat Input Blocker - Follow Channel"})};i.getDefaultChannelId=function(e){var n=e.find((function(e){var n=e.channel;return"general"===(0,d.F6)(n,v.default,b.Z)})),t=null!=n?n:e[0];return null!=t?t.channel.id:null};i.renderFooter=function(){var e=this.state,n=e.selectedGuildId,t=e.selectedChannelId,o=e.submitting,a=this.props.onClose;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(s.Button,{submitting:o,onClick:this.handleFollow,disabled:null==n||null==t,children:j.Z.Messages.FOLLOW}),(0,r.jsx)(s.Button,{look:s.Button.Looks.LINK,color:s.Button.Colors.PRIMARY,onClick:a,children:j.Z.Messages.CANCEL})]})};i.renderForm=function(){var e=this.props.guilds,n=this.state,t=n.channels,o=n.selectedGuildId,a=n.selectedChannelId,i=n.errorMessage,c=Object.keys(e).map((function(n){var t=e[n].guild;return{value:n,label:t.toString(),guild:t}})),u=t.map((function(e){
var n=e.channel,t=e.category;return{value:n.id,label:(0,d.F6)(n,v.default,b.Z),channel:n,category:t}})),f=0===c.length,p=f?j.Z.Messages.FOLLOW_MODAL_HINT_NO_PERMS:j.Z.Messages.FOLLOW_MODAL_HINT;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(s.FormItem,{className:C().bottomMargin,title:j.Z.Messages.FORM_LABEL_SEND_TO,children:(0,r.jsx)(s.SearchableSelect,{value:o,options:c,isDisabled:f,onChange:this.handleGuildSelect,renderOptionPrefix:function(e){return function(e){if(null==e)return null;var n=e.guild;return(0,r.jsx)(y.Z,{guild:n,size:y.Z.Sizes.MINI})}(e)}})}),(0,r.jsx)(s.FormItem,{className:C().bottomMargin,title:j.Z.Messages.FORM_LABEL_SELECT_CHANNEL,children:(0,r.jsx)(s.SearchableSelect,{value:a,options:u,isDisabled:0===u.length,onChange:this.handleChannelSelect,renderOptionPrefix:function(e){return function(e){if(null==e)return null;var n=e.channel,t=(0,h.KS)(n);return null!=t&&(0,r.jsx)(t,{width:16,height:16,className:C().icon})}(e)}})}),(0,r.jsx)(s.Text,{
variant:"text-sm/normal",color:f||null!=i?"text-danger":"text-muted",className:C().bottomMargin,children:null!=i?i:p})]})};i.renderBody=function(){var e=this.props.channel.nsfw;return(0,r.jsxs)("div",{className:C().body,children:[(0,r.jsx)(s.Heading,{variant:"heading-lg/semibold",id:this.state.headerId,children:j.Z.Messages.FOLLOW_MODAL_TITLE}),(0,r.jsx)(s.Text,{color:"text-muted",className:a()(C().topMargin,S({},C().formMargin,!e)),variant:"text-sm/normal",children:j.Z.Messages.FOLLOW_MODAL_BODY}),e?(0,r.jsx)(s.Text,{className:a()(C().formMargin,C().topMargin),color:"text-danger",variant:"text-sm/normal",children:j.Z.Messages.FOLLOW_MODAL_WARNING}):null]})};i.renderHeader=function(){var e,n=this.props,t=n.guildToFollow,l=n.channelNameToFollow,o=n.channel,a=null!==(e=(0,h.KS)(o))&&void 0!==e?e:M.Z;return(0,r.jsxs)(s.ModalHeader,{className:C().header,children:[(0,r.jsx)(y.Z,{guild:t,size:y.Z.Sizes.LARGE}),(0,r.jsx)("div",{className:C().channelContainer,children:(0,r.jsxs)("div",{
className:C().channel,children:[(0,r.jsx)(a,{width:20,height:20,className:C().channelIcon}),(0,r.jsx)(s.Text,{variant:"text-md/medium",className:C().channelName,children:l})]})})]})};i.render=function(){var e=this.props.transitionState;return(0,r.jsxs)(s.ModalRoot,{transitionState:e,"aria-labelledby":this.state.headerId,children:[this.renderHeader(),(0,r.jsxs)(s.ModalContent,{className:C().content,children:[this.renderBody(),this.renderForm()]}),(0,r.jsx)(s.ModalFooter,{children:this.renderFooter()})]})};return o}(l.PureComponent);const k=i.ZP.connectStores([g.Z,f.Z,p.ZP,m.Z,O.Z],(function(e){var n=e.channel,t=g.Z.getGuild(n.guild_id),r=Object.values(g.Z.getGuilds()).reduce((function(e,n){var t=p.ZP.getChannels(n.id).SELECTABLE.map((function(e){return e.channel})).filter((function(e){return e.type===L.d4z.GUILD_TEXT&&m.Z.can(L.Plq.MANAGE_WEBHOOKS,e)})).map((function(e){var n=f.Z.getChannel(e.parent_id);return{channel:e,category:null!=n?n.name:null}}));t.length>0&&(e[n.id]={guild:n,
channels:t});return e}),{}),l=O.Z.getLastChannelFollowingDestination();return{guildToFollow:t,channelNameToFollow:n.name,guilds:r,lastChannelFollowingDestination:null!=l?l:{}}}),{forwardRef:!0})(D)}}]);
//# sourceMappingURL=9f345667484ab8b43cd6.js.map