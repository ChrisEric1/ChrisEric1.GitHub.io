"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[51934],{986304:(e,t,r)=>{r.d(t,{J:()=>b});var n=r(441143),a=r.n(n),i=r(685269),o=r(717035),s=r(27059),l=r(652591),c=r(782786),u=r(83471),p=r(2590),f=r(203600);function d(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))));n.forEach((function(t){d(e,t,r[t])}))}return e}function m(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){
return Object.getOwnPropertyDescriptor(e,t).enumerable})));r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}));return e}function b(e){var t=e.analyticsData,r=e.initialPlanId,n=e.breadcrumbSteps,d=e.handleStepChange,b=e.referralTrialOfferId,h=(0,c.usePaymentContext)(),E=h.contextMetadata,O=h.step,P=h.paymentSources,T=h.paymentSourceId,v=h.setPaymentSourceId,g=h.purchaseError,S=h.setPurchaseError,_=h.purchaseErrorBlockRef,I=h.paymentAuthenticationState,A=h.isGift,N=h.selectedSkuId,j=m(y({},(0,s.fL)()),{paymentSources:P,paymentSourceId:T,setPaymentSourceId:v,purchaseError:g,setPurchaseError:S,purchaseErrorBlockRef:_,paymentAuthenticationState:I}),x=(0,o.N)(b),w=!A&&null!=x&&null!=N&&f.nG[x.trial_id].skus.includes(N);a()(O,"Step should be set here");var M=(0,i.Z)((function(){return Date.now()}),[O]);return(0,s.vP)({paymentModalArgs:j,initialStep:u.h8.PAYMENT_TYPE,prependSteps:[u.h8.PROMOTION_INFO],
appendSteps:[u.h8.REVIEW,u.h8.CONFIRM],breadcrumpSteps:n,currentBreadcrumpStep:O,usePaymentModalStep:!0,onReturn:function(){var e=Object.values(P).length<1&&null==r?u.h8.PLAN_SELECT:u.h8.REVIEW;d(e,u.h8.PAYMENT_TYPE)},onComplete:function(e){d(u.h8.REVIEW,e)},onStepChange:function(e){var r=e.currentStep,n=e.toStep,a=Date.now();l.default.track(p.rMx.PAYMENT_FLOW_STEP,m(y({},t),{from_step:r,to_step:n,step_duration_ms:a-M,flow_duration_ms:a-E.startTime}))},isEligibleForTrial:w})}},493957:(e,t,r)=>{r.d(t,{Z:()=>c});var n=r(785893),a=(r(667294),r(554189)),i=r(128059),o=r(149096),s=r(894123),l=r.n(s);function c(){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{}),(0,n.jsx)(o.C3,{children:(0,n.jsx)(a.F,{className:l().awaitingAuthenticationStep})})]})}},806706:(e,t,r)=>{r.d(t,{Z:()=>T});var n=r(785893),a=r(667294),i=r(315804),o=r(945460),s=r(107364),l=r(473708),c=r(916217),u=r.n(c),p=function(e){var t=e.className,r=e.isEmailResent,a=e.resendEmail;return(0,n.jsx)("div",{className:t,
children:(0,n.jsxs)("div",{className:u().awaitingWrapper,children:[(0,n.jsx)(o.Heading,{variant:"heading-xl/bold",children:l.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_HEADER}),(0,n.jsxs)("p",{children:[(0,n.jsx)(o.Text,{variant:"text-md/normal",children:l.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL}),(0,n.jsx)("br",{}),(0,n.jsx)(o.Text,{variant:"text-md/normal",children:l.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_INSTRUCTIONS}),(0,n.jsx)("br",{}),(0,n.jsxs)(o.Text,{variant:"text-md/normal",children:[l.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_PROMPT,"Â ",r?l.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_SENT:(0,n.jsx)(o.Anchor,{onClick:a,children:l.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_ACTION})]})]})]})})},f=function(){return(0,n.jsx)("div",{children:(0,n.jsx)(o.ModalFooter,{justify:s.Z.Justify.BETWEEN,align:s.Z.Align.CENTER,
children:(0,n.jsx)(o.Button,{"data-testid":"continue",color:o.Button.Colors.BRAND,disabled:!0,children:l.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_NEXT_BUTTON})})})},d=r(128059),y=r(149096),m=r(379466),b=r.n(m);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function E(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){r(e);return}s.done?t(l):Promise.resolve(l).then(n,a)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done);o=!0){i.push(n.value);if(t&&i.length===t)break}}catch(e){s=!0;a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return h(e,t);var r=Object.prototype.toString.call(e).slice(8,-1)
;"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var P=function(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;(n=0,a)&&(i=[2&i[0],a.value]);switch(i[0]){case 0:case 1:a=i;break;case 4:o.label++;return{value:i[1],done:!1};case 5:o.label++;n=i[1];i=[0];continue;case 7:
i=o.ops.pop();o.trys.pop();continue;default:if(!(a=o.trys,a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1];a=i;break}if(a&&o.label<a[2]){o.label=a[2];o.ops.push(i);break}a[2]&&o.ops.pop();o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e];n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function T(){var e,t,r=O(a.useState(!1),2),o=r[0],s=r[1],l=(t=(e=function(){return P(this,(function(e){switch(e.label){case 0:s(!0);return[4,(0,i.xA)()];case 1:e.sent();return[2]}}))},function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){E(i,n,a,o,s,"next",e)}function s(e){E(i,n,a,o,s,"throw",e)}o(void 0)}))}),function(){return t.apply(this,arguments)});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.Z,{}),(0,n.jsx)(y.C3,{children:(0,n.jsx)(p,{className:b().body,isEmailResent:o,resendEmail:l})}),(0,
n.jsx)(y.O3,{children:(0,n.jsx)(f,{})})]})}},28648:(e,t,r)=>{r.d(t,{Z:()=>s});var n=r(785893),a=(r(667294),r(945460)),i=r(24193),o=r.n(i);function s(){return(0,n.jsx)(a.Spinner,{className:o().spinner})}},837598:(e,t,r)=>{r.d(t,{sE:()=>o});var n=r(260561),a=r(850841),i=(0,n.B)({kind:"user",id:"2022-06_no_payment_info_trial",label:"No Payment Info Trial",defaultConfig:{bypassCheckout:!1},treatments:[{id:1,label:"Bypass collecting payment info",config:{bypassCheckout:!0}}]}),o=function(e,t,r){var n=i.useExperiment({},{autoTrackExposure:!1}).bypassCheckout,o=function(e,t,r){var n=null==r||(0,a.uZ)(r);return null!=e&&null==t&&n}(e,t,r);return n&&o}},509897:(e,t,r)=>{r.d(t,{Z:()=>l});var n=r(785893),a=(r(667294),r(945460)),i=r(473708),o=r(362601),s=r.n(o);const l=function(e){var t=e.onClick;return(0,n.jsx)(a.Anchor,{onClick:t,className:s().link,children:i.Z.Messages.BACK})}},111090:(e,t,r)=>{r.d(t,{w:()=>p,H:()=>d})
;var n=r(667294),a=r(202351),i=r(105783),o=r(551778),s=r(151367),l=r(850841),c=r(520453),u=r(473708);function p(e,t,r){n.useEffect((function(){if(null!=e&&e.isPurchasedExternally&&null!=e.paymentGateway&&!r){i.Z.show({title:u.Z.Messages.BILLING_EXTERNAL_HEADER.format({paymentGatewayName:c.Vz[e.paymentGateway]}),body:u.Z.Messages.BILLING_EXTERNAL_MANAGE_ELSEWHERE.format({paymentGatewayName:c.Vz[e.paymentGateway],subscriptionManagementLink:(0,l.JE)(e.paymentGateway,"SUBSCRIPTION_MANAGEMENT")}),confirmText:u.Z.Messages.OKAY});t()}}),[e])}var f=[];function d(e,t){var r=(0,a.e7)([o.Z],(function(){return o.Z.get(e)})),i=(0,a.e7)([s.Z],(function(){var e;return null!=r&&null!==(e=s.Z.getForSku(r.skuId))&&void 0!==e?e:f})),c=n.useMemo((function(){return Array.from(i).filter((function(e){var t=e.parentId,r=e.consumed;return null!=t&&!r}))}),[i]);return{hasEntitlements:!t&&null!=r&&null!=c&&c.length>=l.ZP.getIntervalMonths(r.interval,r.intervalCount),entitlements:c}}},16097:(e,t,r)=>{r.d(t,{
Z:()=>R});var n=r(785893),a=(r(667294),r(441143)),i=r.n(a),o=r(197597),s=r(202351),l=r(336194),c=r(945460),u=r(415324),p=r(152042),f=r(700812),d=r(26529),y=r(414094),m=r(632826),b=r(837598),h=r(793461),E=r(615796),O=r(551778),P=r(386991),T=r(850841),v=r(249052),g=r(100749),S=r(16703),_=r(900547),I=r(646875),A=r(111090),N=r(2590),j=r(520453),x=r(473708),w=r(121466),M=r.n(w);function L(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done);o=!0){i.push(n.value);if(t&&i.length===t)break}}catch(e){s=!0;a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return L(e,t);var r=Object.prototype.toString.call(e).slice(8,-1)
;"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return L(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e){var t,r=e.selectedPlanId,a=e.paymentSources,w=e.priceOptions,L=e.currencies,R=e.onCurrencyChange,Z=e.isGift,k=void 0!==Z&&Z,D=e.onPaymentSourceChange,G=e.handlePaymentSourceAdd,U=e.setHasAcceptedTerms,B=e.legalTermsNodeRef,F=e.hasLegalTermsFlash,H=e.trialId,W=e.trialFooterMessageOverride,Y=e.reviewWarningMessage,K=e.metadata,V=e.purchaseState,J=e.hideSubscriptionDetails,q=e.referralTrialOfferId,Q=e.isTrial,X=void 0!==Q&&Q,$=(0,s.e7)([O.Z],(function(){return O.Z.get(r)}));i()(null!=$,"Missing plan");var z,ee,te=[{planId:$.id,quantity:1}],re=V===m.A.PURCHASING||V===m.A.COMPLETED,ne=k||re,ae=C((0,g.ED)({items:te,
renewal:!1,preventFetch:ne,applyEntitlements:!0,paymentSourceId:w.paymentSourceId,currency:w.currency,trialId:H,metadata:K}),2),ie=ae[0],oe=ae[1],se=C((0,g.ED)({items:te,renewal:!0,preventFetch:ne,trialId:H,paymentSourceId:w.paymentSourceId,currency:w.currency,metadata:K}),2),le=se[0],ce=se[1],ue=null!=oe?oe:ce,pe=(0,s.e7)([h.Z],(function(){return h.Z.enabled})),fe=w.paymentSourceId,de=(0,A.H)($.id,k),ye=de.hasEntitlements,me=de.entitlements,be=(0,T.Ap)(w.paymentSourceId),he=(0,b.sE)(H,fe,r);if(null!=ue){var Ee=ue.message;ue.code===y.SM.INVALID_CURRENCY_FOR_PAYMENT_SOURCE&&(Ee=x.Z.Messages.BILLING_ERROR_UNSUPPORTED_CURRENCY);return(0,n.jsx)(c.FormErrorBlock,{children:Ee})}if(k)ee=(0,n.jsx)(I.e9,{paymentSourceId:w.paymentSourceId,plan:$,className:M().invoice,isPrepaidPaymentSource:be});else if(X&&null!=ie)ee=(0,n.jsxs)("div",{children:[(0,n.jsx)(S.KU,{negativeMarginTop:!0}),(0,n.jsxs)(S.PO,{className:M().invoice,children:[(0,n.jsxs)("div",{className:M().trialPriceLine,children:[(0,
n.jsx)(c.Text,{variant:"text-md/bold",children:x.Z.Messages.BILLING_PAYMENT_BREAKDOWN_TOTAL}),(0,n.jsx)(c.Text,{variant:"text-md/normal",children:x.Z.Messages.BILLING_TRIAL_PRICE_NOW.format({price:(0,v.T4)(0,ie.currency,{maximumFractionDigits:0})})})]}),(0,n.jsx)("div",{className:M().afterTrialPriceLine,children:(0,n.jsx)(I.yT,{invoice:ie,plan:$})})]})]});else{if(null==ie||null==le)return(0,n.jsx)(c.Spinner,{});X&&ie.subscriptionPeriodEnd!==le.subscriptionPeriodEnd&&(z=ie.subscriptionPeriodEnd);ee=(0,n.jsxs)(S.PO,{className:M().invoice,children:[(0,n.jsx)(S.q9,{children:x.Z.Messages.BILLING_SWITCH_PLAN_PURCHASE_DETAILS}),(0,n.jsx)(I.Lu,{invoice:ie,newPlan:$,isPrepaidPaymentSource:be,referralTrialOfferId:q}),be?null:(0,n.jsx)(I.nd,{renewalInvoice:le,isTrial:X,priceOptions:w,overrideRenewalDate:z,trialFooterMessageOverride:W,hideSubscriptionDetails:J})]})}var Oe=o.M.EEA_COUNTRIES.has(E.Z.ipCountryCodeWithFallback),Pe=function(e,t,r){var n=null,a=null,i=null;if(e&&null!=t){
var o=T.ZP.getIntervalForInvoice(t),s=o.intervalType,l=o.intervalCount,c=(0,v.og)((0,v.T4)(t.total,t.currency),s,l),u=null!=r?r:t.subscriptionPeriodEnd;n=x.Z.Messages.BILLING_LEGAL_MUMBO_JUMBO_TRIAL_TERMS_LABEL.format({termsURL:N.EYA.TERMS,paidURL:N.EYA.PAID_TERMS,rate:c,renewalDate:u});a=M().trialCheckbox;i=M().trialCheckboxLabel}return{checkboxLabel:n,checkboxClassname:a,checkboxLabelClassname:i}}(null!=X&&X,le,z),Te=Pe.checkboxLabel,ve=Pe.checkboxClassname,ge=Pe.checkboxLabelClassname,Se=x.Z.Messages.BILLING_SELECT_PLAN_GUILD_SUBSCRIPTION.format({planName:$.name});k?Se=x.Z.Messages.PAYMENT_MODAL_SUBTITLE_PREMIUM_GIFT:(0,T.PV)($.id)&&(Se=T.ZP.getBillingReviewSubheader(null,$));return he?null:(0,n.jsxs)("div",{className:M().stepBody,children:[null!=Y&&(0,n.jsxs)("div",{className:M().reviewWarningMessageContainer,children:[(0,n.jsx)(P.Z,{color:l.Z.unsafe_rawColors.YELLOW_300.css,width:20,height:20}),(0,n.jsx)(c.Text,{className:M().reviewWarningMessage,variant:"text-sm/normal",
children:Y})]}),!X&&(0,n.jsx)(c.FormTitle,{tag:c.FormTitleTags.H5,children:Se}),ee,(0,n.jsxs)("div",{className:M().paymentSourceWrapper,children:[X?(0,n.jsx)(c.FormTitle,{tag:c.FormTitleTags.H5,className:M().formTitle,children:x.Z.Messages.BILLING_STEP_PAYMENT_METHOD}):(0,n.jsx)(c.FormTitle,{tag:c.FormTitleTags.H5,children:x.Z.Messages.PAYMENT_SOURCE_PAYMENT_REQUEST_INFO_TITLE}),(0,n.jsx)(f.Z,{paymentSources:Object.values(a),selectedPaymentSourceId:fe,prependOption:ye?{label:x.Z.Messages.ATTACH_PAYMENT_SOURCE_PROMPT_OPTION_OPTIONAL,value:null}:null,onChange:D,onPaymentSourceAdd:G,hidePersonalInformation:pe}),ye&&null==fe?(0,n.jsx)("div",{className:M().paymentSourceOptionalWarning,children:x.Z.Messages.ATTACH_PAYMENT_SOURCE_OPTIONAL_WITH_ENTITLEMENTS_WARNING.format({months:me.length})}):null,(0,n.jsxs)(u.b,{currencies:L,className:M().currencyWrapper,children:[(0,n.jsx)(c.FormTitle,{tag:c.FormTitleTags.H5,children:x.Z.Messages.PAYMENT_CURRENCY}),(0,n.jsx)(u.Z,{
selectedCurrency:w.currency,currencies:L,onChange:R})]})]}),(0,n.jsx)(_.Z,{isActive:F,ref:B,children:(0,n.jsx)(d.Z,{onChange:U,forceShow:!0,checkboxLabel:Te,checkboxClassname:ve,checkboxLabelClassname:ge,finePrint:(0,n.jsx)(p.Z,{hide:X,subscriptionPlan:$,isGift:k,paymentSourceType:null===(t=a[null!=fe?fe:""])||void 0===t?void 0:t.type}),showPricingLink:$.currency!==j.pK.USD,showWithdrawalWaiver:Oe,disabled:re,isTrial:X,subscriptionPlan:$,isGift:k})})]})}},619244:(e,t,r)=>{r.d(t,{Z:()=>ce});var n=r(785893),a=r(667294),i=r(441143),o=r.n(i),s=r(202351),l=r(945460),c=r(673679),u=r(19585),p=r(782786),f=r(744564),d=r(933599),y=r(665082),m=r(315804),b=r(54709),h=r(652591),E=r(264628),O=r(850841),P=r(632826),T=r(2590),v=r(203600);function g(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){r(e);return}s.done?t(l):Promise.resolve(l).then(n,a)}function S(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var i=e.apply(t,r);function o(e){g(i,n,a,o,s,"next",e)}
function s(e){g(i,n,a,o,s,"throw",e)}o(void 0)}))}}function _(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))));n.forEach((function(t){_(e,t,r[t])}))}return e}function A(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}));return e}var N=function(e,t){var r,n,a,i,o={label:0,
sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;(n=0,a)&&(i=[2&i[0],a.value]);switch(i[0]){case 0:case 1:a=i;break;case 4:o.label++;return{value:i[1],done:!1};case 5:o.label++;n=i[1];i=[0];continue;case 7:i=o.ops.pop();o.trys.pop();continue;default:if(!(a=o.trys,a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1];a=i;break}if(a&&o.label<a[2]){o.label=a[2];o.ops.push(i);break}a[2]&&o.ops.pop();o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e];n=0}finally{r=a=0}if(5&i[0])throw i[1];return{
value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function j(e){return x.apply(this,arguments)}function x(){return(x=S((function(e){var t,r,n,a,i,o,s,l,u,p,g,S,_,j,x,w,M,L,C,R,Z,k,D,G,U,B,F,H,W;return N(this,(function(N){switch(N.label){case 0:t=e.setPurchaseState,r=e.setHasAcceptedTerms,n=e.setIsSubmitting,a=e.setPurchaseError,i=e.hasRedirectURL,o=e.setHasRedirectURL,s=e.isGift,l=e.giftStyle,u=e.baseAnalyticsData,p=e.analyticsLocation,g=e.analyticsLocations,S=e.flowStartTime,_=e.subscriptionPlan,j=e.planGroup,x=e.trialId,w=e.priceOptions,M=e.paymentSource,L=e.isPrepaidPaymentPastDue,C=e.openInvoiceId,R=e.premiumSubscription,Z=e.onNext,k=e.metadata;t(P.A.PURCHASING);r(!0);n(!0);f.Z.wait(d.fw);a(null);N.label=1;case 1:N.trys.push([1,13,14,15]);h.default.track(T.rMx.PAYMENT_FLOW_COMPLETED,A(I({},u),{duration_ms:Date.now()-S}));if(i)return[2];if(!s)return[3,3];if("usd"===(G=(0,O.aS)(_.id,!1,!0,w)).currency&&(null==M?void 0:M.type)===T.HeQ.GCASH){U=new Error("Invalid USD currency for GCash");(0,
E.q2)(U,{tags:{paymentSourceId:null!==(B=null==M?void 0:M.id)&&void 0!==B?B:"",subscriptionPlanId:_.id,priceOptions:JSON.stringify(w)}})}return[4,(0,m.ZZ)(v.RQ,_.skuId,{expectedAmount:G.amount,expectedCurrency:G.currency,paymentSource:M,subscriptionPlanId:_.id,isGift:!0,giftStyle:l})];case 2:D=N.sent();return[3,12];case 3:return L&&null!=C&&null!=M&&null!=R?T.Uk1.has(M.type)?[4,(0,c.G)(R,C,M,w.currency)]:[3,5]:[3,8];case 4:F=N.sent();return[3,7];case 5:return[4,(0,c.Mg)(R,{paymentSource:M,currency:w.currency},g,p)];case 6:F=N.sent();N.label=7;case 7:D=F;return[3,12];case 8:return null==R?[3,10]:[4,(0,c.Mg)(R,{items:(0,O.al)(R,_.id,1,new Set(j)),paymentSource:M,currency:w.currency},g,p)];case 9:D=N.sent();return[3,12];case 10:return[4,(0,y.Ld)({planId:_.id,currency:w.currency,paymentSource:M,trialId:x,metadata:k})];case 11:D=N.sent();N.label=12;case 12:if(D.redirectConfirmation){o(null!=D.redirectURL);return[2]}h.default.track(T.rMx.PAYMENT_FLOW_SUCCEEDED,A(I({},u),{
duration_ms:Date.now()-S,payment_source_type:null==M?void 0:M.type}));t(P.A.COMPLETED);if("subscription"in D){H=null!=D.subscription?b.Z.createFromServer(D.subscription):null;Z(H)}else Z();return[3,15];case 13:W=N.sent();t(P.A.FAIL);a(W);h.default.track(T.rMx.PAYMENT_FLOW_FAILED,A(I({},u),{payment_source_id:null==M?void 0:M.id,payment_source_type:null==M?void 0:M.type,duration_ms:Date.now()-S}));return[3,15];case 14:i||n(!1);return[7];case 15:return[2]}}))}))).apply(this,arguments)}var w=r(300615),M=r(837598),L=r(872587),C=r(856281),R=r(711531),Z=r(909365),k=r(107364),D=r(499171),G=r(509897),U=r(111090),B=r(709189),F=r(530562),H=r(473708),W=r(775385),Y=r.n(W),K=r(497206),V=r.n(K);function J(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r)
;"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))));n.forEach((function(t){J(e,t,r[t])}))}return e}function Q(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}));return e}function X(e,t){if(null!=e.current){e.current.scrollIntoView({behavior:"smooth"});t()}}function $(e){
var t=e.legalTermsNodeRef,r=e.invoiceError,a=e.planError,i=e.disablePurchase,s=e.flashLegalTerms,c=e.isSubmitting,u=e.premiumSubscription,f=e.isGift,d=e.planGroup,y=e.isPrepaid,m=e.isTrial,b=e.makePurchase,h=e.needsPaymentSource,E=(0,p.usePaymentContext)(),P=E.selectedPlan,T=E.hasAcceptedTerms;o()(null!=P,"Subscription plan must be selected to render SubscriptionReviewButton");var v=function(e,t,r,n,a){return r?H.Z.Messages.PAYMENT_MODAL_BUTTON_PREMIUM_GIFT:(0,O.PV)(e.id)?a?H.Z.Messages.BILLING_SELECT_PLAN:null!=t?(0,F.R4)(t,e.id,n)?H.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE:H.Z.Messages.BILLING_SWITCH_PLAN_CHANGE:(0,O.W_)(null,e):H.Z.Messages.BILLING_SUBSCRIBE_TO_PLAN}(P,u,f,d,y);return null!=r||null!=a||i?(0,n.jsx)(l.Button,{color:l.Button.Colors.GREEN,disabled:!0,children:v}):h?(0,n.jsx)(l.Tooltip,{text:H.Z.Messages.BILLING_SELECT_PAYMENT_SOURCE_TOOLTIP,children:function(e){return(0,n.jsx)(l.Button,Q(q({},e),{color:l.Button.Colors.GREEN,type:"submit","data-testid":"submitButton",
disabled:!0,children:v}))}}):m?(0,n.jsxs)(B.C,{innerClassName:Y().innerButton,"data-testid":T?"purchase":"submitButton",onClick:T?b:function(){return X(t,s)},color:l.Button.Colors.GREEN,submitting:c,children:[(0,n.jsx)("img",{alt:"",className:Y().nitroIcon,src:V()}),v]}):T?(0,n.jsx)(l.Button,{"data-testid":"purchase",onClick:b,color:l.Button.Colors.GREEN,submitting:c,children:v}):(0,n.jsx)(l.Tooltip,{text:H.Z.Messages.BILLING_ACCEPT_TERMS_PAID_SERVICES_TOOLTIP,children:function(e){return(0,n.jsx)(l.Button,Q(q({},e),{color:l.Button.Colors.GREEN,type:"submit",onClick:function(){return X(t,s)},"data-testid":"submitButton",children:v}))}})}var z=r(82368),ee=r.n(z);function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function re(e,t,r,n,a,i,o){try{var s=e[i](o),l=s.value}catch(e){r(e);return}s.done?t(l):Promise.resolve(l).then(n,a)}function ne(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){
var i=e.apply(t,r);function o(e){re(i,n,a,o,s,"next",e)}function s(e){re(i,n,a,o,s,"throw",e)}o(void 0)}))}}function ae(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r;return e}function ie(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))));n.forEach((function(t){ae(e,t,r[t])}))}return e}function oe(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){
Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}));return e}function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,i=[],o=!0,s=!1;try{for(r=r.call(e);!(o=(n=r.next()).done);o=!0){i.push(n.value);if(t&&i.length===t)break}}catch(e){s=!0;a=e}finally{try{o||null==r.return||r.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return te(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return te(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var le=function(e,t){var r,n,a,i,o={label:0,
sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;(n=0,a)&&(i=[2&i[0],a.value]);switch(i[0]){case 0:case 1:a=i;break;case 4:o.label++;return{value:i[1],done:!1};case 5:o.label++;n=i[1];i=[0];continue;case 7:i=o.ops.pop();o.trys.pop();continue;default:if(!(a=o.trys,a=a.length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1];a=i;break}if(a&&o.label<a[2]){o.label=a[2];o.ops.push(i);break}a[2]&&o.ops.pop();o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e];n=0}finally{r=a=0}if(5&i[0])throw i[1];return{
value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};function ce(e){var t=e.premiumSubscription,r=e.setPurchaseState,i=e.onBack,f=e.onNext,d=e.legalTermsNodeRef,y=e.flashLegalTerms,m=e.invoiceError,b=e.planError,E=e.onPurchaseError,v=e.baseAnalyticsData,g=e.flowStartTime,S=e.isGift,_=void 0!==S&&S,I=e.giftStyle,A=e.trialId,N=e.planGroup,x=e.analyticsLocation,B=e.purchaseTokenAuthState,F=e.openInvoiceId,H=e.metadata,W=e.backButtonEligible,Y=e.disablePurchase,K=e.isTrial,V=void 0!==K&&K,J=(0,p.usePaymentContext)(),q=J.selectedPlan,Q=J.priceOptions,X=J.setHasAcceptedTerms,z=J.setPurchaseError;o()(null!=q,"Missing subscriptionPlan");var te=null==q?void 0:q.id,re=(0,M.sE)(A,Q.paymentSourceId,te),ae=(0,s.e7)([C.Z],(function(){return C.Z.popupCallbackCalled})),ce=(0,u.Z)().analyticsLocations,ue=L.Z.getCurrentConfig({},{autoTrackExposure:!0}).enabled;o()(null!=q,"Missing subscriptionPlan");var pe,fe=Q.paymentSourceId,de=(0,s.e7)([R.Z],(function(){return null!=fe?R.Z.getPaymentSource(fe):null
})),ye=se(a.useState(re),2),me=ye[0],be=ye[1],he=se(a.useState(!1),2),Ee=he[0],Oe=he[1],Pe=(0,U.H)(te,_).hasEntitlements,Te=(0,O.Ap)(Q.paymentSourceId),ve=Pe||re,ge=(0,D.U)(),Se=(pe=ne((function(){return le(this,(function(e){switch(e.label){case 0:o()(null!=de||ve,"Missing paymentSource");return[4,j({setPurchaseState:r,setHasAcceptedTerms:X,setIsSubmitting:be,setPurchaseError:z,hasRedirectURL:Ee,setHasRedirectURL:Oe,isGift:_,giftStyle:I,baseAnalyticsData:v,analyticsLocation:x,analyticsLocations:ce,flowStartTime:g,subscriptionPlan:q,planGroup:N,trialId:A,priceOptions:Q,paymentSource:de,isPrepaidPaymentPastDue:ge,openInvoiceId:F,premiumSubscription:t,onNext:f,metadata:H})];case 1:e.sent();return[2]}}))})),function(){return pe.apply(this,arguments)});a.useEffect((function(){var e=function(){var e=ne((function(){var e;return le(this,(function(t){switch(t.label){case 0:if(!0!==ae)return[3,6];t.label=1;case 1:t.trys.push([1,3,4,5]);return null==C.Z.redirectedPaymentId?[2]:[4,(0,
c.OP)(C.Z.redirectedPaymentId)];case 2:t.sent();h.default.track(T.rMx.PAYMENT_FLOW_SUCCEEDED,oe(ie({},v),{duration_ms:Date.now()-g,payment_source_type:null==de?void 0:de.type}));r(P.A.COMPLETED);f();return[3,5];case 3:e=t.sent();r(P.A.FAIL);E(e);h.default.track(T.rMx.PAYMENT_FLOW_FAILED,oe(ie({},v),{payment_source_id:fe,payment_source_type:null==de?void 0:de.type,duration_ms:Date.now()-g}));return[3,5];case 4:be(!1);(0,c.K2)();return[7];case 5:return[3,8];case 6:return B!==Z.I.SUCCESS?[3,8]:[4,Se()];case 7:t.sent();t.label=8;case 8:return[2]}}))}));return function(){return e.apply(this,arguments)}}();e()}),[ae]);a.useEffect((function(){re&&!_&&null==t&&Se()}),[re,_,t]);var _e=null!=F;return re?null:(0,n.jsxs)(l.ModalFooter,{align:k.Z.Align.CENTER,children:[(0,n.jsx)($,{legalTermsNodeRef:d,invoiceError:m,planError:b,disablePurchase:Y,flashLegalTerms:y,isSubmitting:me,premiumSubscription:t,isGift:_,planGroup:N,isPrepaid:Te,isTrial:V,makePurchase:Se,needsPaymentSource:null==de&&!ve
}),ue?(0,n.jsx)(w.Z,{}):null,W&&!_e?(0,n.jsx)("div",{className:ee().back,children:(0,n.jsx)(G.Z,{onClick:i})}):null]})}}}]);
//# sourceMappingURL=272c8bcddc2beb92bec9.js.map