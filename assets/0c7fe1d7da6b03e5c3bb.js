(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[78521],{429547:(e,t,n)=>{e.exports=n.p+"750214196f39660492a313dbe5c84fe4.svg"},834005:(e,t,n)=>{e.exports=n.p+"68458539d5672f6045fff5d505dd566a.svg"},799880:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(785893),l=n(667294),s=n(294184),i=n.n(s),a=n(331535),o=n(678081),u=n(393369),c=n.n(u);function d(e){var t=e.filename,n=e.className,s=e.filters,u=e.buttonText,d=e.placeholder,f=e.onFileSelect,m=l.useRef(null);return(0,r.jsxs)("div",{className:i()(n,c().fileUpload),children:[(0,r.jsx)("input",{className:c().fileUploadInput,tabIndex:-1,readOnly:!0,placeholder:d,type:"text",value:t}),(0,r.jsxs)(a.zx,{size:a.zx.Sizes.MIN,className:c().fileUploadButton,children:[u,(0,r.jsx)(o.Z,{ref:m,tabIndex:-1,onChange:function(e){var t,n=null===(t=e.currentTarget.files)||void 0===t?void 0:t[0];f(n)},multiple:!1,filters:s})]})]})}},978521:(e,t,n)=>{"use strict";n.r(t);n.d(t,{default:()=>se})
;var r=n(785893),l=n(667294),s=n(294184),i=n.n(s),a=n(468811),o=n.n(a),u=n(363010),c=n(331535),d=n(152163),f=n(725616),m=n(902397),p=n(799880),I=n(204660),_=n(80635),v=n(859023),E=n(629858),g=n(487502),h=n(761434),L=n(757987),T=n(436035),b=n(67416),x=n(932847),D=n(371452),y=n(95467),S=n(894827),O=n(942604),j=(0,n(553494).B)({kind:"guild",id:"2021-07_stickers_lottie_upload",label:"Lottie Sticker Uploads",defaultConfig:{enabled:!1},treatments:[{id:1,label:"Allow Lottie sticker uploads",config:{enabled:!0}}]}),C=n(893264),P=n(673973),R=n(493266),U=n(796165),N=n(461061),A=n(959797),w=n(679900),M=n.n(w),Z=n(429547),k=n.n(Z),K=n(834005),G=n.n(K);function z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function B(e,t,n,r,l,s,i){try{var a=e[s](i),o=a.value}catch(e){n(e);return}a.done?t(o):Promise.resolve(o).then(r,l)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(r,l){var s=e.apply(t,n);function i(e){
B(s,r,l,i,a,"next",e)}function a(e){B(s,r,l,i,a,"throw",e)}i(void 0)}))}}function H(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function J(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){H(e,t,n[t])}))}return e}function V(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function q(e,t){
return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,s=[],i=!0,a=!1;try{for(n=n.call(e);!(i=(r=n.next()).done);i=!0){s.push(r.value);if(t&&s.length===t)break}}catch(e){a=!0;l=e}finally{try{i||null==n.return||n.return()}finally{if(a)throw l}}return s}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return z(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var W=function(e,t){var n,r,l,s,i={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),
return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(l=2&s[0]?r.return:s[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,s[1])).done)return l;(r=0,l)&&(s=[2&s[0],l.value]);switch(s[0]){case 0:case 1:l=s;break;case 4:i.label++;return{value:s[1],done:!1};case 5:i.label++;r=s[1];s=[0];continue;case 7:s=i.ops.pop();i.trys.pop();continue;default:if(!(l=i.trys,l=l.length>0&&l[l.length-1])&&(6===s[0]||2===s[0])){i=0;continue}if(3===s[0]&&(!l||s[1]>l[0]&&s[1]<l[3])){i.label=s[1];break}if(6===s[0]&&i.label<l[1]){i.label=l[1];l=s;break}if(l&&i.label<l[2]){i.label=l[2];i.ops.push(s);break}l[2]&&i.ops.pop();i.trys.pop();continue}s=t.call(e,i)}catch(e){s=[6,e];r=0}finally{n=l=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}
},Y=320,X=new Set(["application/json","image/png","image/apng","image/gif"]),$=[{name:"Sticker file",extensions:["json","png","apng","gif"]}];function Q(e,t){x.default.track(N.rMx.STICKER_UPLOAD_COMPLETED,{successful:e,error:null!=t?t:""})}var ee=function(e){var t=e.stickerPreview;return(0,r.jsxs)("div",{className:M().preview,children:[(0,r.jsx)("div",{className:M().previewDark,children:null!=t?t:(0,r.jsx)("img",{src:k(),alt:A.Z.Messages.GUILD_STICKER_PREVIEW_IMG_ALT_DARK})}),(0,r.jsx)("div",{className:M().previewLight,children:null!=t?t:(0,r.jsx)("img",{src:G(),alt:A.Z.Messages.GUILD_STICKER_PREVIEW_IMG_ALT_LIGHT})})]})};function te(e){if(null==e)return null;var t={className:M().emoji,emojiName:e.optionallyDiverseSequence,autoplay:!0};return function(){return(0,r.jsx)(d.Z,J({},t))}}var ne=function(e){var t=e.emoji,n=e.onSelectEmoji;return(0,r.jsx)(h.ZP,{animation:h.ZP.Animation.NONE,position:h.ZP.Positions.TOP,renderPopout:function(e){var t=e.closePopout;return(0,r.jsx)(m.Z,{
closePopout:t,pickerIntention:N.HzX.GUILD_STICKER_RELATED_EMOJI,onNavigateAway:t,onSelectEmoji:function(e,r){n(e);r&&t()}})},children:function(e,n){var l=n.isShown;return(0,r.jsxs)("div",V(J({className:M().emojiInputContainer},e),{children:[(0,r.jsx)(E.Z,{className:M().emojiButton,active:l,tabIndex:0,renderButtonContents:te(t)}),(0,r.jsx)(c.oi,{inputClassName:M().emojiText,placeholder:A.Z.Messages.GUILD_STICKER_UPLOAD_RELATED_EMOJI_PLACEHOLDER,value:null!=t?":".concat(t.uniqueName,":"):"",readOnly:!0})]}))}})};function re(e){return le.apply(this,arguments)}function le(){return(le=F((function(e){var t,n,r;return W(this,(function(l){switch(l.label){case 0:return[4,(0,S.fD)(e)];case 1:t=l.sent();(n=new Image).src=t;return[4,n.decode()];case 2:l.sent();r=(0,I.Ae)(n,Y,Y);return[2,(0,S.Bo)(r,e.name,e.type)]}}))}))).apply(this,arguments)}function se(e){var t,n,s,a,d,m,I,E,h,w=e.transitionState,Z=e.onClose,k=e.guildId,K=e.sticker,G=(0,u.e7)([_.Z],(function(){return _.Z.theme
})),z=null!==(n=null===(t=v.default.getCurrentUser())||void 0===t?void 0:t.isStaff())&&void 0!==n&&n?U.OC:U.Ht,B=q(l.useState(null),2),H=B[0],V=B[1],Y=q(l.useState(null!==(s=null==K?void 0:K.name)&&void 0!==s?s:""),2),te=Y[0],le=Y[1],se=q(l.useState({file:null,filename:null!==(a=(0,P._V)(K))&&void 0!==a?a:""}),2),ie=se[0],ae=se[1],oe=q(l.useState(null!=(null==K?void 0:K.tags)&&null!==(d=f.ZP.getByName(K.tags))&&void 0!==d?d:null),2),ue=oe[0],ce=oe[1],de=q(l.useState(null!==(m=null==K?void 0:K.description)&&void 0!==m?m:""),2),fe=de[0],me=de[1],pe=q(l.useState(!1),2),Ie=pe[0],_e=pe[1],ve=q(l.useState(null),2),Ee=ve[0],ge=ve[1],he=null!=K,Le=he||null!=(null==ie?void 0:ie.file),Te=0===fe.length||fe.length>=2&&fe.length<=100,be=!Ie&&!0!==(null==Ee?void 0:Ee.isBlocking)&&te.length>=2&&(null!=ue||null!=(null==K?void 0:K.tags)&&""!==(null==K?void 0:K.tags))&&Le&&Te,xe=j.getCurrentConfig({guildId:k}).enabled,De=(I=F((function(e){var t,n,r,l,s,i,a,u;return W(this,(function(c){switch(c.label){
case 0:if(null==e)return[2];n=null===(t=e.type)||void 0===t?void 0:t.split(";")[0];if(!X.has(n)){ge({message:A.Z.Messages.GUILD_STICKER_UNKNOWN_MIME_TYPE,isBlocking:!0});return[2]}r=e;return(l="image/png"===n&&e.size>z)?[4,(0,S.c0)(e)]:[3,2];case 1:l=!c.sent();c.label=2;case 2:return l?[4,re(e)]:[3,4];case 3:r=c.sent();s=r.size>z;x.default.track(N.rMx.STICKER_FILE_RESIZED,{original_file_size_bytes:e.size,resized_file_size_bytes:r.size,resized_file_too_big:s});c.label=4;case 4:if(r.size>z){ge({message:A.Z.Messages.GUILD_STICKER_FILE_TOO_BIG.format({maxSize:(0,D.IC)(z,{useKibibytes:!0})}),isBlocking:null==ie.file});x.default.track(N.rMx.STICKER_UPLOAD_FILE_SIZE_LIMIT_EXCEEDED,{size:r.size,filetype:n});return[2]}if((i=(0,P.Zv)(r.type))!==C.u3.LOTTIE)return[3,5];if(!xe){ge({message:A.Z.Messages.GUILD_STICKER_UNSUPPORTED_MIME_TYPE.format({articleURL:y.Z.getArticleURL(N.BhN.STICKERS_UPLOAD)}),isBlocking:!0});return[2]}(a=new FileReader).addEventListener("load",(function(){V({id:o().v4(),
formatType:i,content:a.result});ge(null)}));a.readAsText(r);return[3,7];case 5:return[4,(0,S.fD)(r)];case 6:u=c.sent();V({id:o().v4(),formatType:i,content:u});ge(null);c.label=7;case 7:ae({file:r,filename:r.name});return[2]}}))})),function(e){return I.apply(this,arguments)}),ye=function(){var e=F((function(e){var t,n,r,l,s,i,a,o;return W(this,(function(u){switch(u.label){case 0:e.preventDefault();r=null!==(n=null!==(t=null==ue?void 0:ue.uniqueName)&&void 0!==t?t:null==K?void 0:K.tags)&&void 0!==n?n:"";u.label=1;case 1:u.trys.push([1,6,7,8]);_e(!0);return he?[4,(0,O.Jf)(k,null!==(l=null==K?void 0:K.id)&&void 0!==l?l:"",{name:te,tags:r,description:fe})]:[3,3];case 2:u.sent();return[3,5];case 3:(i=new FormData).append("name",te);i.append("tags",r);i.append("description",fe);null!=(null==ie?void 0:ie.file)&&i.append("file",ie.file);c=null!==(a=null===(s=ie.file)||void 0===s?void 0:s.type)&&void 0!==a?a:"",x.default.track(N.rMx.STICKER_UPLOAD_STARTED,{filetype:c});return[4,(0,O.lY)(k,i)]
;case 4:u.sent();Q(!0);u.label=5;case 5:Z();return[3,8];case 6:o=u.sent();ge({message:o.body.message,isBlocking:!1});Q(!1,o.body.message);return[3,8];case 7:_e(!1);return[7];case 8:return[2]}var c}))}));return function(t){return e.apply(this,arguments)}}(),Se=l.useCallback((function(){ge({message:A.Z.Messages.GUILD_STICKER_INVALID_STICKER,isBlocking:!0})}),[]),Oe=function(e){var t=e.sticker,n=e.previewData,l=e.onStickerError;if(null!=t)return(0,r.jsx)(R.ZP,{size:160,sticker:t});if(null==n)return null;var s=n.id,i=n.formatType,a=n.content;return(0,r.jsx)(R.ZP,{assetData:a,fileUri:a,size:160,sticker:{name:s,description:"",id:s,pack_id:"",format_type:i},onError:l},s)}({sticker:K,previewData:H,onStickerError:Se}),je=xe?A.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION:A.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_NO_LOTTIE;return(0,r.jsxs)(b.Y0,{transitionState:w,"aria-labelledby":"STICKER_UPLOAD_MODAL",className:M().modal,children:[(0,r.jsx)(b.ol,{onClick:Z,className:M().modalClose}),(0,
r.jsxs)("form",{onSubmit:ye,className:M().form,children:[(0,r.jsxs)(b.hz,{className:M().modalContent,children:[(0,r.jsxs)(b.xB,{direction:g.Z.Direction.VERTICAL,separator:!1,className:M().modalHeader,children:[(0,r.jsx)(c.X6,{variant:"heading-xl/semibold",className:M().modalHeaderTitle,children:A.Z.Messages.GUILD_STICKER_UPLOAD_TITLE}),(0,r.jsx)(c.xv,{variant:"text-md/normal",children:je.format({fileSize:(0,D.IC)(U.Ht,{useKibibytes:!0})})})]}),(0,r.jsx)(c.hj,{title:A.Z.Messages.GUILD_STICKER_UPLOAD_PREVIEW_TITLE,className:M().formItem,children:(0,r.jsx)(ee,{stickerPreview:Oe})}),(0,r.jsxs)(c.hj,{className:i()(M().formItem,M().formItemRow),children:[(0,r.jsx)(c.xJ,{title:he?A.Z.Messages.GUILD_STICKER_UPLOAD_FILE_TITLE_BLOCKED:A.Z.Messages.GUILD_STICKER_UPLOAD_FILE_TITLE,required:!0,className:M().formItemRowChild,children:he?(0,r.jsx)(c.oi,{disabled:!0,value:null!==(E=null==ie?void 0:ie.filename)&&void 0!==E?E:""}):(0,r.jsx)(p.Z,{buttonText:A.Z.Messages.GUILD_STICKER_UPLOAD_FILE_BUTTON,
filters:$,filename:null!==(h=null==ie?void 0:ie.filename)&&void 0!==h?h:"",placeholder:A.Z.Messages.GUILD_STICKER_UPLOAD_FILE_PLACEHOLDER,onFileSelect:De})}),(0,r.jsx)(c.xJ,{title:A.Z.Messages.GUILD_STICKER_UPLOAD_RELATED_EMOJI_TITLE,required:!0,className:M().formItemRowChild,children:(0,r.jsx)(ne,{emoji:ue,onSelectEmoji:ce})})]}),(0,r.jsx)(c.xJ,{title:A.Z.Messages.GUILD_STICKER_UPLOAD_NAME_TITLE,required:!0,className:M().formItem,children:(0,r.jsx)(c.oi,{value:te,onChange:le,placeholder:A.Z.Messages.GUILD_STICKER_UPLOAD_NAME_PLACEHOLDER,maxLength:30})}),(0,r.jsxs)("div",{className:M().formItem,children:[(0,r.jsxs)(c.vw,{children:[A.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_TITLE,(0,r.jsx)(L.ZP,{text:A.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_TOOLTIP,children:function(e){return(0,r.jsx)(T.Z,J({className:M().infoIcon},e))}})]}),(0,r.jsx)(c.Kx,{value:fe,onChange:me,placeholder:A.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_PLACEHOLDER,maxLength:100})]}),null!=Ee&&(0,r.jsx)(c.xv,{
className:M().formItem,variant:"text-sm/normal",color:"text-danger",children:Ee.message})]}),(0,r.jsxs)(b.mz,{className:M().modalFooter,children:[(0,r.jsx)(c.zx,{type:"submit",disabled:!be,children:he?A.Z.Messages.GUILD_STICKERS_UPDATE:A.Z.Messages.UPLOAD}),(0,r.jsx)(c.zx,{look:c.zx.Looks.LINK,color:G===N.BRd.LIGHT?c.zx.Colors.PRIMARY:c.zx.Colors.WHITE,onClick:Z,children:A.Z.Messages.NEVERMIND})]})]})]})}}}]);
//# sourceMappingURL=0c7fe1d7da6b03e5c3bb.js.map