(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[86611],{495068:(e,t,n)=>{e.exports=n.p+"3255f24f5123fd8769d97157e48cb796.svg"},377236:(e,t,n)=>{e.exports=n.p+"6cf42ec75591247991e68cfaf7801a29.svg"},246380:(e,t,n)=>{"use strict";n.d(t,{Z:()=>u});var r=n(667294),a=n(22176);function i(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){i(e,t,n[t])}))}return e}function s(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e)
;t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}const u=function(e,t,n,i,u){var l=(0,r.useRef)(!1);(0,r.useEffect)((function(){if(t&&!l.current){l.current=!0;var r=setTimeout((function(){var t=new Error("".concat(e," is taking too long to load."));a.Z.setExtra({loadingState:i,loadingTimeSeconds:n});a.Z.captureException(t,s(o({},u),{tags:o({},null==u?void 0:u.tags)}))}),1e3*n);return function(){clearTimeout(r)}}}),[t,n])}},123435:(e,t,n)=>{"use strict";n.d(t,{c8:()=>S,Vq:()=>_,oQ:()=>P});var r=n(785893),a=(n(667294),n(294184)),i=n.n(a),o=n(336194),s=n(575945),u=n(945460),l=n(74535),c=n(265367),f=n(348592),d=n(387099),p=n(2590),y=n(473708),m=n(14373),h=n.n(m),b=n(495068),E=n.n(b),g=n(377236),v=n.n(g);function O(e){var t=e.className,n=(0,l.ZP)(),a=(0,s.wj)(n)?E():v();return(0,r.jsxs)("div",{
className:i()(h().container,t),children:[(0,r.jsx)(u.Heading,{className:h().header,variant:"heading-xl/semibold",children:y.Z.Messages.REGION_BLOCKED_PAYMENTS_HEADER}),(0,r.jsxs)(u.Text,{className:h().description,variant:"text-md/normal",color:"header-secondary",children:[(0,r.jsx)("p",{children:y.Z.Messages.REGION_BLOCKED_PAYMENTS_BODY}),(0,r.jsx)("p",{children:y.Z.Messages.REGION_BLOCKED_PAYMENTS_CTA.format({helpdeskArticle:f.Z.getArticleURL(p.BhN.BLOCKED_PAYMENTS)})})]}),(0,r.jsx)("img",{src:a,className:h().splashImage,alt:"Blocked Payments"})]})}function S(){return(0,r.jsx)(O,{className:h().settings})}function _(){return(0,r.jsx)(O,{className:h().modal})}function P(e){var t=e.className;return(0,d.Q)()?(0,r.jsxs)(u.Card,{className:i()(h().blockedPaymentsWarning,t),type:u.Card.Types.CUSTOM,children:[(0,r.jsx)(c.Z,{className:h().blockedPaymentsWarningIcon,color:o.Z.unsafe_rawColors.YELLOW_300.css}),(0,r.jsx)(u.Text,{variant:"text-sm/normal",
children:y.Z.Messages.REGION_BLOCKED_PAYMENTS_ONE_LINER.format({helpdeskArticle:f.Z.getArticleURL(p.BhN.BLOCKED_PAYMENTS)})})]}):null}},186451:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(667294),a=n(744564);function i(e){var t=(0,r.useRef)(e);(0,r.useEffect)((function(){t.current=e}),[e]);(0,r.useEffect)((function(){if(__OVERLAY__){var e=function(e){e.locked&&t.current()};a.Z.subscribe("OVERLAY_SET_INPUT_LOCKED",e);return function(){a.Z.unsubscribe("OVERLAY_SET_INPUT_LOCKED",e)}}}),[])}},586611:(e,t,n)=>{"use strict";n.r(t);n.d(t,{PaymentModal:()=>H,PaymentPredicateStep:()=>B});var r=n(785893),a=n(667294),i=n(294184),o=n.n(i),s=n(685269),u=n(318715),l=n(945460),c=n(595138),f=n(246380),d=n(123435),p=n(186451),y=n(785531),m=n(83471),h=n(909365);var b=n(111090),E=n(551778),g=n(151367),v=n(652591),O=n(850841),S=n(782786),_=n(632826),P=n(441143),I=n.n(P),T=n(621270),A=n(717035),N=n(301162),j=n(770050),w=n(203600),C=n(452726),M=n.n(C)
;var x=n(28648),k=n(149096),Z=n(2590),L=n(786958),D=n.n(L);function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){G(e,t,n[t])}))}return e}function Y(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){
Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function K(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done);o=!0){i.push(r.value);if(t&&i.length===t)break}}catch(e){s=!0;a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return R(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e){
var t=e.analyticsLocations,n=e.analyticsLocation,i=e.analyticsObject,u=e.analyticsSourceLocation,c=e.analyticsSubscriptionType,f=void 0===c?Z.NYc.PREMIUM:c,d=e.onComplete,g=e.transitionState,P=e.initialPlanId,C=e.giftMessage,x=e.subscriptionTier,L=e.onClose,R=e.trialId,H=e.isGift,B=void 0!==H&&H,W=e.trialFooterMessageOverride,F=e.reviewWarningMessage,V=e.planGroup,Q=void 0===V?w.Y1:V,q=e.openInvoiceId,z=e.onSubscriptionConfirmation,X=e.renderPurchaseConfirmation,$=e.postSuccessGuild,J=e.followupSKUInfo,ee=e.renderHeader,te=e.applicationId,ne=e.guildId,re=e.referralTrialOfferId,ae=e.skuId,ie=e.shakeWhilePurchasing,oe=void 0!==ie&&ie,se=(0,
S.usePaymentContext)(),ue=se.purchaseState,le=se.setPurchaseState,ce=se.selectedSkuId,fe=se.setSelectedSkuId,de=se.selectedPlan,pe=se.setSelectedPlanId,ye=se.setStep,me=se.setPurchaseError,he=se.paymentAuthenticationState,be=se.step,Ee=se.contextMetadata,ge=se.purchaseTokenAuthState,ve=se.activeSubscription,Oe=se.priceOptions,Se=se.hasPaymentSources,_e=K(a.useState({load_id:Ee.loadId,payment_type:"subscription",location:null!=n?n:i,source:u,subscription_type:f,subscription_plan_id:null==de?void 0:de.id,is_gift:B,eligible_for_trial:null!=R,location_stack:t,sku_id:ae,application_id:te,guild_id:ne,payment_modal_version:"v1"}),2),Pe=_e[0],Ie=_e[1];a.useEffect((function(){Ie((function(e){var t=null!=de?(0,O.aS)(de.id,!1,B,Oe):void 0;return Y(U({},e),{subscription_plan_id:null==de?void 0:de.id,price:null==t?void 0:t.amount,regular_price:null==de?void 0:de.price,currency:Oe.currency,sku_id:ce})}))}),[de,ce,B,Oe]);a.useEffect((function(){v.default.track(Z.rMx.PAYMENT_FLOW_STARTED,Y(U({},Pe),{
has_saved_payment_source:Se}))}),[]);a.useEffect((function(){pe(P);if(null!=ae)fe(ae);else if(null!=P){var e;fe(null===(e=E.Z.get(P))||void 0===e?void 0:e.skuId)}}),[pe,fe,P,ae]);var Te=(0,s.Z)((function(){return Date.now()}),[be]),Ae=a.useCallback((function(e,t,n){e===m.h8.CONFIRM&&(null==d||d());ye(e);me(null);var r=null!=t?t:be,a=Date.now();null!==r?v.default.track(Z.rMx.PAYMENT_FLOW_STEP,Y(U({},Pe,n),{from_step:r,to_step:e===m.h8.ADD_PAYMENT_STEPS?m.h8.PAYMENT_TYPE:e,step_duration_ms:a-Te,flow_duration_ms:a-Ee.startTime})):v.default.track(Z.rMx.PAYMENT_FLOW_LOADED,Y(U({},Pe),{initial_step:e,has_saved_payment_source:Se}))}),[Pe,Ee.startTime,d,me,ye,be,Te,Se]),Ne=a.useMemo((function(){return function(){return null==L?void 0:L(ue===_.A.COMPLETED)}}),[L,ue]);(0,y.bp)(be,he,Ae);(0,m.dZ)(be,ue,le);!function(e,t,n){a.useEffect((function(){
null!=e&&e!==m.h8.AWAITING_PURCHASE_TOKEN_AUTH&&t===h.I.PENDING?n(m.h8.AWAITING_PURCHASE_TOKEN_AUTH):e===m.h8.AWAITING_PURCHASE_TOKEN_AUTH&&t===h.I.SUCCESS&&n(m.h8.REVIEW)}),[e,t,n])}(be,ge,Ae);(0,p.Z)(Ne);(0,b.w)(ve,(function(){return L(!1)}),B);var je={initialPlanId:P,giftMessage:C,subscriptionTier:x,handleStepChange:Ae,handleClose:Ne,analyticsData:Pe,setAnalyticsData:Ie,trialId:R,trialFooterMessageOverride:W,reviewWarningMessage:F,planGroup:Q,openInvoiceId:q,analyticsLocation:n,onSubscriptionConfirmation:z,renderPurchaseConfirmation:X,postSuccessGuild:$,followupSKUInfo:J,referralTrialOfferId:re},we=function(e){var t=e.isGift,n=e.renderHeader,i=e.referralTrialOfferId,o=e.handleClose,s=(0,S.usePaymentContext)(),u=s.selectedSkuId,l=s.step,c=s.selectedPlan,f=s.purchaseState,d=s.selectedGiftStyle,p=T.ZP.useExperiment({},{autoTrackExposure:!1}).enabled,y=(0,T.rK)();a.useEffect((function(){y&&t&&T.ZP.trackExposure({})}),[y,t])
;var h=p&&y&&t&&u===w.Si.TIER_2,b=h&&l===m.h8.CONFIRM&&null!=d,E=null!=n&&null!=c&&null!=l,g=l!==m.h8.SKU_SELECT&&null!=u,v=(0,A.N)(i),O=!t&&null!=v&&null!=u&&w.nG[v.trial_id].skus.includes(u);return a.useMemo((function(){if(null!=l){var e=null;if(b)e=(0,r.jsx)(j.Z,{giftStyle:d,className:M().seasonalGiftBoxHeaderIcon});else if(E)e=n(c,o,l);else if(g){I()(u in w.y7,"invalid sku id: ".concat(u));e=(0,r.jsx)(N.Z,{currentStep:null!=l?l:void 0,purchaseState:f,premiumType:w.y7[u],onClose:o,useWinterTheme:h,showTrialBadge:O})}return e}}),[h,d,o,f,n,c,u,l,O,b,g,E])}({isGift:B,renderHeader:ee,referralTrialOfferId:re,handleClose:Ne});return(0,r.jsx)(l.Shaker,{className:D().shaker,isShaking:oe&&ue===_.A.PURCHASING,intensity:2,children:(0,r.jsx)(l.ModalRoot,{className:o()(D().root,G({},D().withHeader,null!=we)),transitionState:g,children:(0,r.jsx)(k.ZP,U({header:we},je))})})}function B(e){var t=e.subscriptionTier,n=e.initialPlanId,i=e.handleStepChange,o=(0,
S.usePaymentContext)(),s=o.blockedPayments,l=o.hasFetchedSubscriptions,p=o.hasFetchedSubscriptionPlans,y=o.currencyLoading,h=K(a.useState(!0),2),b=h[0],E=h[1],v=(0,u.ZP)([g.Z],(function(){return g.Z.applicationIdsFetched.has(w.RQ)}));a.useEffect((function(){E(!l||!p||y)}),[y,p,l]);(0,f.Z)("Payment Modal",b,5,{hasFetchedSubscriptions:l,hasFetchedSubscriptionPlans:p,currencyLoading:y},{tags:{app_context:"billing"}});a.useEffect((function(){v||(0,c.yD)(w.RQ);b||s||i(null!=n?m.h8.REVIEW:null!=t?m.h8.PLAN_SELECT:m.h8.SKU_SELECT)}),[s,v,n,b,i,t]);return b?(0,r.jsx)(x.Z,{}):s?(0,r.jsx)(d.Vq,{}):null}},28648:(e,t,n)=>{"use strict";n.d(t,{Z:()=>s});var r=n(785893),a=(n(667294),n(945460)),i=n(24193),o=n.n(i);function s(){return(0,r.jsx)(a.Spinner,{className:o().spinner})}},621270:(e,t,n)=>{"use strict";n.d(t,{rK:()=>d,ZP:()=>p});var r=n(667294),a=n(730381),i=n.n(a),o=n(513328),s=n(249139);function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}
function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i=[],o=!0,s=!1;try{for(n=n.call(e);!(o=(r=n.next()).done);o=!0){i.push(r.value);if(t&&i.length===t)break}}catch(e){s=!0;a=e}finally{try{o||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return u(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var c=new Date("2023-01-01T07:59:59.000Z"),f=i()(c);function d(){var e=l(r.useState((function(){return f.isAfter(Date.now())
})),2),t=e[0],n=e[1];r.useEffect((function(){var e=new o.V7,r=function(){var t=f.diff(Date.now(),"millisecond");null==e||e.start(t,(function(){f.isBefore(Date.now())?n(!1):r()}))};t&&r();return function(){return e.stop()}}));return t}const p=(0,s.Z)({id:"2022-12_seasonal_gifting",label:"Seasonal Gifting",kind:"user",defaultConfig:{enabled:!1},treatments:[{id:1,label:"Enabled",config:{enabled:!0}}]})},111090:(e,t,n)=>{"use strict";n.d(t,{w:()=>f,H:()=>p});var r=n(667294),a=n(202351),i=n(105783),o=n(551778),s=n(151367),u=n(850841),l=n(520453),c=n(473708);function f(e,t,n){r.useEffect((function(){if(null!=e&&e.isPurchasedExternally&&null!=e.paymentGateway&&!n){i.Z.show({title:c.Z.Messages.BILLING_EXTERNAL_HEADER.format({paymentGatewayName:l.Vz[e.paymentGateway]}),body:c.Z.Messages.BILLING_EXTERNAL_MANAGE_ELSEWHERE.format({paymentGatewayName:l.Vz[e.paymentGateway],subscriptionManagementLink:(0,u.JE)(e.paymentGateway,"SUBSCRIPTION_MANAGEMENT")}),confirmText:c.Z.Messages.OKAY});t()}}),[e])}
var d=[];function p(e,t){var n=(0,a.e7)([o.Z],(function(){return o.Z.get(e)})),i=(0,a.e7)([s.Z],(function(){var e;return null!=n&&null!==(e=s.Z.getForSku(n.skuId))&&void 0!==e?e:d})),l=r.useMemo((function(){return Array.from(i).filter((function(e){var t=e.parentId,n=e.consumed;return null!=t&&!n}))}),[i]);return{hasEntitlements:!t&&null!=n&&null!=l&&l.length>=u.ZP.getIntervalMonths(n.interval,n.intervalCount),entitlements:l}}},685269:(e,t,n)=>{"use strict";n.d(t,{Z:()=>i});var r=n(667294);var a=[];function i(e,t){var n=(0,r.useRef)(),i=(0,r.useRef)(a);if(i.current===a){n.current=e();i.current=t}else if(!function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Object.is(e[n],t[n]))return!1;return!0}(t,i.current)){n.current=e();i.current=t}return n.current}}}]);
//# sourceMappingURL=8b433f7eac2a9090d8b2.js.map