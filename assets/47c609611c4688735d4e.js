"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[88417],{688417:(e,t,n)=>{n.d(t,{Z:()=>_});var r=n(730381),i=n.n(r),o=n(338093),u=n(173436),a=n(183279),c=n(390504),l=n(203271),s=n(228031),d=n(959797);function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function p(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o=[],u=!0,a=!1;try{for(n=n.call(e);!(u=(r=n.next()).done);u=!0){o.push(r.value);if(t&&o.length===t)break}}catch(e){a=!0;i=e}finally{try{u||null==n.return||n.return()}finally{if(a)throw i}}return o}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1)
;"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return f(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}const _={open:function(e){u.Z.dispatch({type:"NOTIFICATION_SETTINGS_MODAL_OPEN",guildId:e})},close:function(){u.Z.dispatch({type:"NOTIFICATION_SETTINGS_MODAL_CLOSE"})},updateGuildNotificationSettings:function(e,t,n){var r=(0,l.GA)(e);a.Z.saveUserGuildSettings(e,t);u.Z.dispatch({type:"USER_GUILD_SETTINGS_GUILD_UPDATE",guildId:e,settings:t});(0,l.Wq)(e,t,r,n)},updateGuildAndChannelNotificationSettings:function(e,t,n){var r=Object.keys(t.channel_overrides),i=(0,l.GA)(e),o=(0,l.wK)(e,r);a.Z.saveUserGuildSettings(e,t);u.Z.dispatch({type:"USER_GUILD_SETTINGS_GUILD_AND_CHANNELS_UPDATE",guildId:e,settings:t});(0,l.Wq)(e,t,i,n)
;Object.keys(t.channel_overrides).forEach((function(r){var i=o.get(r);(0,l.jz)(e,r,t.channel_overrides[r],i,n)}))},updateGuildNotificationSettingsBulk:function(e,t){var n=Object.keys(e),r=(0,l.rU)(n);a.Z.saveUserGuildSettingsBulk(e);Object.entries(e).forEach((function(e){var n=h(e,2),i=n[0],o=n[1],a=r.get(i);u.Z.dispatch({type:"USER_GUILD_SETTINGS_GUILD_UPDATE",guildId:i,settings:o});(0,l.Wq)(i,o,a,t)}))},updateChannelOverrideSettings:function(e,t,n,r){var i=(0,l.I)(e,t),c={channel_overrides:p({},t,n)};a.Z.saveUserGuildSettings(e,c);u.Z.dispatch({type:"USER_GUILD_SETTINGS_CHANNEL_UPDATE",guildId:e,channelId:t,settings:n});o.uv.announce(d.Z.Messages.A11Y_ANNOUNCEMENT_CHANNEL_SETTINGS_UPDATED);(0,l.jz)(e,t,n,i,r)},updateChannelOverrideSettingsBulk:function(e,t,n){var r=Object.keys(t),i={channel_overrides:t},o=(0,l.wK)(e,r);a.Z.saveUserGuildSettings(e,i);u.Z.dispatch({type:"USER_GUILD_SETTINGS_CHANNEL_UPDATE_BULK",guildId:e,overrides:t});Object.keys(t).forEach((function(r){return(0,
l.jz)(e,r,t[r],o.get(r),n)}))},setForumThreadsCreated:function(e,t){var n=t?s.ic.NEW_FORUM_THREADS_ON:s.ic.NEW_FORUM_THREADS_OFF,r=t?s.ic.NEW_FORUM_THREADS_OFF:s.ic.NEW_FORUM_THREADS_ON,i=c.Z.getChannelFlags(e)&~r|n;this.updateChannelOverrideSettings(e.guild_id,e.id,{flags:i})},handleCheckboxChange:function(e,t,n,r){u.Z.dispatch({type:"GUILD_UPDATE_NOTIFICATION_PROFILE",guildId:r.id,profile:e,updatedSettings:p({},t,n),handleUpdate:this.updateGuildNotificationSettings})},handleSelectChange:function(e,t,n,r){u.Z.dispatch({type:"GUILD_UPDATE_NOTIFICATION_PROFILE",guildId:r.id,profile:e,updatedSettings:p({},t,n),handleUpdate:this.updateGuildNotificationSettings})},handleMuteConfigChange:function(e,t,n){var r={selected_time_window:t,end_time:t>0?i()().add(t,"second").toISOString():null};u.Z.dispatch({type:"GUILD_UPDATE_NOTIFICATION_PROFILE",guildId:n.id,profile:"MUTED",updatedSettings:p({},e,r),handleUpdate:this.updateGuildNotificationSettings})},handleHighlightsChange:function(e,t,n){
u.Z.dispatch({type:"GUILD_UPDATE_NOTIFICATION_PROFILE",guildId:n.id,profile:e,updatedSettings:{notifyHighlights:t},handleUpdate:this.updateGuildNotificationSettings})},handleProfileChange:function(e,t){u.Z.dispatch({type:"GUILD_SET_NOTIFICATION_PROFILE",guildId:t.id,profile:e.value,handleUpdate:this.updateGuildNotificationSettings})}}},183279:(e,t,n)=>{n.d(t,{Z:()=>j});var r=n(496486),i=n.n(r),o=n(675860),u=n(491681),a=n(832691),c=n(710348),l=n(356004),s=n(461061);function d(e,t,n,r,i,o,u){try{var a=e[o](u),c=a.value}catch(e){n(e);return}a.done?t(c):Promise.resolve(c).then(r,i)}function f(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function u(e){d(o,r,i,u,a,"next",e)}function a(e){d(o,r,i,u,a,"throw",e)}u(void 0)}))}}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}
function _(e){_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return _(e)}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){h(e,t,n[t])}))}return e}function y(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function O(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){
if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e,t){b=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return b(e,t)}var S=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=_(e);if(t){var i=_(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return O(this,n)}}var I=function(e,t){var n,r,i,o,u={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){
return function(o){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;(r=0,i)&&(o=[2&o[0],i.value]);switch(o[0]){case 0:case 1:i=o;break;case 4:u.label++;return{value:o[1],done:!1};case 5:u.label++;r=o[1];o=[0];continue;case 7:o=u.ops.pop();u.trys.pop();continue;default:if(!(i=u.trys,i=i.length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){u=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){u.label=o[1];break}if(6===o[0]&&u.label<i[1]){u.label=i[1];i=o;break}if(i&&u.label<i[2]){u.label=i[2];u.ops.push(o);break}i[2]&&u.ops.pop();u.trys.pop();continue}o=t.call(e,u)}catch(e){o=[6,e];r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}},v={},T=new a.Z("UserGuildSettingsManager"),N=0;function U(){v=g({},c.Z.getCollapsedCategories())}function A(){if(!__OVERLAY__){clearTimeout(N);N=setTimeout((function(){return G()}),15e3)}}
function G(e,t){return C.apply(this,arguments)}function C(){return(C=f((function(e,t){return I(this,(function(n){switch(n.label){case 0:return[4,P(null!=t?h({},null!=e?e:s.ME,t):{})];case 1:n.sent();return[2]}}))}))).apply(this,arguments)}function P(e){return w.apply(this,arguments)}function w(){return(w=f((function(e){var t,n,r,u,a,d,f;return I(this,(function(p){switch(p.label){case 0:clearTimeout(N);t=0!==Object.keys(e).length;n=c.Z.getCollapsedCategories();r=D();for(var h in r)if(null!=(u=l.Z.getChannel(h))&&null!=u.guild_id){u.guild_id in e||(e[u.guild_id]={});null==e[u.guild_id].channel_overrides&&(e[u.guild_id].channel_overrides={});e[u.guild_id].channel_overrides[u.id]=y(g({},e[u.guild_id].channel_overrides[u.id]),{collapsed:u.id in n});t=!0}if(!t)return[2];v=g({},n);a=i().map(e,(function(e,t){return{guildId:t,updates:e,attempts:0}}));p.label=1;case 1:if(!(a.length>0))return[3,8];if((d=a.shift()).guildId===s.I_8)return[3,1];p.label=2;case 2:p.trys.push([2,5,,7])
;return[4,o.Z.patch({url:s.ANM.USER_GUILD_SETTINGS(d.guildId),body:d.updates})];case 3:p.sent();return[4,m(1e3)];case 4:p.sent();return[3,7];case 5:f=p.sent();T.error(f);d.attempts+=1;d.attempts<3&&a.push(d);return[4,m(5e3)];case 6:p.sent();return[3,7];case 7:return[3,1];case 8:return[2]}}))}))).apply(this,arguments)}function D(){var e={},t=c.Z.getCollapsedCategories();for(var n in t)t[n]!==v[n]&&(e[n]=!0);for(var r in v)t[r]!==v[r]&&(e[r]=!0);return e}function m(e){return new Promise((function(t){return setTimeout(t,e+Math.ceil(e*Math.random()))}))}function L(){v=g({},c.Z.getCollapsedCategories())}const j=new(function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&b(e,t)}(n,e);var t=E(n);function n(){p(this,n);var e;(e=t.apply(this,arguments)).actions={CATEGORY_COLLAPSE:A,CATEGORY_EXPAND:A,
CATEGORY_COLLAPSE_ALL:A,CATEGORY_EXPAND_ALL:A,POST_CONNECTION_OPEN:U,USER_GUILD_SETTINGS_FULL_UPDATE:L};e.saveUserGuildSettings=G;e.saveUserGuildSettingsBulk=P;return e}return n}(u.Z))}}]);
//# sourceMappingURL=47c609611c4688735d4e.js.map