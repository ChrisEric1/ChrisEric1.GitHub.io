"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[76670,62322,23647],{662322:(e,t,n)=>{n.d(t,{W:()=>s});var r=n(675860),o=n(173436),i=n(630206),a=n(461061);function s(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(i.Z.needsRefresh()){o.Z.dispatch({type:"LOAD_USER_AFFINITIES"});return r.Z.get({url:a.ANM.USER_AFFINITIES,retries:e?3:0,oldFormErrors:!0}).then((function(e){var t=e.body;o.Z.dispatch({type:"LOAD_USER_AFFINITIES_SUCCESS",affinities:t})}),(function(){o.Z.dispatch({type:"LOAD_USER_AFFINITIES_FAILURE"})}))}return Promise.resolve()}},657390:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(785893),o=(n(667294),n(294184)),i=n.n(o),a=n(545354),s=n.n(a);function l(e){var t=e.application,n=e.splashSize,o=e.className,a=e.overrideSplash,l=null!=a?a:t.getSplashURL(n),u=null!=l?"url(".concat(l,")"):void 0;return(0,r.jsx)("div",{className:i()(s().splashBackground,o),style:{backgroundImage:u}})}},305630:(e,t,n)=>{n.d(t,{Z:()=>X})
;var r=n(785893),o=n(667294),i=n(441143),a=n.n(i),s=n(496486),l=n.n(s),u=n(363010),c=n(365523),f=n(331535),p=n(642400),d=n(579220),h=n(549425),y=n(735713),b=n(662322),m=n(956345),g=n(565922),S=n(640753),P=n(451620),I=n(356004),v=n(105405),O=n(893321),A=n(630206),R=n(859023),E=n(513857),C=n(487502),T=n(693518),_=n(726283),N=n(202036),j=n(74030),Z=n(461061),w=n(298716),M=n(959797),B=n(5759),L=n.n(B);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1;r.configurable=!0;"value"in r&&(r.writable=!0);Object.defineProperty(e,r.key,r)}}function U(e){U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return U(e)}function F(e,t){return!t||"object"!==V(t)&&"function"!=typeof t?function(e){
if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function G(e,t){G=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return G(e,t)}function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0){i.push(r.value);if(t&&i.length===t)break}}catch(e){s=!0;o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||z(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function H(e){return function(e){if(Array.isArray(e))return x(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||z(e)||function(){
throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var V=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function z(e,t){if(e){if("string"==typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);return"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?x(e,t):void 0}}function W(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=U(e);if(t){var o=U(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return F(this,n)}}var K=function(e){!function(e,t){
if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&G(e,t)}(n,e);var t=W(n);function n(){k(this,n);var e;(e=t.apply(this,arguments)).state={copyMode:E.Z.Modes.DEFAULT};e._copyModeTimeout=new c.V7;e.handleGiftCodeCopy=function(t,n){var r=e.props.sku;null!=r&&(0,N.dM)(new P.Z({code:n,maxUses:1}),r);try{(0,_.JG)(t);e.setState({copyMode:E.Z.Modes.SUCCESS})}catch(t){e.setState({copyMode:E.Z.Modes.ERROR})}e._copyModeTimeout.start(1500,(function(){e.setState({copyMode:E.Z.Modes.DEFAULT})}))};e.handleInventoryClick=function(){m.Z.open(Z.oAB.INVENTORY);e.props.onClose()};return e}var o=n.prototype;o.componentWillUnmount=function(){this._copyModeTimeout.stop()};o.render=function(){var e,t=this,n=this.props,o=n.obscureGiftCode,i=n.giftCode,a=n.application,s=n.onClose,l=n.selectedGiftStyle,u=this.state.copyMode;switch(u){case E.Z.Modes.SUCCESS:
e=M.Z.Messages.BILLING_GIFT_COPIED;break;case E.Z.Modes.ERROR:e=M.Z.Messages.FAILED;break;default:e=M.Z.Messages.COPY}return(0,r.jsxs)(C.Z,{direction:C.Z.Direction.VERTICAL,align:C.Z.Align.CENTER,children:[null!=a?(0,r.jsx)(T.Z,{game:a,className:L().icon,size:T.Z.Sizes.LARGE,skuId:this.iconSKUId}):null,(0,r.jsx)(f.X6,{variant:"heading-lg/semibold",className:null!=l?L().headerSeasonalGifting:L().header,children:M.Z.Messages.APPLICATION_STORE_PURCHASE_GIFT_CONFIRMATION_TITLE}),(0,r.jsx)("div",{className:L().blurb,children:this.headerBlurb}),(0,r.jsx)(Q,{giftCode:i,onClose:s}),(0,r.jsx)("div",{className:L().divider}),(0,r.jsxs)(C.Z,{direction:C.Z.Direction.VERTICAL,children:[(0,r.jsx)(f.vw,{children:M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_PRIVATE_LINK}),null!=i?(0,r.jsx)(E.Z,{hideMessage:o?M.Z.Messages.GIFT_INVENTORY_HIDDEN:null,value:(0,N.Nz)(i),mode:u,text:e,onCopy:function(e){return t.handleGiftCodeCopy(e,i)},supportsCopy:_.wS,className:L().copyInput,
buttonColor:E.Z.ButtonColors.LINK,buttonLook:E.Z.ButtonLooks.LINK}):null,(0,r.jsx)("div",{className:L().subtext,children:M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRMATION_SUBTEXT_NO_FORMAT})]})]})};!function(e,t,n){t&&D(e.prototype,t);n&&D(e,n)}(n,[{key:"iconSKUId",get:function(){var e=this.props,t=e.subscriptionPlan,n=e.sku;return null!=t?t.skuId:null!=n?n.id:null}},{key:"headerBlurb",get:function(){var e=this.props.subscriptionPlan,t=M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRMATION_BLURB;if(null!=e){t=(e.interval===w.rV.MONTH?M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRM_SUBSCRIPTION_MONTHLY:M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRM_SUBSCRIPTION_YEARLY).format({skuName:(0,j.aq)(e.id),intervalCount:e.intervalCount})}return t}}]);return n}(o.Component),Q=function(e){var t=e.giftCode,n=e.onClose;o.useEffect((function(){y.Z.fetchRelationships();(0,b.W)()}),[]);var i=null!=t&&""!==t?(0,
N.Nz)(t):null,s=Y(o.useState(),2),c=s[0],m=s[1],P=Y(o.useState(!1),2),O=P[0],E=P[1],C=Y(o.useState(!1),2),T=C[0],_=C[1],j=(0,u.cj)([A.Z],(function(){return{userAffinities:A.Z.getUserAffinitiesUserIds(),isLoading:A.Z.getFetching()}})),Z=j.userAffinities,w=j.isLoading,B=Array.from(Z.values()),x=(0,u.e7)([v.Z],(function(){return v.Z.getFriendIDs()})),k=l().difference(x,B),D=H(B).concat(H(k)),U=(0,u.e7)([R.default],(function(){return R.default.filter((function(e){return D.includes(e.id)&&!e.bot}))}),[D]);if(null==U||0===U.length)return null;var F=l().sortBy(U,(function(e){return D.indexOf(e.id)}));return(0,r.jsxs)("div",{className:L().giftRecipientSection,children:[(0,r.jsx)(f.vw,{children:M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_RECIPIENT_SECTION_LABEL}),(0,r.jsxs)("div",{className:L().giftRecipient,children:[(0,r.jsx)(f.Vc,{placeholder:M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_RECIPIENT_SELECT_PLACEHOLDER,wrapperClassName:L().giftRecipientInputWrapper,
className:O?L().giftRecipientInputError:void 0,renderOptionPrefix:function(e){return null==(null==e?void 0:e.value)?null:(0,r.jsx)(g.Z,{user:e.value,size:g.u.SIZE_20})},renderLeading:function(){return w?(0,r.jsx)(f.$j,{type:f.RA.PULSING_ELLIPSIS}):null},value:c,onChange:function(e){m(e);E(!1)},options:F.map((function(e){return{value:e,label:"".concat(e.toString(),"#").concat(e.discriminator)}}))}),(0,r.jsx)(f.zx,{disabled:null==c,submitting:T,className:L().sendToRecipientButton,onClick:function(){_(!0);p.Z.openPrivateChannel(c.id).then((function(e){var t=I.Z.getChannel(e);a()(null!=t,"Ensured PrivateChannel is null");a()(null!=i,"giftCodeURL is null");h.Z.sendMessage(t.id,S.ZP.parse(t,i),void 0,{isGiftLinkSentOnBehalfOfUser:!0}).then((function(){n();(0,d.Ou)()})).catch((function(){E(!0);_(!1)}))}))},children:M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_SEND_NOW_BUTTON})]}),(0,r.jsx)("div",{className:O?L().subtextError:L().subtext,
children:O?M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_ERROR_SENDING_LINK:M.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_RECIPIENT_SUBTEXT})]})};const X=u.ZP.connectStores([O.Z],(function(){return{obscureGiftCode:O.Z.enabled}}))(K)},479091:(e,t,n)=>{n.d(t,{Z:()=>x});var r=n(785893),o=n(667294),i=n(363010),a=n(331535),s=n(173436),l=n(237350),u=n(955254),c=n(299767),f=n(36347),p=n(956345),d=n(655868),h=n(432859),y=n(655695),b=n(800539),m=n(133840),g=n(400055),S=n(664252),P=n(487502),I=n(693518),v=n(889373),O=n(770040),A=n(935406),R=n(461061),E=n(959797),C=n(5759),T=n.n(C);function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function N(e){N=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return N(e)}function j(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t
}function Z(e,t){Z=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return Z(e,t)}var w=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=N(e);if(t){var o=N(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return j(this,n)}}var B=function(){return[E.Z.Messages.APPLICATION_STORE_PURCHASE_CONFIRMATION_TITLE_1,E.Z.Messages.APPLICATION_STORE_PURCHASE_CONFIRMATION_TITLE_2,E.Z.Messages.APPLICATION_STORE_PURCHASE_CONFIRMATION_TITLE_3,E.Z.Messages.APPLICATION_STORE_PURCHASE_CONFIRMATION_TITLE_4]},L=function(e){!function(e,t){
if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&Z(e,t)}(n,e);var t=M(n);function n(){_(this,n);var e;(e=t.apply(this,arguments)).state={confirmHeaderIndex:Math.floor(Math.random()*B().length),installPath:e.props.defaultInstallationPath,hasInstallPathError:!1,hasAcceptedNeccessaryTerms:!1};e.handleInstallPathChange=function(t,n){e.setState({installPath:t,hasInstallPathError:n})};e.handleInventoryClick=function(){p.Z.open(R.oAB.INVENTORY);e.props.onClose()};e.handleGoToLibrary=function(){(0,y.uL)(R.Z5c.APPLICATION_LIBRARY);e.props.onClose()};e.handleInstall=function(){var t=e.props,n=t.application,r=t.branchId,o=t.buildId,i=t.hasPreviouslyAcceptedStoreTerms,a=t.manifestIds,s=t.onClose,l=e.state,u=l.installPath,p=l.hasInstallPathError;i||(0,c.Bv)();null!=n.eulaId&&(0,c.DC)(n.eulaId);if(!p&&null!=o&&null!=a){f.LO({application:n,
branchId:r,buildId:o,manifestIds:a,installationPath:u,analyticsLocation:R.Sbl.APPLICATION_STORE_PAYMENT_MODAL});s();(0,y.uL)(R.Z5c.APPLICATION_LIBRARY)}};e.handlePurchaseTermsChange=function(t){e.setState({hasAcceptedNeccessaryTerms:t})};return e}var i=n.prototype;i.fetchInstallSize=function(){var e=this.props,t=e.application,n=e.branchId,r=e.buildId,o=e.manifestIds,i=e.buildSizeKB;null!=r&&null!=o&&null==i&&s.Z.wait((function(){(0,u.q)(t.id,n,r,o)}))};i.componentDidMount=function(){var e=this.props,t=e.application,n=e.branchId,r=e.buildId,o=e.manifestIds,i=e.sku;!e.isIAP&&(0,O._f)(i)&&(null==r||null==o?s.Z.wait((function(){return(0,l.l)(t.id,n)})):this.fetchInstallSize())};i.componentDidUpdate=function(e){this.props.buildId===e.buildId&&this.props.manifestIds===e.manifestIds||this.fetchInstallSize()};i.getHeaderBlurb=function(){var e=this.props,t=e.sku,n=e.application,r=e.isIAP
;if(t.isPreorder()&&null!=t.preorderReleaseAt)return E.Z.Messages.APPLICATION_STORE_PREORDER_PURCHASE_CONFIRMATION_BLURB.format({applicationName:n.name,date:t.preorderReleaseAt.format("MMMM DD")});if(r||[R.epS.DURABLE,R.epS.CONSUMABLE].includes(t.type))return E.Z.Messages.APPLICATION_ADDON_PURCHASE_CONFIRMATION_BLURB.format({applicationName:n.name,itemName:t.name});if(t.type===R.epS.BUNDLE)return E.Z.Messages.APPLICATION_STORE_BUNDLE_PURCHASE_CONFIRMATION_BLURB.format({name:t.name});var o=t.supportedOperatingSystems[0];return E.Z.Messages.APPLICATION_STORE_PURCHASE_CONFIRMATION_UNSUPPORTED_OS.format({name:n.name,operatingSystem:(0,A.XK)(o)})};i.renderInstallationHeader=function(){var e=this.props.application;return(0,r.jsx)("div",{className:T().blurb,children:E.Z.Messages.APPLICATION_STORE_PURCHASE_CONFIRMATION_BLURB.format({name:e.name})})};i.renderInstallationBody=function(){
var e=this.props,t=e.isFetchingBuild,n=e.buildId,i=e.buildSizeKB,s=e.application,l=this.state,u=l.installPath,c=l.hasInstallPathError,f=l.hasAcceptedNeccessaryTerms;return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(h.Z,{className:T().installSelector,value:u,requiredDiskKB:i,onChange:this.handleInstallPathChange}),(0,r.jsx)(d.Z,{eulaId:s.eulaId,applicationName:s.name,onChange:this.handlePurchaseTermsChange,className:T().storeTerms}),(0,r.jsx)(v.C,{className:T().confirmButton,disabled:c||null==n||!f,onClick:this.handleInstall,submitting:t,color:a.zx.Colors.GREEN,children:E.Z.Messages.APPLICATION_STORE_PURCHASE_INSTALL_GAME})]})};i.renderGenericHeader=function(){return(0,r.jsx)("div",{className:T().blurb,children:this.getHeaderBlurb()})};i.renderBlurbBody=function(){var e,t=this.props,n=t.isIAP,i=t.sku,s=t.onClose;if(i.isPreorder()){e=E.Z.Messages.APPLICATION_PREORDER_PURCHASE_CONFIRMATION_BUTTON;s=this.handleGoToLibrary
}else e=n?E.Z.Messages.APPLICATION_IAP_PURCHASE_RETURN_TO_GAME:E.Z.Messages.OKAY;return(0,r.jsx)(o.Fragment,{children:(0,r.jsx)(a.zx,{className:T().confirmButton,onClick:s,children:e})})};i.renderBlurb=function(){var e=this.props,t=e.sku;return e.isIAP||!(0,O._f)(t)||t.isPreorder()?this.renderGenericHeader():this.renderInstallationHeader()};i.renderBody=function(){var e=this.props,t=e.sku;return e.isIAP||!(0,O._f)(t)||t.isPreorder()?this.renderBlurbBody():this.renderInstallationBody()};i.render=function(){var e=this.props.application,t=this.state.confirmHeaderIndex;return(0,r.jsxs)(P.Z,{direction:P.Z.Direction.VERTICAL,align:P.Z.Align.CENTER,children:[(0,r.jsx)(I.Z,{game:e,className:T().icon,size:I.Z.Sizes.LARGE}),(0,r.jsx)("div",{className:T().header,children:B()[t]}),this.renderBlurb(),(0,r.jsx)("div",{className:T().divider}),this.renderBody()]})};return n}(o.Component);const x=i.ZP.connectStores([S.Z,m.Z,b.Z,g.Z],(function(e){
var t,n=e.application,r=b.Z.getActiveLibraryApplication(n.id);t=null!=r?r.id:n.id;var o=m.Z.getTargetBuildId(n.id,t);return{defaultInstallationPath:S.Z.defaultInstallationPath,branchId:t,isFetchingBuild:m.Z.isFetching(n.id,t),buildId:o,manifestIds:m.Z.getTargetManifests(n.id,t),buildSizeKB:null!=o?m.Z.getBuildSize(o):null,hasPreviouslyAcceptedStoreTerms:g.Z.hasAcceptedStoreTerms}}))(L)},654721:(e,t,n)=>{n.d(t,{Y:()=>i});var r=n(461061),o=n(959797);function i(e,t){if(e)return o.Z.Messages.APPLICATION_STORE_PURCHASE_IAP;switch(t){case r.epS.DURABLE_PRIMARY:return o.Z.Messages.APPLICATION_STORE_PURCHASE_APPLICATION;case r.epS.DURABLE:return o.Z.Messages.APPLICATION_STORE_PURCHASE_DLC;case r.epS.CONSUMABLE:return o.Z.Messages.APPLICATION_STORE_PURCHASE_CONSUMABLE;case r.epS.BUNDLE:return o.Z.Messages.APPLICATION_STORE_PURCHASE_BUNDLE}}},556215:(e,t,n)=>{n.r(t);n.d(t,{default:()=>Bt})
;var r=n(785893),o=n(667294),i=n(213192),a=n.n(i),s=n(468811),l=n.n(s),u=n(363010),c=n(331535),f=n(173436),p=n(299767),d=n(512172),h=n(737325),y=n(976882),b=n(775584),m=n(915004),g=n(707955),S=n(551511),P=n(886664),I=n(886110),v=n(40188),O=n(893321),A=n(378564),R=n(946849),E=n(487502),C=n(67416),T=n(725002),_=n(742269),N=n(912551),j=n(204371),Z=n(211862),w=n(150251),M=n(47714),B=n(156978),L=n(831809),x=n(472107),k=n(959797),D=function(e){var t=e.submitting,n=e.braintreeNonce,o=e.braintreeEmail,i=e.onPaypalContinue,a=e.onReopenPaypal,s=e.renderBackButton,l=0!==o.length&&null!=n;return(0,r.jsxs)(C.mz,{justify:E.Z.Justify.BETWEEN,direction:E.Z.Direction.HORIZONTAL,children:[s(),(0,r.jsx)(c.zx,{submitting:t,color:l?c.zx.Colors.BRAND:c.zx.Colors.PRIMARY,onClick:l?i:a,children:l?k.Z.Messages.NEXT:k.Z.Messages.PAYMENT_SOURCE_CONNECT_TO_PAYPAL})]})},U=n(879605),F=n(909187),G=n(655868),Y=n(889373),H=n(757987),V=n(496363),z=n(567397),W=n(56435),K=n(992911),Q=n.n(K);function X(e,t,n){
t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){X(e,t,n[t])}))}return e}function $(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}var J=function(e){
var t=e.legalNotice,n=e.paymentSources,i=e.price,a=e.hidePersonalInformation,s=e.paymentSourceId,l=e.isGiftable,u=e.isGift,f=e.needsToBeGift,p=e.onPaymentSourceChange,d=e.onPaymentSourceAdd,h=e.onPurchaseTermsChange,y=e.onToggleIsGift,b=[],m=null!=s?n[s]:null;null!=m&&m.invalid&&b.push((0,r.jsx)(U.Z,{icon:z.Z,color:U.Z.Colors.ERROR,iconSize:U.Z.Sizes.NONE,iconClassName:Q().invalidIcon,children:k.Z.Messages.BILLING_PAYMENT_SOURCE_INVALID},"source_invalid"));null!=i&&(i.taxInclusive?b.push((0,r.jsx)(U.Z,{icon:V.Z,color:U.Z.Colors.PRIMARY,iconSize:U.Z.Sizes.LARGE,children:k.Z.Messages.BILLING_SALES_TAX_INCLUDED},"tax_included")):i.tax>0&&b.push((0,r.jsx)(U.Z,{icon:V.Z,color:U.Z.Colors.PRIMARY,iconSize:U.Z.Sizes.LARGE,children:k.Z.Messages.BILLING_SALES_TAX_ADDED.format({tax:(0,W.T4)(i.tax,i.currency)})},"tax_added")));return(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(c.vw,{className:Q().formTitle,children:k.Z.Messages.BILLING_PAY_FOR_IT_WITH}),(0,r.jsx)(F.Z,{
paymentSources:Object.values(n),selectedPaymentSourceId:s,hidePersonalInformation:a,onChange:p,onPaymentSourceAdd:d}),b,l&&(0,r.jsx)(c.XZ,{disabled:f,className:Q().giftToggle,type:c.XZ.Types.INVERTED,value:u,onChange:y,children:(0,r.jsx)("div",{className:Q().checkboxLabel,children:k.Z.Messages.BILLING_IS_GIFT_PURCHASE})}),(0,r.jsx)(G.Z,{onChange:h,forceShow:!0,className:Q().purchaseTerms,finePrint:t})]})},ee=function(e){var t=e.canSubmit,n=e.submitButtonText,o=e.useShinySubmitButton,i=e.isPurchasing,a=e.hasAcceptedTerms,s=e.paymentSource,l=e.onPurchase,u=e.tooltipText,f=e.needsToBeGift,p=e.isGift,d=null!=s&&!s.invalid,h=a&&!(f&&!p)&&d&&t,y={submitting:i,color:c.zx.Colors.GREEN,disabled:!h,onClick:l};return(0,r.jsx)(C.mz,{children:(0,r.jsxs)("div",{className:Q().buyButtonTooltipWrapper,children:[y.disabled&&null!=u?(0,r.jsx)(H.ZP,{text:u,children:function(e){return(0,r.jsx)("div",q({"aria-hidden":!0,className:Q().buyButtonTooltipTarget},e))}}):null,o?(0,r.jsx)(Y.C,$(q({},y),{children:n
})):(0,r.jsx)(c.zx,$(q({type:"submit"},y),{children:n}))]})})},te=function(e){var t=e.submitting,n=e.braintreeNonce,o=e.venmoUsername,i=e.onVenmoContinue,a=e.onReopenVenmo,s=e.renderBackButton,l=0!==o.length&&null!=n;return(0,r.jsxs)(C.mz,{justify:E.Z.Justify.BETWEEN,direction:E.Z.Direction.HORIZONTAL,children:[s(),(0,r.jsx)(c.zx,{submitting:t,color:l?c.zx.Colors.BRAND:c.zx.Colors.PRIMARY,onClick:l?i:a,children:l?k.Z.Messages.NEXT:k.Z.Messages.PAYMENT_SOURCE_CONNECT_TO_VENMO})]})},ne=n(461061),re=n(910368),oe=n.n(re);function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ae(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function se(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){ae(i,r,o,a,s,"next",e)}function s(e){ae(i,r,o,a,s,"throw",e)}a(void 0)}))}}function le(e,t){
if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ue(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1;r.configurable=!0;"value"in r&&(r.writable=!0);Object.defineProperty(e,r.key,r)}}function ce(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function fe(e){fe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return fe(e)}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){ce(e,t,n[t])}))}return e}function de(e,t){return!t||"object"!==ye(t)&&"function"!=typeof t?ie(e):t}function he(e,t){he=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return he(e,t)}
var ye=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function be(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=fe(e);if(t){var o=fe(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return de(this,n)}}var me=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;(r=0,
o)&&(i=[2&i[0],o.value]);switch(i[0]){case 0:case 1:o=i;break;case 4:a.label++;return{value:i[1],done:!1};case 5:a.label++;r=i[1];i=[0];continue;case 7:i=a.ops.pop();a.trys.pop();continue;default:if(!(o=a.trys,o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1];o=i;break}if(o&&a.label<o[2]){a.label=o[2];a.ops.push(i);break}o[2]&&a.ops.pop();a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e];r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}
},ge=[S.Rg.PAYMENT_TYPE,S.Rg.CREDIT_CARD_INFORMATION,S.Rg.REVIEW],Se=[S.Rg.PAYMENT_TYPE,S.Rg.CREDIT_CARD_INFORMATION,S.Rg.REVIEW],Pe=[S.Rg.PAYMENT_TYPE,S.Rg.CREDIT_CARD_INFORMATION,S.Rg.ADDRESS,S.Rg.REVIEW],Ie=[S.Rg.PAYMENT_TYPE,S.Rg.PAYPAL,S.Rg.PAYPAL_ADDRESS,S.Rg.REVIEW],ve=[S.Rg.PAYMENT_TYPE,S.Rg.PAYMENT_REQUEST_INFO,S.Rg.REVIEW],Oe=[S.Rg.PAYMENT_TYPE,S.Rg.ADDRESS,S.Rg.REVIEW],Ae=[S.Rg.PAYMENT_TYPE,S.Rg.ADDRESS,S.Rg.REVIEW],Re=[S.Rg.PAYMENT_TYPE,S.Rg.VENMO,S.Rg.VENMO_ADDRESS,S.Rg.REVIEW],Ee=(0,N.Mg)(oe().innerPadding),Ce=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&he(e,t)}(n,e);var t=be(n);function n(){le(this,n);var e;(e=t.apply(this,arguments)).state={hasAcceptedNeccessaryTerms:!1,token:null,confirmingCard:!1,stripe:null};e.handleToggleIsGift=function(t,n){var r=e.props.onIsGiftUpdate
;null==r||r(n)};e.handlePurchaseTermsChange=function(t){e.setState({hasAcceptedNeccessaryTerms:t})};e.handleReopenPaypal=function(){I.i0()};e.handleReopenVenmo=function(){I.og()};e.handleCardInfoChange=function(e,t){f.Z.wait((function(){return y.sn(e,t)}))};e.handleBillingAddressChange=function(e,t){f.Z.wait((function(){return y.Ow(e,t)}))};var i=ie(e);e.handleCreditCardAdd=se((function(){var e,t,n,r,o;return me(this,(function(a){switch(a.label){case 0:e=i.props.billingAddressInfo;t=i.state,n=t.stripe,r=t.token;a.label=1;case 1:a.trys.push([1,3,,4]);return[4,h.f0(n,r,e)];case 2:o=a.sent();i.props.onPaymentSourceAdd(o.id);return[3,4];case 3:a.sent();return[3,4];case 4:return[2]}}))}));var a,s=ie(e);e.handleStripePaymentRequestAdd=(a=se((function(e){var t;return me(this,(function(n){switch(n.label){case 0:y.Xt(e);if(null==e){s.props.onBack();return[2]}n.label=1;case 1:n.trys.push([1,3,,4]);return[4,h.i6(e)];case 2:t=n.sent();s.props.onPaymentSourceAdd(t.id);return[3,4];case 3:n.sent()
;return[3,4];case 4:return[2]}}))})),function(e){return a.apply(this,arguments)});var l=ie(e);e.handlePaypalAdd=se((function(){var e,t,n,r,o;return me(this,(function(i){switch(i.label){case 0:e=l.props,t=e.braintreeEmail,n=e.braintreeNonce,r=e.billingAddressInfo;if(0===t.length||null==n)return[2];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,h.lP(n,r)];case 2:o=i.sent();l.props.onPaymentSourceAdd(o.id);return[3,4];case 3:i.sent();return[3,4];case 4:return[2]}}))}));var u,p=ie(e);e.handleVenmoAdd=se((function(){var e,t,n,r,o;return me(this,(function(i){switch(i.label){case 0:e=p.props,t=e.venmoUsername,n=e.braintreeNonce,r=e.billingAddressInfo;if(0===t.length||null==n)return[2];i.label=1;case 1:i.trys.push([1,3,,4]);return[4,h.lP(n,r)];case 2:o=i.sent();p.props.onPaymentSourceAdd(o.id);return[3,4];case 3:i.sent();return[3,4];case 4:return[2]}}))}));e.renderBackButton=function(){var t=e.props,n=t.step,o=t.steps,i=t.paymentSources,a=t.onBack,s=(0,S.Yp)(n,o),l=(0,
S.NW)(s,i)?k.Z.Messages.BACK:k.Z.Messages.CANCEL;return(0,r.jsx)(c.zx,{look:c.zx.Looks.LINK,className:Q().backButton,color:Q().backButtonColor,size:Q().backButtonSize,onClick:a,children:l})};e.stepRenderer=pe((ce(u={},S.Rg.PAYMENT_TYPE,{renderBody:function(){var t=e.props,n=t.hidePersonalInformation,i=t.onChoosePaymentType,a=t.isGiftable,s=t.needsToBeGift,l=t.isGift;return n?(0,r.jsx)(c.kz,{className:Q().errorBlock,children:k.Z.Messages.BILLING_ERROR_ADD_PAYMENT_SOURCE_STREAMER_MODE}):(0,r.jsxs)(o.Fragment,{children:[(0,r.jsx)(Z.Z,{className:Q().choosePaymentSourceType,onChooseType:i,allowStripeRequestPayments:!_.FB,onStripePaymentMethodReceived:e.handleStripePaymentRequestAdd}),a&&(0,r.jsx)(c.XZ,{disabled:s,className:Q().giftToggle,type:c.XZ.Types.INVERTED,value:l,onChange:e.handleToggleIsGift,children:(0,r.jsx)("div",{className:Q().checkboxLabel,children:k.Z.Messages.BILLING_IS_GIFT_PURCHASE})})]})},renderFooter:function(){return(0,r.jsx)(C.mz,{direction:E.Z.Direction.HORIZONTAL,
children:e.renderBackButton()})}}),ce(u,S.Rg.PAYMENT_REQUEST_INFO,{renderBody:function(){return(0,r.jsx)(x.k,{className:Q().formItem,stripePaymentMethod:e.props.stripePaymentMethod,submitting:e.props.submitting})},renderFooter:function(){return(0,r.jsx)(C.mz,{direction:E.Z.Direction.HORIZONTAL,children:e.renderBackButton()})}}),ce(u,S.Rg.PAYPAL,{renderBody:function(){return(0,r.jsx)(w.Z,{className:Q().formItem})},renderFooter:function(){var t=e.props,n=t.submitting,o=t.braintreeNonce,i=t.braintreeEmail,a=t.onPaypalContinue,s=t.paypalClient;return(0,r.jsx)(D,{submitting:n||null==s,braintreeNonce:o,braintreeEmail:i,onPaypalContinue:a,onReopenPaypal:e.handleReopenPaypal,renderBackButton:e.renderBackButton})}}),ce(u,S.Rg.VENMO,{renderBody:function(){return(0,r.jsx)(M.Z,{className:Q().formItem})},renderFooter:function(){var t=e.props,n=t.submitting,o=t.braintreeNonce,i=t.venmoUsername,a=t.onVenmoContinue,s=t.venmoClient;return(0,r.jsx)(te,{submitting:n||null==s,braintreeNonce:o,
venmoUsername:i,onVenmoContinue:a,onReopenVenmo:e.handleReopenVenmo,renderBackButton:e.renderBackButton})}}),ce(u,S.Rg.CREDIT_CARD_INFORMATION,{renderBody:function(){var t=e.props.billingError;return(0,r.jsx)(L.j,{billingError:t,onCardInfoChange:e.handleCardInfoChange})},renderFooter:function(){var t=e.props,n=t.isCardInfoValid,o=t.onCreditCardContinue,i=e.state,a=i.stripe,s=i.confirmingCard,l=ie(e),u=function(){var e=se((function(e){var t;return me(this,(function(n){switch(n.label){case 0:l.setState({confirmingCard:!0});n.label=1;case 1:n.trys.push([1,3,4,5]);return[4,h.qv(a,e)];case 2:t=n.sent();l.setState({token:t});y.fw();o();return[3,5];case 3:n.sent();return[3,5];case 4:l.setState({confirmingCard:!1});return[7];case 5:return[2]}}))}));return function(t){return e.apply(this,arguments)}}();return(0,r.jsx)(P.ElementsConsumer,{children:function(t){var o=t.elements;return(0,r.jsx)(L.r,{isCardInfoValid:n,submitting:s,renderBackButton:e.renderBackButton,onCreditCardContinue:function(){
return u(o)}})}})}}),ce(u,S.Rg.PAYPAL_ADDRESS,{renderBody:function(){var t=e.props,n=t.billingAddressInfo,o=t.billingError;return(0,r.jsx)(B.P,{billingAddressInfo:n,billingError:o,onBillingAddressChange:e.handleBillingAddressChange,paymentSourceType:ne.HeQ.PAYPAL})},renderFooter:function(){var t=e.props,n=t.isBillingAddressInfoValid,o=t.submitting;return(0,r.jsx)(B.B,{isBillingAddressInfoValid:n,submitting:o,onContinue:e.handlePaypalAdd,renderBackButton:e.renderBackButton})}}),ce(u,S.Rg.VENMO_ADDRESS,{renderBody:function(){var t=e.props,n=t.billingAddressInfo,o=t.billingError;return(0,r.jsx)(B.P,{billingAddressInfo:n,billingError:o,onBillingAddressChange:e.handleBillingAddressChange,paymentSourceType:ne.HeQ.VENMO})},renderFooter:function(){var t=e.props,n=t.isBillingAddressInfoValid,o=t.submitting;return(0,r.jsx)(B.B,{isBillingAddressInfoValid:n,submitting:o,onContinue:e.handleVenmoAdd,renderBackButton:e.renderBackButton})}}),ce(u,S.Rg.ADDRESS,{renderBody:function(){
var t=e.props,n=t.billingAddressInfo,o=t.billingError,i=t.steps;return(0,r.jsx)(B.P,{billingAddressInfo:n,billingError:o,onBillingAddressChange:e.handleBillingAddressChange,paymentSourceType:i===Oe?ne.HeQ.GIROPAY:ne.HeQ.CARD})},renderFooter:function(){var t=e.props,n=t.isBillingAddressInfoValid,o=t.submitting;return(0,r.jsx)(B.B,{isBillingAddressInfoValid:n,submitting:o,onContinue:e.handleCreditCardAdd,renderBackButton:e.renderBackButton})}}),ce(u,S.Rg.REVIEW,{renderBody:function(){var t=e.props,n=t.legalNotice,o=t.paymentSources,i=t.price,a=t.hidePersonalInformation,s=t.paymentSourceId,l=t.onReviewPaymentSourceChange,u=t.onReviewPaymentSourceAdd,c=t.isGiftable,f=t.isGift,p=t.needsToBeGift;return(0,r.jsx)(J,{legalNotice:n,paymentSources:o,price:i,hidePersonalInformation:a,paymentSourceId:s,onPaymentSourceChange:l,onPaymentSourceAdd:u,onPurchaseTermsChange:e.handlePurchaseTermsChange,onToggleIsGift:e.handleToggleIsGift,isGiftable:c,isGift:f,needsToBeGift:p})},renderFooter:function(){
var t=e.props,n=t.canSubmit,o=t.submitButtonText,i=t.useShinySubmitButton,a=t.isPurchasing,s=t.paymentSourceId,l=t.onPurchase,u=t.needsToBeGift,c=t.isGift,f=t.paymentSources;return(0,r.jsx)(ee,{canSubmit:n,submitButtonText:o,useShinySubmitButton:i,isPurchasing:a,hasAcceptedTerms:e.state.hasAcceptedNeccessaryTerms,paymentSource:null!=s?f[s]:null,onPurchase:l,tooltipText:e.disabledTooltip,needsToBeGift:u,isGift:c})}}),ce(u,S.Rg.CONFIRM,{renderBody:ne.VqG,renderFooter:ne.VqG}),ce(u,S.Rg.AWAITING_AUTHENTICATION,{renderBody:function(){return(0,r.jsx)(c.vw,{className:Q().formTitle,children:k.Z.Messages.PAYMENT_WAITING_FOR_AUTHENTICATION})},renderFooter:ne.VqG}),u),e.props.extraRenderers);return e}var i=n.prototype;i.componentDidMount=function(){var e=this;return se((function(){var t,n,r,o,i,a;return me(this,(function(s){switch(s.label){case 0:I.eI();t=e.props,n=t.onPaymentSourceChange,r=t.paymentSources,o=t.defaultPaymentSourceId,i=t.paymentSourceId
;null!=n&&(null!=i&&i!==o&&null!=r[i]?n(r[i]):null!=o&&null!=r[o]?n(r[o]):n(null));return[4,(0,j.d2)()];case 1:a=s.sent();e.setState({stripe:a});return[2]}}))}))()};i.componentDidUpdate=function(e){var t=this.props,n=t.onPaymentSourceChange,r=t.paymentSources,o=t.paymentSourceId;e.paymentSourceId!==o&&null!=o&&null!=r[o]&&(null==n||n(r[o]))};i.componentWillUnmount=function(){I.cx();y.tt();var e=this.props.onClearError;null==e||e();y.fw()};i.preventDefault=function(e){e.preventDefault()};i.renderHeader=function(){var e=this.props,t=e.renderHeader,n=e.billingError;return t(e.step,e.steps.map((function(e){return{id:e,label:(0,S.fO)(e)}})),null==(0,S.ly)(n)?n:null)};i.render=function(){var e=this.props,t=e.size,n=e.step,o=e.steps,i=e.className,a=e.transitionState,s=this.stepRenderer[n],l=s.renderBody();return(0,r.jsx)(P.Elements,{options:ne.OBo,stripe:this.state.stripe,children:(0,r.jsx)(C.Y0,{size:t,className:i,"aria-label":k.Z.Messages.SKU_PAYMENT_STEPS_LABEL,transitionState:a,
children:(0,r.jsx)(T.ZP,{children:(0,r.jsxs)("form",{className:Q().form,onSubmit:this.preventDefault,children:[this.renderHeader(),n!==S.Rg.CONFIRM?(0,r.jsx)("div",{className:Q().divider}):null,null!=l&&(0,r.jsx)(C.hz,{className:Q().modalContent,children:(0,r.jsx)("div",{className:Q().content,children:(0,r.jsx)(v.Z,{step:n,steps:o,sideMargin:Ee,children:l})})}),s.renderFooter()]})})})})};!function(e,t,n){t&&ue(e.prototype,t);n&&ue(e,n)}(n,[{key:"disabledTooltip",get:function(){var e=this.props,t=e.needsToBeGift,n=e.isGift,r=e.isGiftable;return this.state.hasAcceptedNeccessaryTerms?t&&!n?r?k.Z.Messages.APPLICATION_STORE_PURCHASE_GIFT_ONLY:k.Z.Messages.APPLICATION_STORE_PURCHASE_GIFT_ONLY_UNGIFTABLE:null:k.Z.Messages.BILLING_ACCEPT_TERMS_PAID_SERVICES_TOOLTIP}}]);return n}(o.PureComponent);Ce.defaultProps={canSubmit:!0,useShinySubmitButton:!1,size:C.Cg.SMALL,billingError:null,extraRenderers:{},className:Q().modal};const Te=u.ZP.connectStores([g.Z,b.Z,A.Z,O.Z,R.Z],(function(){return{
submitting:A.Z.isBusy,paymentSources:g.Z.paymentSources,defaultPaymentSourceId:g.Z.defaultPaymentSourceId,stripePaymentMethod:b.Z.stripePaymentMethod,creditCardInfo:b.Z.getCreditCardInfo(),isCardInfoValid:b.Z.isCardInfoValid,billingAddressInfo:b.Z.getBillingAddressInfo(),isBillingAddressInfoValid:b.Z.isBillingAddressInfoValid,braintreeEmail:b.Z.braintreeEmail,braintreeNonce:b.Z.braintreeNonce,venmoUsername:b.Z.venmoUsername,billingError:b.Z.error,paypalClient:R.Z.getPayPalClient(),venmoClient:R.Z.getVenmoClient(),hidePersonalInformation:O.Z.hidePersonalInformation}}))(Ce);function _e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ne(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function je(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function Ze(e){return function(){var t=this,n=arguments
;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){je(i,r,o,a,s,"next",e)}function s(e){je(i,r,o,a,s,"throw",e)}a(void 0)}))}}function we(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1;r.configurable=!0;"value"in r&&(r.writable=!0);Object.defineProperty(e,r.key,r)}}function Me(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function Be(e){Be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return Be(e)}function Le(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){
Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function xe(e,t){return!t||"object"!==Fe(t)&&"function"!=typeof t?Ne(e):t}function ke(e,t){ke=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return ke(e,t)}function De(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0){i.push(r.value);if(t&&i.length===t)break}}catch(e){s=!0;o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||Ge(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ue(e){return function(e){if(Array.isArray(e))return _e(e)}(e)||function(e){
if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ge(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Fe=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function Ge(e,t){if(e){if("string"==typeof e)return _e(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);return"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_e(e,t):void 0}}function Ye(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=Be(e);if(t){
var o=Be(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xe(this,n)}}var He=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;(r=0,o)&&(i=[2&i[0],o.value]);switch(i[0]){case 0:case 1:o=i;break;case 4:a.label++;return{value:i[1],done:!1};case 5:a.label++;r=i[1];i=[0];continue;case 7:i=a.ops.pop();a.trys.pop();continue;default:if(!(o=a.trys,o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1];o=i;break}if(o&&a.label<o[2]){a.label=o[2]
;a.ops.push(i);break}o[2]&&a.ops.pop();a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e];r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Ve=[S.Rg.REVIEW,S.Rg.CONFIRM],ze=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&ke(e,t)}(n,e);var t=Ye(n);function n(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n);var r;(r=t.call(this,e))._hasChangedSteps=!1;r.handlePaypalContinue=function(){r.setState({step:S.Rg.PAYPAL_ADDRESS})};r.handleVenmoContinue=function(){r.setState({step:S.Rg.VENMO_ADDRESS})};r.handleCreditCardContinue=function(){r.setState({step:S.Rg.ADDRESS})};r.handleReviewPaymentSourceChange=function(e){r.setState({paymentSourceId:null!=e?e.id:null})};r.handleReviewPaymentSourceAdd=function(){r.setState({
step:S.Rg.PAYMENT_TYPE,steps:Se,paymentSourceId:null});var e=r.props.onClearError;e&&e()};r.handleBack=function(){var e=r.props,t=e.paymentSources,n=e.onClose,o=r.state,i=o.step,a=o.steps,s=r.stepsToRender,l=(0,S.Yp)(i,s);if(l>0){var u=s[l-1],c=u===S.Rg.PAYMENT_TYPE;c&&y.fw();r.setState({step:u,steps:c?Se:a})}else if((0,S.NW)(l,t)){var f=r.props.defaultPaymentSourceId;r.setState({step:S.Rg.REVIEW,steps:ge,paymentSourceId:f})}else n()};r.handleChoosePaymentType=function(e){switch(e){case ne.HeQ.PAYPAL:r.setState({step:S.Rg.PAYPAL,steps:Ie});break;case ne.HeQ.CARD:r.setState({step:S.Rg.CREDIT_CARD_INFORMATION,steps:Pe});break;case ne.HeQ.PAYMENT_REQUEST:r.setState({step:S.Rg.PAYMENT_REQUEST_INFO,steps:ve});break;case ne.HeQ.GIROPAY:r.setState({step:S.Rg.ADDRESS,steps:Oe});break;case ne.HeQ.PAYSAFE_CARD:r.setState({step:S.Rg.ADDRESS,steps:Ae});break;case ne.HeQ.VENMO:r.setState({step:S.Rg.VENMO,steps:Re})}};r.handlePaymentSourceAdd=function(e){r.setState({step:S.Rg.REVIEW,
paymentSourceId:e})};var o=Ne(r);r.handlePurchase=Ze((function(){var e,t,n,r,i;return He(this,(function(a){switch(a.label){case 0:e=o.props,t=e.paymentSources,n=e.onPurchase,r=e.isGift;if(null==(i=o.state.paymentSourceId))return[2];a.label=1;case 1:a.trys.push([1,3,,4]);return[4,n(t[i],r)];case 2:a.sent();o.setState({steps:Ve,step:S.Rg.CONFIRM});return[3,4];case 3:a.sent();return[3,4];case 4:return[2]}}))}));r.handleSelectPlan=function(){var e=r.props.paymentSources,t=Object.values(e).length>0;r.setState({step:t?S.Rg.REVIEW:S.Rg.PAYMENT_TYPE})};var i=e.defaultPaymentSourceId,a=e.paymentSources,s=e.initialStep,l=Object.values(a).length>0,u=s;null==u&&(u=l?S.Rg.REVIEW:S.Rg.PAYMENT_TYPE);r.state={paymentSourceId:i,steps:l?ge:Se,step:u,errorStep:null};return r}var o=n.prototype;o.componentDidMount=function(){g.Z.hasFetchedPaymentSources||h.tZ()};o.componentDidUpdate=function(e,t){var n=this.props.onStepChange,r=this.state.step;if(r!==t.step){this._hasChangedSteps=!0;null!=n&&n(t.step,r)}}
;o.render=function(){var e,t=this,n=this.props,o=n.isPurchasing,i=n.canSubmit,a=n.submitButtonText,s=n.useShinySubmitButton,l=n.legalNotice,u=n.renderHeader,c=n.onPaymentSourceChange,f=n.price,p=n.onClearError,d=n.size,h=n.renderConfirmationBody,y=n.renderConfirmationFooter,b=n.className,m=n.isGift,g=n.isGiftable,P=n.needsToBeGift,I=n.onIsGiftUpdate,v=n.transitionState,O=(Me(e={},S.Rg.CONFIRM,{renderBody:h,renderFooter:y}),Me(e,S.Rg.SELECT_PLAN,{renderBody:function(){return t.props.renderSelectPlanBody(t.handleSelectPlan)},renderFooter:function(){return t.props.renderSelectPlanFooter()}}),e),A=this.state,R=A.step,E=A.paymentSourceId,C=this.stepsToRender;return(0,r.jsx)(Te,{transitionState:v,className:b,isPurchasing:o,canSubmit:i,submitButtonText:a,useShinySubmitButton:s,legalNotice:l,renderHeader:u,onPaymentSourceChange:c,price:f,onClearError:p,size:d,extraRenderers:O,step:R,steps:C,paymentSourceId:E,isGiftable:g,isGift:m,needsToBeGift:P,onIsGiftUpdate:I,onBack:this.handleBack,
onChoosePaymentType:this.handleChoosePaymentType,onCreditCardContinue:this.handleCreditCardContinue,onPaymentSourceAdd:this.handlePaymentSourceAdd,onPurchase:this.handlePurchase,onPaypalContinue:this.handlePaypalContinue,onVenmoContinue:this.handleVenmoContinue,onReviewPaymentSourceChange:this.handleReviewPaymentSourceChange,onReviewPaymentSourceAdd:this.handleReviewPaymentSourceAdd})};n.getDerivedStateFromProps=function(e,t){var n=e.billingError,r=e.isAwaitingAuthentication,o=t.errorStep,i={};if(null==n)null!=o&&(i.errorStep=null);else{var a=(0,S.ly)(n);if(null!=a&&a!==t.errorStep){i.step=a;i.errorStep=a}}null==t.paymentSourceId&&null!=e.defaultPaymentSourceId&&(i.paymentSourceId=e.defaultPaymentSourceId);r?i.step=S.Rg.AWAITING_AUTHENTICATION:t.step===S.Rg.AWAITING_AUTHENTICATION&&(i.step=null!=n?S.Rg.REVIEW:S.Rg.CONFIRM);return i};!function(e,t,n){t&&we(e.prototype,t);n&&we(e,n)}(n,[{key:"stepsToRender",get:function(){var e=this.props.prependSteps,t=this.state.steps
;return null!=e?Ue(e).concat(Ue(t)):t}},{key:"closable",get:function(){var e=this.state.step;return 0===(0,S.Yp)(e,this.stepsToRender)||!this._hasChangedSteps}}]);return n}(o.Component);ze.defaultProps={useShinySubmitButton:!1,needsToBeGift:!1,isGiftable:!1,isGift:!1,renderConfirmationBody:ne.VqG,renderConfirmationFooter:ne.VqG,renderSelectPlanBody:ne.VqG,renderSelectPlanFooter:ne.VqG};const We=o.forwardRef((function(e,t){var n=De((0,u.Wu)([g.Z],(function(){return[g.Z.paymentSources,g.Z.defaultPaymentSourceId]})),2),o=n[0],i=n[1],a=(0,u.e7)([b.Z],(function(){return b.Z.error})),s=De((0,u.Wu)([m.Z],(function(){return[m.Z.error,m.Z.isAwaitingAuthentication]})),2),l=s[0],c=s[1];return(0,r.jsx)(ze,Le(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))))
;r.forEach((function(t){Me(e,t,n[t])}))}return e}({},e),{ref:t,billingError:null!=l?l:a,paymentSources:o,defaultPaymentSourceId:i,isAwaitingAuthentication:c}))}));var Ke=n(657390),Qe=n(485359),Xe=n(674500),qe=n(367124),$e=n(859023),Je=n(922877),et=n(808018),tt=n(512238),nt=n(331792),rt=n(842256),ot=n(693518),it=n(932847),at=n(770040),st=n(935406),lt=n(305630),ut=n(479091),ct=n(654721),ft=n(6369),pt=n.n(ft);function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ht(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function yt(e,t,n,r,o,i,a){try{var s=e[i](a),l=s.value}catch(e){n(e);return}s.done?t(l):Promise.resolve(l).then(r,o)}function bt(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){yt(i,r,o,a,s,"next",e)}function s(e){yt(i,r,o,a,s,"throw",e)}a(void 0)}))}}function mt(e,t){
if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function gt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1;r.configurable=!0;"value"in r&&(r.writable=!0);Object.defineProperty(e,r.key,r)}}function St(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function Pt(e){Pt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return Pt(e)}function It(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&Et(e,t)}function vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){
return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){St(e,t,n[t])}))}return e}function Ot(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function At(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||(o[n]=e[n])}return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}}return o}function Rt(e,t){
return!t||"object"!==Tt(t)&&"function"!=typeof t?ht(e):t}function Et(e,t){Et=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return Et(e,t)}function Ct(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done);a=!0){i.push(r.value);if(t&&i.length===t)break}}catch(e){s=!0;o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dt(e,t)}(e,t)||function(){
throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Tt=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function _t(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=Pt(e);if(t){var o=Pt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rt(this,n)}}var Nt=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){
if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;(r=0,o)&&(i=[2&i[0],o.value]);switch(i[0]){case 0:case 1:o=i;break;case 4:a.label++;return{value:i[1],done:!1};case 5:a.label++;r=i[1];i=[0];continue;case 7:i=a.ops.pop();a.trys.pop();continue;default:if(!(o=a.trys,o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1];o=i;break}if(o&&a.label<o[2]){a.label=o[2];a.ops.push(i);break}o[2]&&a.ops.pop();a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e];r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},jt=a()({UNSUPPORTED_OS:null,TEST_MODE:null,GIFT_ONLY:null,PREORDER:null}),Zt=function(e){It(n,e);var t=_t(n);function n(){mt(this,n);var e;(e=t.apply(this,arguments)).state={paymentSourceId:null}
;e._loadId=l().v4();e._stepStartTime=Date.now();e._flowStartTime=Date.now();e._paymentModalRef=o.createRef();e.handlePaymentSourceChange=function(t){var n=e.props,r=n.applicationId,o=n.skuId;if(null!=t){d.x2(r,o,t.id);e.setState({paymentSourceId:t.id})}else{d.x2(r,o,null);e.setState({paymentSourceId:null})}};var i,a=ht(e);e.handlePurchase=(i=bt((function(e){var t,n,r,o,i,s,l;return Nt(this,(function(u){switch(u.label){case 0:t=a.props,n=t.applicationId,r=t.sku;o=a.getPrice();i=null!=o?o.amount:0;s=null!=o?o.currency:ne.pKx.USD;if(null==r)throw new Error("SKU is null during purchase");if(et.Z.isPurchasingSKU)return[2];u.label=1;case 1:u.trys.push([1,3,,4]);it.default.track(ne.rMx.PAYMENT_FLOW_COMPLETED,Ot(vt({},a.getBaseAnalyticsData()),{duration_ms:Date.now()-a._flowStartTime}));return[4,d.ZZ(n,r.id,{expectedAmount:i,expectedCurrency:s,paymentSource:e,analyticsLoadId:a._loadId,isGift:a.isGift})];case 2:u.sent();(0,p.Bv)();return[3,4];case 3:l=u.sent()
;it.default.track(ne.rMx.PAYMENT_FLOW_FAILED,Ot(vt({},a.getBaseAnalyticsData()),{payment_gateway:e.type===ne.HeQ.CARD?ne.gg$.STRIPE:ne.gg$.BRAINTREE,payment_source_id:e.id,duration_ms:Date.now()-a._flowStartTime,payment_error_code:l.code}));throw l;case 4:return[2]}}))})),function(e){return i.apply(this,arguments)});e.handleClose=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=e.props.onClose;n(t)};e.handleStepChange=function(t,n){var r=Date.now();it.default.track(ne.rMx.PAYMENT_FLOW_STEP,Ot(vt({},e.getBaseAnalyticsData()),{from_step:t,to_step:n,step_duration_ms:r-e._stepStartTime,flow_duration_ms:r-e._flowStartTime}));e._stepStartTime=r;n===S.Rg.CONFIRM&&d.WD()};e.renderHeader=function(t,n,o){var i=e.props.application;return t===S.Rg.CONFIRM?null!=i?(0,r.jsx)(Ke.Z,{application:i,splashSize:880}):null:e.renderDefaultHeader(t,n,o)};e.renderConfirmation=function(){var t=e.props,n=t.application,o=t.sku,i=t.isIAP,a=t.giftCode
;if(null==o||null==n)throw new Error("No SKU for confirmation step!");return(0,r.jsx)("div",{className:pt().confirmContent,children:(0,r.jsxs)(E.Z,{direction:E.Z.Direction.VERTICAL,children:[(0,r.jsx)(C.ol,{onClick:function(){return e.handleClose()},className:pt().confirmCloseButton}),null!=a?(0,r.jsx)(lt.Z,{giftCode:a,application:n,sku:o,onClose:function(){return e.handleClose()}}):(0,r.jsx)(ut.Z,{application:n,sku:o,isIAP:i,onClose:function(){return e.handleClose()}})]})})};return e}var i=n.prototype;i.getSkuPrice=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.state,n=e.prices,r=t.paymentSourceId;return null==n?null:n[null!=r?r:et.c]};i.componentDidMount=function(){var e=this,t=this.props,n=t.sku,r=t.skuId,o=t.applicationId;null==n?d.jU(o,r).catch((function(t){return e.handleClose(t.message)})):it.default.track(ne.rMx.PAYMENT_FLOW_STARTED,this.getBaseAnalyticsData())}
;i.componentDidUpdate=function(e,t){null==e.sku&&null!=this.props.sku&&it.default.track(ne.rMx.PAYMENT_FLOW_STARTED,this.getBaseAnalyticsData());this.checkPriceChange(this.getSkuPrice(e,t),this.getSkuPrice())};i.checkPriceChange=function(e,t){var n=this.props,r=n.sku,o=n.onClose;null!=e&&null!=t&&e.discount_percent_off!==t.discount_percent_off&&f.Z.wait((function(){if(null==r)throw new Error("Unexpected null SKU");o(ne.G5l)}))};i.getPrice=function(){var e=this.props,t=e.sku,n=e.isFetchingSKU;if(null==t||n)return null;var r=this.getSkuPrice();if(null!=r)return{amount:r.amount,tax:r.tax,taxInclusive:r.tax_inclusive,currency:r.currency};if(null==this.state.paymentSourceId){var o=t.getPrice();if(null==o)throw new Error("Sku Price cannot be null");return{amount:o.amount,tax:0,taxInclusive:!1,currency:o.currency}}return null};i.getBaseAnalyticsData=function(){var e=this.props,t=e.sku,n=e.analyticsLocation,r=e.appContext,o=e.promotionId;if(null==t)return{};var i=this.getPrice()
;return Ot(vt({},(0,Xe.Z)(t)),{load_id:this._loadId,payment_type:"sku",is_gift:this.isGift,client_event_source:r===ne.IlC.OVERLAY?ne.IlC.OVERLAY:null,location:n,price:null!=i?i.amount:null,currency:null!=i?i.currency:null,location_promotion_id:o})};i.renderPurchaseWarning=function(){var e=this.props,t=e.sku,n=e.isInTestMode,i=e.isIAP,a=e.isUserEntitledToSku;if(null==t)return null;var s=(0,st.hX)((0,_.Xf)()),l=[];null!=s&&t.supportedOperatingSystems.includes(s)||i||l.push((0,r.jsx)(U.Z,{icon:z.Z,iconSize:U.Z.Sizes.SMALL,color:U.Z.Colors.WARNING,className:pt().errorBlock,children:k.Z.Messages.APPLICATION_STORE_PURCHASE_GAME_CURRENT_OS_UNSUPPORTED},jt.UNSUPPORTED_OS));n&&l.push((0,r.jsx)(U.Z,{icon:z.Z,iconSize:U.Z.Sizes.SMALL,color:U.Z.Colors.WARNING,className:pt().errorBlock,children:k.Z.Messages.APPLICATION_STORE_PURCHASE_TEST_MODE},jt.TEST_MODE));!0===a&&this.isGiftable&&l.push((0,r.jsx)(U.Z,{icon:z.Z,iconSize:U.Z.Sizes.SMALL,color:U.Z.Colors.PRIMARY,className:pt().errorBlock,
children:k.Z.Messages.APPLICATION_STORE_PURCHASE_GIFT_ONLY},jt.GIFT_ONLY));t.isPreorder()&&l.push((0,r.jsx)(U.Z,{icon:z.Z,iconSize:U.Z.Sizes.SMALL,color:U.Z.Colors.PRIMARY,className:pt().errorBlock,children:k.Z.Messages.APPLICATION_STORE_PURCHASE_WARNING_PREORDER.format({date:(0,at.en)(t)})},jt.PREORDER));return(0,r.jsx)(o.Fragment,{children:l})};i.renderGenericError=function(e,t){return null==e&&null==t?null:(0,r.jsx)(c.kz,{className:pt().errorBlock,children:null!=e?e.message:null!=t?t.message:null})};i.renderDefaultHeader=function(e,t,n){var o=this,i=this.props,a=i.isIAP,s=i.application,l=i.sku,u=i.purchaseError;if(null==l||null==s)return null;var f=this.getPrice();return(0,r.jsxs)(C.xB,{direction:E.Z.Direction.VERTICAL,align:E.Z.Align.START,separator:!1,children:[(0,r.jsx)(Ke.Z,{application:s,splashSize:880}),(0,r.jsxs)(E.Z,{align:E.Z.Align.CENTER,className:pt().headerHeader,children:[(0,r.jsx)(c.vw,{tag:c.RB.H4,children:(0,ct.Y)(a,l.type)}),(0,r.jsx)(C.ol,{onClick:function(){
return o.handleClose()}})]}),(0,r.jsxs)(E.Z,{align:E.Z.Align.CENTER,className:pt().headerContent,children:[(0,r.jsxs)(E.Z,{align:E.Z.Align.CENTER,children:[(0,r.jsx)(ot.Z,{game:s}),(0,r.jsx)("div",{className:pt().applicationName,children:l.name})]}),(0,r.jsx)("div",{className:pt().price,children:null!=f?(0,W.T4)(f.amount,f.currency):(0,r.jsx)(c.$j,{type:c.$j.Type.PULSING_ELLIPSIS,className:pt().priceSpinner})})]}),this.renderPurchaseWarning(),this.renderGenericError(u,n),t.length>1?(0,r.jsx)(rt.Z,{activeId:e,breadcrumbs:t,className:pt().breadcrumbs}):null]})};i.render=function(){var e=this,t=this.props,n=t.sku,o=t.isFetchingSKU,i=t.isPurchasing,a=t.purchaseError,s=t.isUserEntitledToSku,l=t.forceConfirmationStepOnMount,u=t.transitionState;return null==n||o?(0,r.jsx)(c.$j,{}):(0,r.jsx)(We,{ref:this._paymentModalRef,transitionState:u,canSubmit:null!=this.getSkuPrice(),needsToBeGift:n.type===ne.epS.DURABLE_PRIMARY&&!0===s,isGiftable:this.isGiftable,isPurchasing:i,purchaseError:a,
price:this.getPrice(),size:C.Cg.SMALL,onPurchase:this.handlePurchase,onIsGiftUpdate:d.x9,onPaymentSourceChange:this.handlePaymentSourceChange,onClose:function(){return e.handleClose()},onClearError:d.pB,renderHeader:this.renderHeader,renderConfirmationBody:this.renderConfirmation,submitButtonText:this.isGift?k.Z.Messages.APPLICATION_STORE_BUY_GIFT:k.Z.Messages.APPLICATION_STORE_BUY,initialStep:l?S.Rg.CONFIRM:null,onStepChange:this.handleStepChange,isGift:this.isGift})};!function(e,t,n){t&&gt(e.prototype,t);n&&gt(e,n)}(n,[{key:"closable",get:function(){var e=this._paymentModalRef.current;return null!=e&&e.closable}},{key:"isGiftable",get:function(){var e=this.props.sku;return null!=e&&e.isGiftable(this.getPrice())}},{key:"isGift",get:function(){return this.props.isGift&&this.isGiftable}}]);return n}(o.PureComponent),wt=o.forwardRef((function(e,t){var n=e.applicationId,o=e.skuId,i=At(e,["applicationId","skuId"]),a=(0,u.e7)([qe.Z],(function(){return qe.Z.getGame(n)})),s=Ct((0,
u.Wu)([et.Z],(function(){return[et.Z.getPricesForSku(o),et.Z.isPurchasingSKU,et.Z.error,et.Z.analyticsLocation,et.Z.promotionId,et.Z.giftCode,et.Z.isGift,et.Z.isIAP,et.Z.forceConfirmationStepOnMount]})),9),l=s[0],c=s[1],f=s[2],p=s[3],d=s[4],h=s[5],y=s[6],b=s[7],g=s[8],S=Ct((0,u.Wu)([tt.Z],(function(){return[tt.Z.get(o),tt.Z.isFetching(o)]})),2),P=S[0],I=S[1],v=(0,u.e7)([Qe.Z,nt.Z],(function(){return nt.Z.inTestModeForApplication(n)||Qe.Z.inDevModeForApplication(n)}),[n]),O=(0,u.e7)([Je.Z,$e.default],(function(){return Je.Z.isEntitledToSku($e.default.getCurrentUser(),o,n)})),A=(0,u.e7)([m.Z],(function(){return m.Z.error}));return(0,r.jsx)(Zt,Ot(vt({},i),{application:a,applicationId:n,skuId:o,prices:l,isPurchasing:c,purchaseError:null!=A?A:f,analyticsLocation:p,promotionId:d,isIAP:b,giftCode:h,isGift:y,forceConfirmationStepOnMount:g,sku:P,isFetchingSKU:I,isInTestMode:v,isUserEntitledToSku:O,ref:t}))})),Mt=function(e){It(n,e);var t=_t(n);function n(){mt(this,n);var e
;(e=t.apply(this,arguments))._skuPaymentModalRef=o.createRef();return e}var i=n.prototype;i.close=function(){null!=this._skuPaymentModalRef.current&&this._skuPaymentModalRef.current.closable&&this.handleClose()};i.handleClose=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.props.onClose(e)};i.render=function(){var e=this;return(0,r.jsx)(wt,Ot(vt({},this.props),{ref:this._skuPaymentModalRef,onClose:function(){return e.handleClose()}}))};return n}(o.PureComponent);const Bt=Mt},630206:(e,t,n)=>{n.d(t,{Z:()=>P});var r=n(363010),o=n(173436),i=n(105405);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function l(e){l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return l(e)}function u(e){for(var t=1;t<arguments.length;t++){
var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){s(e,t,n[t])}))}return e}function c(e,t){return!t||"object"!==p(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e,t){f=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return f(e,t)}var p=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=l(e);if(t){var o=l(this).constructor
;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return c(this,n)}}var h=864e5,y=!1,b=Object.freeze({userAffinities:[],affinityUserIds:new Set,lastFetched:0}),m=u({},b);function g(){m.affinityUserIds=new Set(m.userAffinities.map((function(e){return e.user_id})).filter((function(e){return!i.Z.isBlocked(e)})))}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&f(e,t)}(n,e);var t=d(n);function n(){a(this,n);return t.apply(this,arguments)}var r=n.prototype;r.initialize=function(e){this.waitFor(i.Z);if(null!=e){m.userAffinities=e.userAffinities;m.affinityUserIds=new Set(e.affinityUserIds);m.lastFetched=e.lastFetched}this.syncWith([i.Z],g)};r.needsRefresh=function(){return Date.now()-m.lastFetched>h};r.getFetching=function(){return y};r.getState=function(){return m}
;r.getUserAffinities=function(){return m.userAffinities};r.getUserAffinitiesUserIds=function(){return m.affinityUserIds};r.__getLocalVars=function(){return{USER_AFFINITY_TTL:h,fetching:y,DEFAULT_AFFINITY_STORE_STATE:b,state:m}};return n}(r.ZP.PersistedStore);S.displayName="UserAffinitiesStore";S.persistKey="UserAffinitiesStore";S.migrations=[function(e){return null}];const P=new S(o.Z,{LOAD_USER_AFFINITIES_SUCCESS:function(e){var t,n=e.affinities;m.userAffinities=null!==(t=n.user_affinities)&&void 0!==t?t:[];m.lastFetched=Date.now();g();y=!1},LOAD_USER_AFFINITIES:function(){y=!0},LOAD_USER_AFFINITIES_FAILURE:function(){y=!1},LOGOUT:function(){m=u({},b)}})},513857:(e,t,n)=>{n.d(t,{u:()=>I,Z:()=>O});var r=n(785893),o=n(667294),i=n(294184),a=n.n(i),s=n(647446),l=n(331535),u=n(511716),c=n(487502),f=n(959797),p=n(716523),d=n.n(p);function h(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function y(e,t,n){t in e?Object.defineProperty(e,t,{value:n,
enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function b(e){b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return b(e)}function m(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e,t){g=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return g(e,t)}var S=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=b(e);if(t){var o=b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return m(this,n)}}
var I={DEFAULT:"default",SUCCESS:"success",ERROR:"error"},v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&g(e,t)}(n,e);var t=P(n);function n(){h(this,n);var e;(e=t.apply(this,arguments)).inputRef=o.createRef();e.containerRef=o.createRef();e.handleButtonClick=function(){e.select();var t=e.props;(0,t.onCopy)(t.value)};e.handleInputClick=function(){e.select()};return e}var i=n.prototype;i.select=function(){var e;null===(e=this.inputRef.current)||void 0===e||e.select()};i.renderInput=function(e){var t,n=this.props,o=n.value,i=n.mode,s=null===(t=this.context)||void 0===t?void 0:t.titleId;return(0,r.jsx)("input",{className:a()((0,u.l)(d(),"input",i),y({},d().inputHidden,e)),ref:this.inputRef,type:"text",value:o,onClick:this.handleInputClick,readOnly:!0,"aria-labelledby":s})};i.render=function(){
var e,t=this.props,n=t.text,o=void 0===n?f.Z.Messages.COPY:n,i=t.mode,p=t.hideMessage,h=t.className,y=t.buttonLook,b=null!=p;switch(i){case I.SUCCESS:e=l.Tt.GREEN;break;case I.ERROR:e=l.Tt.RED;break;default:e=this.props.buttonColor}return(0,r.jsx)(s.tE,{focusTarget:this.inputRef,ringTarget:this.containerRef,children:(0,r.jsx)("div",{className:a()((0,u.l)(d(),"copyInput",i),h),ref:this.containerRef,children:(0,r.jsxs)(c.Z,{className:d().layout,children:[(0,r.jsxs)(c.Z,{className:d().inputWrapper,children:[this.renderInput(b),b?(0,r.jsx)("div",{className:d().hiddenMessage,children:p}):null]}),(0,r.jsx)(c.Z,{shrink:1,grow:0,style:{margin:0},children:(0,r.jsx)(l.zx,{className:d().button,onClick:this.handleButtonClick,size:l.Ph.MIN,color:e,look:y,children:o})})]})})})};return n}(o.PureComponent);v.contextType=l.q3;v.defaultProps={supportsCopy:!0,buttonColor:l.Tt.PRIMARY,buttonLook:l.iL.FILLED,mode:I.DEFAULT};v.Modes=I;v.ButtonColors=l.Tt;v.ButtonLooks=l.iL;const O=v},496363:(e,t,n)=>{
n.d(t,{Z:()=>l});var r=n(785893),o=(n(667294),n(240243));function i(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function a(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||(o[n]=e[n])}return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}}
return o}function l(e){var t=e.width,n=void 0===t?16:t,l=e.height,u=void 0===l?16:l,c=e.color,f=void 0===c?"currentColor":c,p=e.foreground,d=s(e,["width","height","color","foreground"]);return(0,r.jsx)("svg",a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){i(e,t,n[t])}))}return e}({},(0,o.Z)(d)),{width:n,height:u,viewBox:"0 0 18 20",children:(0,r.jsx)("path",{className:p,fill:f,d:"M15,15H3V13H15Zm0-4H3V9H15Zm0-4H3V5H15ZM0,20l1.5-1.5L3,20l1.5-1.5L6,20l1.5-1.5L9,20l1.5-1.5L12,20l1.5-1.5L15,20l1.5-1.5L18,20V0L16.5,1.5,15,0,13.5,1.5,12,0,10.5,1.5,9,0,7.5,1.5,6,0,4.5,1.5,3,0,1.5,1.5,0,0Z"})}))}},567397:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(785893),o=(n(667294),n(240243));function i(e,t,n){t in e?Object.defineProperty(e,t,{value:n,
enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function a(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||(o[n]=e[n])}return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}}return o}function l(e){
var t=e.width,n=void 0===t?14:t,l=e.height,u=void 0===l?14:l,c=e.color,f=void 0===c?"currentColor":c,p=e.foreground,d=s(e,["width","height","color","foreground"]);return(0,r.jsx)("svg",a(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){i(e,t,n[t])}))}return e}({},(0,o.Z)(d)),{width:n,height:u,viewBox:"0 0 14 14",children:(0,r.jsx)("path",{className:p,fill:f,d:"M12,0 C12.8284271,0 14,1.17157288 14,2 L14,12 C14,12.8284271 12.8284271,14 12,14 L2,14 C1.17157288,14 0,12.8284271 0,12 L0,2 C0,1.17157288 1.17157288,0 2,0 L12,0 Z M8,3 L6,3 L6,8 L8,8 L8,3 Z M8,11 L8,9 L6,9 L6,11 L8,11 Z"})}))}},672561:(e,t,n)=>{n.d(t,{Z:()=>r});const r=[{label:"Alberta",value:"AB"},{label:"British Columbia",value:"BC"},{label:"Manitoba",value:"MB"},{
label:"New Brunswick",value:"NB"},{label:"Newfoundland and Labrador",value:"NL"},{label:"Nova Scotia",value:"NS"},{label:"Ontario",value:"ON"},{label:"Prince Edward Island",value:"PE"},{label:"Quebec",value:"QC"},{label:"Saskatchewan",value:"SK"},{label:"Northwest Territories",value:"NT"},{label:"Nunavut",value:"NU"},{label:"Yukon",value:"YT"}]},188068:(e,t,n)=>{n.d(t,{Z:()=>r});const r=[{label:"Alabama",value:"AL"},{label:"Alaska",value:"AK"},{label:"American Samoa",value:"AS"},{label:"Arizona",value:"AZ"},{label:"Arkansas",value:"AR"},{label:"Armed Forces: Americas",value:"AA"},{label:"Armed Forces: Europe",value:"AE"},{label:"Armed Forces: Pacific",value:"AP"},{label:"California",value:"CA"},{label:"Colorado",value:"CO"},{label:"Connecticut",value:"CT"},{label:"Delaware",value:"DE"},{label:"District Of Columbia",value:"DC"},{label:"Federated States Of Micronesia",value:"FM"},{label:"Florida",value:"FL"},{label:"Georgia",value:"GA"},{label:"Guam",value:"GU"},{label:"Hawaii",
value:"HI"},{label:"Idaho",value:"ID"},{label:"Illinois",value:"IL"},{label:"Indiana",value:"IN"},{label:"Iowa",value:"IA"},{label:"Kansas",value:"KS"},{label:"Kentucky",value:"KY"},{label:"Louisiana",value:"LA"},{label:"Maine",value:"ME"},{label:"Marshall Islands",value:"MH"},{label:"Maryland",value:"MD"},{label:"Massachusetts",value:"MA"},{label:"Michigan",value:"MI"},{label:"Minnesota",value:"MN"},{label:"Mississippi",value:"MS"},{label:"Missouri",value:"MO"},{label:"Montana",value:"MT"},{label:"Nebraska",value:"NE"},{label:"Nevada",value:"NV"},{label:"New Hampshire",value:"NH"},{label:"New Jersey",value:"NJ"},{label:"New Mexico",value:"NM"},{label:"New York",value:"NY"},{label:"North Carolina",value:"NC"},{label:"North Dakota",value:"ND"},{label:"Northern Mariana Islands",value:"MP"},{label:"Ohio",value:"OH"},{label:"Oklahoma",value:"OK"},{label:"Oregon",value:"OR"},{label:"Palau",value:"PW"},{label:"Pennsylvania",value:"PA"},{label:"Puerto Rico",value:"PR"},{label:"Rhode Island",
value:"RI"},{label:"South Carolina",value:"SC"},{label:"South Dakota",value:"SD"},{label:"Tennessee",value:"TN"},{label:"Texas",value:"TX"},{label:"Utah",value:"UT"},{label:"Vermont",value:"VT"},{label:"Virgin Islands",value:"VI"},{label:"Virginia",value:"VA"},{label:"Washington",value:"WA"},{label:"West Virginia",value:"WV"},{label:"Wisconsin",value:"WI"},{label:"Wyoming",value:"WY"}]}}]);
//# sourceMappingURL=ce6837ad52e5302b08bd.js.map