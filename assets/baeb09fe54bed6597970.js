"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[13986],{305630:(e,n,t)=>{t.d(n,{Z:()=>Q});var r=t(785893),a=t(667294),l=t(441143),i=t.n(l),s=t(496486),o=t.n(s),u=t(363010),c=t(365523),d=t(331535),f=t(642400),p=t(579220),I=t(549425),_=t(735713),E=t(662322),S=t(956345),m=t(565922),h=t(640753),y=t(451620),T=t(356004),P=t(105405),N=t(893321),b=t(630206),v=t(859023),A=t(513857),O=t(487502),g=t(693518),C=t(726283),R=t(202036),M=t(74030),L=t(461061),x=t(298716),j=t(959797),Z=t(5759),G=t.n(Z);function w(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function U(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function k(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1;r.configurable=!0;"value"in r&&(r.writable=!0);Object.defineProperty(e,r.key,r)}}function D(e){D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){
return e.__proto__||Object.getPrototypeOf(e)};return D(e)}function B(e,n){return!n||"object"!==Y(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function F(e,n){F=Object.setPrototypeOf||function(e,n){e.__proto__=n;return e};return F(e,n)}function H(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done);i=!0){l.push(r.value);if(n&&l.length===n)break}}catch(e){s=!0;a=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw a}}return l}}(e,n)||K(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function W(e){return function(e){if(Array.isArray(e))return w(e)}(e)||function(e){
if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||K(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var Y=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function K(e,n){if(e){if("string"==typeof e)return w(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);return"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?w(e,n):void 0}}function V(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var t,r=D(e);if(n){
var a=D(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return B(this,t)}}var X=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}});n&&F(e,n)}(t,e);var n=V(t);function t(){U(this,t);var e;(e=n.apply(this,arguments)).state={copyMode:A.Z.Modes.DEFAULT};e._copyModeTimeout=new c.V7;e.handleGiftCodeCopy=function(n,t){var r=e.props.sku;null!=r&&(0,R.dM)(new y.Z({code:t,maxUses:1}),r);try{(0,C.JG)(n);e.setState({copyMode:A.Z.Modes.SUCCESS})}catch(n){e.setState({copyMode:A.Z.Modes.ERROR})}e._copyModeTimeout.start(1500,(function(){e.setState({copyMode:A.Z.Modes.DEFAULT})}))};e.handleInventoryClick=function(){S.Z.open(L.oAB.INVENTORY);e.props.onClose()};return e}var a=t.prototype;a.componentWillUnmount=function(){this._copyModeTimeout.stop()};a.render=function(){
var e,n=this,t=this.props,a=t.obscureGiftCode,l=t.giftCode,i=t.application,s=t.onClose,o=t.selectedGiftStyle,u=this.state.copyMode;switch(u){case A.Z.Modes.SUCCESS:e=j.Z.Messages.BILLING_GIFT_COPIED;break;case A.Z.Modes.ERROR:e=j.Z.Messages.FAILED;break;default:e=j.Z.Messages.COPY}return(0,r.jsxs)(O.Z,{direction:O.Z.Direction.VERTICAL,align:O.Z.Align.CENTER,children:[null!=i?(0,r.jsx)(g.Z,{game:i,className:G().icon,size:g.Z.Sizes.LARGE,skuId:this.iconSKUId}):null,(0,r.jsx)(d.X6,{variant:"heading-lg/semibold",className:null!=o?G().headerSeasonalGifting:G().header,children:j.Z.Messages.APPLICATION_STORE_PURCHASE_GIFT_CONFIRMATION_TITLE}),(0,r.jsx)("div",{className:G().blurb,children:this.headerBlurb}),(0,r.jsx)(z,{giftCode:l,onClose:s}),(0,r.jsx)("div",{className:G().divider}),(0,r.jsxs)(O.Z,{direction:O.Z.Direction.VERTICAL,children:[(0,r.jsx)(d.vw,{children:j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_PRIVATE_LINK}),null!=l?(0,r.jsx)(A.Z,{
hideMessage:a?j.Z.Messages.GIFT_INVENTORY_HIDDEN:null,value:(0,R.Nz)(l),mode:u,text:e,onCopy:function(e){return n.handleGiftCodeCopy(e,l)},supportsCopy:C.wS,className:G().copyInput,buttonColor:A.Z.ButtonColors.LINK,buttonLook:A.Z.ButtonLooks.LINK}):null,(0,r.jsx)("div",{className:G().subtext,children:j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRMATION_SUBTEXT_NO_FORMAT})]})]})};!function(e,n,t){n&&k(e.prototype,n);t&&k(e,t)}(t,[{key:"iconSKUId",get:function(){var e=this.props,n=e.subscriptionPlan,t=e.sku;return null!=n?n.skuId:null!=t?t.id:null}},{key:"headerBlurb",get:function(){var e=this.props.subscriptionPlan,n=j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRMATION_BLURB;if(null!=e){n=(e.interval===x.rV.MONTH?j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRM_SUBSCRIPTION_MONTHLY:j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_CONFIRM_SUBSCRIPTION_YEARLY).format({skuName:(0,M.aq)(e.id),intervalCount:e.intervalCount})}return n}}]);return t}(a.Component),z=function(e){
var n=e.giftCode,t=e.onClose;a.useEffect((function(){_.Z.fetchRelationships();(0,E.W)()}),[]);var l=null!=n&&""!==n?(0,R.Nz)(n):null,s=H(a.useState(),2),c=s[0],S=s[1],y=H(a.useState(!1),2),N=y[0],A=y[1],O=H(a.useState(!1),2),g=O[0],C=O[1],M=(0,u.cj)([b.Z],(function(){return{userAffinities:b.Z.getUserAffinitiesUserIds(),isLoading:b.Z.getFetching()}})),L=M.userAffinities,x=M.isLoading,Z=Array.from(L.values()),w=(0,u.e7)([P.Z],(function(){return P.Z.getFriendIDs()})),U=o().difference(w,Z),k=W(Z).concat(W(U)),D=(0,u.e7)([v.default],(function(){return v.default.filter((function(e){return k.includes(e.id)&&!e.bot}))}),[k]);if(null==D||0===D.length)return null;var B=o().sortBy(D,(function(e){return k.indexOf(e.id)}));return(0,r.jsxs)("div",{className:G().giftRecipientSection,children:[(0,r.jsx)(d.vw,{children:j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_RECIPIENT_SECTION_LABEL}),(0,r.jsxs)("div",{className:G().giftRecipient,children:[(0,r.jsx)(d.Vc,{
placeholder:j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_RECIPIENT_SELECT_PLACEHOLDER,wrapperClassName:G().giftRecipientInputWrapper,className:N?G().giftRecipientInputError:void 0,renderOptionPrefix:function(e){return null==(null==e?void 0:e.value)?null:(0,r.jsx)(m.Z,{user:e.value,size:m.u.SIZE_20})},renderLeading:function(){return x?(0,r.jsx)(d.$j,{type:d.RA.PULSING_ELLIPSIS}):null},value:c,onChange:function(e){S(e);A(!1)},options:B.map((function(e){return{value:e,label:"".concat(e.toString(),"#").concat(e.discriminator)}}))}),(0,r.jsx)(d.zx,{disabled:null==c,submitting:g,className:G().sendToRecipientButton,onClick:function(){C(!0);f.Z.openPrivateChannel(c.id).then((function(e){var n=T.Z.getChannel(e);i()(null!=n,"Ensured PrivateChannel is null");i()(null!=l,"giftCodeURL is null");I.Z.sendMessage(n.id,h.ZP.parse(n,l),void 0,{isGiftLinkSentOnBehalfOfUser:!0}).then((function(){t();(0,p.Ou)()})).catch((function(){A(!0);C(!1)}))}))},
children:j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_SEND_NOW_BUTTON})]}),(0,r.jsx)("div",{className:N?G().subtextError:G().subtext,children:N?j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_ERROR_SENDING_LINK:j.Z.Messages.APPLICATION_STORE_GIFT_PURCHASE_GIFT_RECIPIENT_SUBTEXT})]})};const Q=u.ZP.connectStores([N.Z],(function(){return{obscureGiftCode:N.Z.enabled}}))(X)},28825:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(667294),a=t(173436);function l(e){var n=(0,r.useRef)(e);(0,r.useEffect)((function(){n.current=e}),[e]);(0,r.useEffect)((function(){if(__OVERLAY__){var e=function(e){e.locked&&n.current()};a.Z.subscribe("OVERLAY_SET_INPUT_LOCKED",e);return function(){a.Z.unsubscribe("OVERLAY_SET_INPUT_LOCKED",e)}}}),[])}},851225:(e,n,t)=>{t.d(n,{Em:()=>i,sE:()=>s,ZP:()=>o});var r=t(553494),a=t(74030),l=(0,r.B)({kind:"user",id:"2022-06_no_payment_info_trial",label:"No Payment Info Trial",defaultConfig:{bypassCheckout:!1},treatments:[{id:1,label:"Bypass collecting payment info",config:{
bypassCheckout:!0}}]}),i=function(e,n,t){var r=null==t||(0,a.uZ)(t);return null!=e&&null==n&&r},s=function(e,n,t){var r=l.useExperiment({}).bypassCheckout,a=i(e,n,t);return r&&a};const o=l},546005:(e,n,t)=>{t.d(n,{Z:()=>r});const r=(0,t(553494).B)({kind:"user",id:"2022-04_payment_modal_refactor",label:"Payment Modal Refactor",defaultConfig:{newModal:!1},treatments:[{id:1,label:"Use refactored modal.",config:{newModal:!0}}]})},695784:(e,n,t)=>{t.d(n,{v:()=>I});var r=t(441143),a=t.n(r),l=t(530853),i=t(967543),s=t(932847),o=t(658350),u=t(390599),c=t(461061);function d(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))));r.forEach((function(n){d(e,n,t[n])}))}
return e}function p(e,n){n=null!=n?n:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})));t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}));return e}function I(e){var n=e.analyticsData,t=e.initialPlanId,r=e.breadcrumbSteps,d=e.handleStepChange,I=(0,o.usePaymentContext)(),_=I.contextMetadata,E=I.step,S=I.paymentSources,m=I.paymentSourceId,h=I.setPaymentSourceId,y=I.purchaseError,T=I.setPurchaseError,P=I.purchaseErrorBlockRef,N=I.paymentAuthenticationState,b=p(f({},(0,i.fL)()),{paymentSources:S,paymentSourceId:m,setPaymentSourceId:h,purchaseError:y,setPurchaseError:T,purchaseErrorBlockRef:P,paymentAuthenticationState:N});a()(E,"Step should be set here");var v=(0,
l.Z)((function(){return Date.now()}),[E]);return(0,i.vP)({paymentModalArgs:b,initialStep:u.h8.PAYMENT_TYPE,prependSteps:[u.h8.PROMOTION_INFO],appendSteps:[u.h8.REVIEW,u.h8.CONFIRM],breadcrumpSteps:r,currentBreadcrumpStep:E,usePaymentModalStep:!0,onReturn:function(){var e=Object.values(S).length<1&&null==t?u.h8.PLAN_SELECT:u.h8.REVIEW;d(e,u.h8.PAYMENT_TYPE)},onComplete:function(e){d(u.h8.REVIEW,e)},onStepChange:function(e){var t=e.currentStep,r=e.toStep,a=Date.now();s.default.track(c.rMx.PAYMENT_FLOW_STEP,p(f({},n),{from_step:t,to_step:r,step_duration_ms:a-v,flow_duration_ms:a-_.startTime}))}})}},851604:(e,n,t)=>{t.r(n);t.d(n,{OldPremiumPaymentModal:()=>Jn,PremiumAwaitingAuthenticationStep:()=>qn,PremiumAwaitingPurchaseTokenAuthStep:()=>$n,PremiumPaymentModal:()=>ut,PremiumPaymentReviewStep:()=>st,PremiumPaymentSpinner:()=>nt,STEPS:()=>et,default:()=>ct})
;var r=t(785893),a=t(667294),l=t(294184),i=t.n(l),s=t(441143),o=t.n(s),u=t(126136),c=t(530853),d=t(468811),f=t.n(d),p=t(363010),I=t(331535),_=t(173436),E=t(737325),S=t(358623),m=t(512172),h=t(174034),y=t(879605),T=t(335065),P=t(658350),N=t(587583),b=t(487502),v=t(67416),A=t(959797),O=t(547656),g=t.n(O);function C(e,n,t,r,a,l,i){try{var s=e[l](i),o=s.value}catch(e){t(e);return}s.done?n(o):Promise.resolve(o).then(r,a)}var R=function(e,n){var t,r,a,l,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function s(l){return function(s){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;(r=0,a)&&(l=[2&l[0],a.value]);switch(l[0]){case 0:case 1:a=l;break;case 4:i.label++;return{value:l[1],done:!1}
;case 5:i.label++;r=l[1];l=[0];continue;case 7:l=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1];a=l;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(l);break}a[2]&&i.ops.pop();i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e];r=0}finally{t=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},M=function(e){var n=e.className,t=e.isEmailResent,a=e.resendEmail;return(0,r.jsx)("div",{className:n,children:(0,r.jsxs)("div",{className:g().awaitingWrapper,children:[(0,r.jsx)(I.X6,{variant:"heading-xl/bold",children:A.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_HEADER}),(0,r.jsxs)("p",{children:[(0,r.jsx)(I.xv,{variant:"text-md/normal",children:A.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL}),(0,r.jsx)("br",{}),(0,r.jsx)(I.xv,{variant:"text-md/normal",
children:A.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_INSTRUCTIONS}),(0,r.jsx)("br",{}),(0,r.jsxs)(I.xv,{variant:"text-md/normal",children:[A.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_PROMPT," ",t?A.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_SENT:(0,r.jsx)(I.ee,{onClick:a,children:A.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_RESEND_ACTION})]})]})]})})},L=function(){return(0,r.jsx)("div",{children:(0,r.jsx)(v.mz,{justify:b.Z.Justify.BETWEEN,align:b.Z.Align.CENTER,children:(0,r.jsx)(I.zx,{"data-testid":"continue",color:I.zx.Colors.BRAND,disabled:!0,children:A.Z.Messages.PAYMENT_WAITING_FOR_PURCHASE_TOKEN_AUTHORIZATION_MODAL_NEXT_BUTTON})})})};function x(e){var n,t,a=e.steps,l=e.currentStep,i=e.paymentError,s=e.className,o=e.isEmailResent,u=e.setIsEmailResent,c=(t=(n=function(){return R(this,(function(e){switch(e.label){case 0:u(!0);return[4,(0,m.xA)()];case 1:e.sent();return[2]}}))
},function(){var e=this,t=arguments;return new Promise((function(r,a){var l=n.apply(e,t);function i(e){C(l,r,a,i,s,"next",e)}function s(e){C(l,r,a,i,s,"throw",e)}i(void 0)}))}),function(){return t.apply(this,arguments)});return(0,r.jsx)(N.Z,{steps:a,currentStep:l,paymentError:i,body:(0,r.jsx)(M,{className:s,isEmailResent:o,resendEmail:c}),footer:(0,r.jsx)(L,{})})}var j=t(812314),Z=t(952013),G=t(859169),w=t(64833),U=t(767121),k=t(84840),D=t(28825),B=t(124966),F=t(43833),H=t(553494),W=t(298716);const Y=(0,H.B)({kind:"user",id:"2022-02_multi_month_plans",label:"Multi Month Plans",defaultConfig:{newPlans:[]},treatments:[{id:1,label:"3 and 6 Month Plans",config:{newPlans:[W.Xh.PREMIUM_6_MONTH_TIER_2,W.Xh.PREMIUM_3_MONTH_TIER_2]}},{id:2,label:"3 Month Plan Only",config:{newPlans:[W.Xh.PREMIUM_3_MONTH_TIER_2]}}]});var K=new Set([F.S.US,F.S.CA]);function V(e){return null==e||K.has(e.country)}var X=t(916061),z=t(742720),Q=t(852097),J=t(859023),$=t(370678),q=t(503035),ee=t(337267),ne=t.n(ee)
;const te=function(e){var n=e.trialId,t=e.isGift,a=e.plan,l=(0,p.e7)([J.default],(function(){return J.default.getCurrentUser()})),i=(0,q.Mh)(l,n,t,a),s=i.shouldShowUpsells;return!i.isLoading&&s?(0,r.jsxs)("div",{className:ne().bogoPromo,children:[(0,r.jsx)($.Z,{className:ne().giftIcon}),(0,r.jsx)(I.X6,{className:ne().textHeader,color:"always-white",variant:"heading-deprecated-12/extrabold",children:A.Z.Messages.ENJOY_A_FREE_MONTH})]}):null};var re=t(794057),ae=t(859691),le=t(29005),ie=t(390599),se=t(792018);function oe(e,n,t){a.useEffect((function(){null!=e&&e!==ie.h8.AWAITING_PURCHASE_TOKEN_AUTH&&n===se.I.PENDING?t(ie.h8.AWAITING_PURCHASE_TOKEN_AUTH):e===ie.h8.AWAITING_PURCHASE_TOKEN_AUTH&&n===se.I.SUCCESS&&t(ie.h8.REVIEW)}),[e,n,t])}
var ue=t(967543),ce=t(559019),de=t(916957),fe=t(720897),pe=t(757987),Ie=t(436035),_e=t(95467),Ee=t(74030),Se=t(56435),me=t(898862),he=t(554962),ye=t(511515),Te=t(939042),Pe=t(350138),Ne=t(125313),be=t(279480),ve=t(832010),Ae=t(817513),Oe=t(739093),ge=t(461061),Ce=t(736101),Re=t.n(Ce);function Me(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function Le(e){var n=e.premiumSubscription,t=e.planId,a=e.selectPlan,l=e.selected,s=e.isGift,u=e.priceOptions,c=(0,p.e7)([Ae.default],(function(){return Ae.default.locale})),d=(0,p.e7)([de.Z],(function(){return de.Z.get(t)}));o()(null!=d,"Missing subscriptionPlan");var f=null!=n&&n.planId===t,_=f||t===W.Xh.PREMIUM_MONTH_TIER_2&&null!=n&&[W.Xh.PREMIUM_YEAR_TIER_0,W.Xh.PREMIUM_YEAR_TIER_1].includes(n.planId),E=W.nH[t],S=Oe.U.useExperiment({}).enableMonthlyTier0Gifting,m=(0,Ee.aS)(t,!1,s,u),h=(0,Ee.Ap)(u.paymentSourceId),y=null!=E&&(!s||t===W.Xh.PREMIUM_YEAR_TIER_0&&S);return(0,
r.jsxs)(I.P3,{role:"radio","aria-checked":l,tabIndex:l?0:-1,focusProps:{offset:{left:-4,right:-4,top:0,bottom:0}},onClick:_?void 0:function(){return a(t)},className:i()(Re().planOption,Me({},Re().planOptionDisabled,_)),children:[(0,r.jsxs)("div",{className:Re().planOptionClickable,children:[(0,r.jsx)(I.XZ,{readOnly:!0,displayOnly:!0,value:l,shape:I.XZ.Shapes.ROUND,color:(0,ve.Lq)(ge.Ilk.BRAND_500),type:I.XZ.Types.INVERTED,className:Re().planOptionCheckbox}),(0,r.jsx)("div",{className:i()(Re().planOptionInterval,Me({},Re().optionSelected,l)),children:(0,Ee.L7)(d.interval,s,h,d.intervalCount)}),f?(0,r.jsxs)("span",{className:Re().planOptionCurrentPlan,children:["(",A.Z.Messages.BILLING_SWITCH_PLAN_CURRENT_PLAN,")"]}):null,d.interval===W.rV.YEAR&&null!=n?(0,r.jsxs)("span",{className:Re().planOptionMonthsFree,children:["(",A.Z.Messages.BILLING_SWITCH_PLAN_YEARLY_FREE_MONTHS,")"]}):y&&!f?(0,r.jsx)(I.xv,{tag:"span",variant:"eyebrow",color:"always-white",className:Re().planOptionDiscount,
children:A.Z.Messages.BILLING_PLAN_SELECTION_DISCOUNT.format({discount:(0,Se.T3)(c,E/100)})}):null]}),(0,r.jsx)("div",{className:i()(Me({},Re().optionSelected,l)),children:(0,Se.T4)(m.amount,m.currency)})]})}var xe=t(182102),je=t(375650),Ze=t(710431),Ge=t.n(Ze);function we(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Ue(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function ke(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))));r.forEach((function(n){Ue(e,n,t[n])}))}return e}function De(e,n){n=null!=n?n:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e)
;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})));t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}));return e}function Be(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done);i=!0){l.push(r.value);if(n&&l.length===n)break}}catch(e){s=!0;a=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw a}}return l}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return we(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return we(e,n)
}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Fe(e,n){var t=A.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_MONTH,r=A.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_1_YEAR,a=function(){switch(e.interval){case W.rV.YEAR:return t;case W.rV.MONTH:default:return r}}(),l=e.skuId;switch(n){case W.Si.TIER_0:switch(l){case W.Si.TIER_1:return A.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_TIER_1_TO_TIER_0;case W.Si.TIER_2:return A.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_TIER_0;default:return a}case W.Si.TIER_1:switch(l){case W.Si.TIER_0:return A.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_1;case W.Si.TIER_2:return A.Z.Messages.BILLING_SWITCH_PLAN_DOWNGRADE_BODY_TIER_1;default:return a}case W.Si.TIER_2:switch(l){case W.Si.TIER_0:case W.Si.TIER_1:return A.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_2;case W.Si.TIER_2:
return e.interval===W.rV.MONTH?A.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE_BODY_TIER_2_YEAR.format({numFreeGuildSubscriptions:W.cb}):a;default:return a}default:return a}}var He=a.forwardRef((function(e,n){var t,l=e.isSelected,i=e.giftStyle,s=e.setSelectedGiftStyle,o=e.onFocus,u=e.onBlur,c=Be(a.useState(!1),2),d=c[0],f=c[1];switch(i){case me.Cj.SNOWGLOBE:t=A.Z.Messages.SEASONAL_GIFTING_OPTION_SNOWGLOBE;break;case me.Cj.BOX:t=A.Z.Messages.SEASONAL_GIFTING_OPTION_BOX;break;case me.Cj.CUP:t=A.Z.Messages.SEASONAL_GIFTING_OPTION_CUP;break;default:t=A.Z.Messages.SEASONAL_GIFTING_CUSTOMIZE_YOUR_GIFT_BOX}var p=(0,I.xU)({isSelected:l,label:t});return(0,r.jsx)(I.P3,De(ke({innerRef:n,className:Ge().clickable,onClick:function(){return s(i)}},p),{onFocus:o,onBlur:u,onMouseEnter:function(){return f(!0)},onMouseLeave:function(){return f(!1)},children:(0,r.jsx)(xe.Z,{giftStyle:i,className:l?Ge().seasonalGiftBoxHighlighted:Ge().seasonalGiftBox,shouldAnimate:d||l})}))}));function We(e){
var n=e.premiumSubscription,t=e.skuId,l=e.selectedPlanId,i=e.setSelectedPlanId,s=e.isGift,u=void 0!==s&&s,c=e.isSeasonalGift,d=void 0!==c&&c,f=e.selectedGiftStyle,_=e.setSelectedGiftStyle,E=e.priceOptions,S=e.planOptions,m=e.eligibleForMultiMonthPlans,h=(0,P.usePaymentContext)(),y=h.activeSubscription,T=h.setSelectedPlanId,N=h.selectedSkuId,b=h.selectedPlan,v=h.priceOptions;t=null!=t?t:N;n=null!=n?n:y;o()(void 0!==n,"should not be undefined");var O=Be((0,p.Wu)([de.Z],(function(){return[null!=n?de.Z.get(n.planId):null,null!=l?de.Z.get(l):null]})),2),g=O[0],C=O[1],R=(0,ye.N)(),M=null==R?void 0:R.subscription_trial,L=null!=C?C:b,x=a.useCallback((function(e){null!=i?i(e):T(e)}),[i,T]),j=null!=E?E:v;o()(null!=j,"Price option has to be set");var Z=null!=R&&W.nG[R.trial_id].skus.includes(t);a.useEffect((function(){m&&Y.trackExposure({})}),[m]);var G=null!=(null==L?void 0:L.id)&&S.includes(L.id);a.useEffect((function(){if(!G)if(null==g||u)x(S[0]);else if(null!=g){var e=S.find((function(e){
return e!==g.id}));null!=e&&x(e)}}),[G,u,S,g,x]);var w=(u||!Z)&&G,U=(0,I.ar)(),k=null!=(null==L?void 0:L.id)?(0,Ee.aS)(L.id,!1,u,j):void 0,D="HR"===(0,he.Z)().ipCountryCode&&null!=k&&k.currency===je.pK.EUR,B=(0,I.ar)({orientation:"horizontal"}),F=(0,Ee.Ap)(j.paymentSourceId),H=a.useRef(null),K=Be(a.useState(!1),2),V=K[0],X=K[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(te,{trialId:null==R?void 0:R.trial_id,isGift:u,plan:C}),(0,r.jsxs)("div",{className:Ge().stepBody,children:[d?(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:Ge().seasonalGiftBoxHeaderContainer,children:[(0,r.jsx)(I.X6,{variant:"heading-deprecated-12/semibold",className:Ge().seasonalGiftBoxHeaderText,children:A.Z.Messages.SEASONAL_GIFTING_CUSTOMIZE_YOUR_GIFT_BOX}),(0,r.jsx)(pe.ZP,{text:A.Z.Messages.SEASONAL_GIFTING_INFO_TOOLTIP,position:pe.ZP.Positions.TOP,children:function(e){return(0,r.jsx)(I.P3,De(ke({},e),{className:Ge().infoIconContainer,"aria-label":A.Z.Messages.SEASONAL_GIFTING_INFO_TOOLTIP,
children:(0,r.jsx)(Ie.Z,{className:Ge().infoIcon})}))}})]}),(0,r.jsxs)("div",De(ke({tabIndex:null!=f||V?void 0:0,onFocus:function(e){var n;e.target===e.currentTarget&&(null===(n=H.current)||void 0===n||n.focus())},className:Ge().seasonalGiftBoxOptionContainer,"aria-label":A.Z.Messages.SEASONAL_GIFTING_CUSTOMIZE_YOUR_GIFT_BOX},B),{children:[(0,r.jsx)(He,{isSelected:f===me.Cj.BOX,giftStyle:me.Cj.BOX,setSelectedGiftStyle:_,ref:H,onFocus:function(){return X(!0)},onBlur:function(){return X(!1)}}),(0,r.jsx)(He,{isSelected:f===me.Cj.SNOWGLOBE,giftStyle:me.Cj.SNOWGLOBE,setSelectedGiftStyle:_,onFocus:function(){return X(!0)},onBlur:function(){return X(!1)}}),(0,r.jsx)(He,{isSelected:f===me.Cj.CUP,giftStyle:me.Cj.CUP,setSelectedGiftStyle:_,onFocus:function(){return X(!0)},onBlur:function(){return X(!1)}})]})),(0,r.jsx)("div",{className:Ge().selectPlanDivider})]}):null,null==g||u?null:(0,r.jsx)("div",{className:Ge().bodyText,children:Fe(g,t)}),(0,r.jsx)("div",{
className:Ge().selectPlanChooseTitle,children:A.Z.Messages.BILLING_SWITCH_PLAN_CHOOSE_ONE}),Z&&!u?(0,r.jsx)("div",{className:Ge().selectPlanChooseSubtitle,children:A.Z.Messages.BILLING_SWITCH_PLAN_CHOOSE_ONE_TRIAL_SUBTITLE_DURATION.format({duration:(0,Ee.if)({intervalType:null==M?void 0:M.interval,intervalCount:null==M?void 0:M.interval_count})})}):null,(0,r.jsx)("div",De(ke({},U),{children:S.map((function(e){return(0,r.jsx)(Le,{planId:e,isGift:u,premiumSubscription:u?null:null!=n?n:null,selectPlan:x,selected:(null==L?void 0:L.id)===e,priceOptions:j},e)}))})),(0,r.jsx)("div",{children:w&&null!=L&&null!=k?(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:Ge().selectPlanDivider}),(0,r.jsx)(Te.Ji,{label:A.Z.Messages.BILLING_PAYMENT_BREAKDOWN_TOTAL,value:(0,r.jsx)(Pe.Z,{price:k.amount,currency:k.currency,intervalType:u?null:L.interval,intervalCount:L.intervalCount,isPrepaidPaymentSource:F}),className:Ge().selectPlanTotalRow})]}):null}),D&&(0,r.jsx)(ce.Z,{
message:A.Z.Messages.LOCALIZED_PRICING_HRK_EURO_WARNING.format({kunaPriceWithCurrency:(0,Se.T4)(7.5345*k.amount,je.pK.HRK)})}),!u&&(0,r.jsx)(ce.Z,{message:A.Z.Messages.BILLING_FINAL_PRICE_MAY_CHANGE.format({documentationLink:_e.Z.getArticleURL(ge.BhN.LOCALIZED_PRICING)})})]})]})}function Ye(e){var n=e.onStepChange,t=e.selectedPlanId,a=e.isGift,l=e.paymentSources,i=e.onBackClick,s=e.showBackButton,o=e.planOptions,u=(0,P.usePaymentContext)(),c=u.paymentSources,d=u.selectedPlan;l=null!=l?l:c;var f=null!=(t=null!=t?t:null==d?void 0:d.id)&&o.includes(t);return(0,r.jsxs)(r.Fragment,{children:[f&&null!=t?(0,r.jsx)(Ke,{paymentSources:l,onStepChange:n,selectedPlanId:t,isGift:a}):(0,r.jsx)(I.zx,{disabled:!0,children:A.Z.Messages.SELECT}),s?(0,r.jsx)(Ne.Z,{onClick:i}):null]})}function Ke(e){var n=e.onStepChange,t=e.selectedPlanId,a=e.isGift,l=e.paymentSources,i=(0,p.e7)([fe.Z],(function(){return fe.Z.getPremiumTypeSubscription()})),s=(0,be.H)(t,a).hasEntitlements;return(0,r.jsx)(I.zx,{
onClick:function(){null!=i&&null!=i.paymentSourceId||Object.keys(l).length>0||s?n(ie.h8.REVIEW):n(ie.h8.ADD_PAYMENT_STEPS)},children:A.Z.Messages.SELECT})}var Ve=t(725002),Xe=t(844083),ze=t(904729),Qe=t.n(ze);function Je(e){var n=e.onClick,t=e.isGift;return(0,r.jsx)(I.P3,{onClick:n,style:{cursor:"pointer"},children:(0,r.jsx)(Xe.wp,{className:Qe().tier2MarketingCard,ctaButton:null,showWumpus:!0,showYearlyPrice:!0,isGift:t})})}function $e(e){var n=e.onClick,t=e.isGift;return(0,r.jsx)(I.P3,{onClick:n,style:{cursor:"pointer"},children:(0,r.jsx)(Xe.Gq,{className:Qe().tier0MarketingCard,ctaButton:null,showWumpus:!0,showYearlyPrice:!0,isGift:t})})}const qe=function(e){var n=e.onSelectSku,t=e.isGift;return(0,r.jsxs)(Ve.zJ,{className:Qe().skuButtons,paddingFix:!1,children:[(0,r.jsx)(Je,{onClick:function(){return n(W.Si.TIER_2)},isGift:t}),(0,r.jsx)($e,{onClick:function(){return n(W.Si.TIER_0)},isGift:t})]})}
;var en=t(965952),nn=t(677839),tn=t(230903),rn=t(711462),an=t(238307),ln=t(556137),sn=t(909187),on=t(655868),un=t(154765),cn=t(893321),dn=t(378564),fn=t(862325),pn=t(212658),In=t(470352),_n=t(112508),En=t(231492),Sn=t.n(En),mn=t(968071),hn=t.n(mn);function yn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Tn(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done);i=!0){l.push(r.value);if(n&&l.length===n)break}}catch(e){s=!0;a=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw a}}return l}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return yn(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t)
;if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return yn(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pn(e){var n,t=e.premiumSubscription,a=e.paymentSources,l=e.priceOptions,i=e.onPaymentSourceChange,s=e.onPaymentSourceAdd,u=e.planId,c=e.setHasAcceptedTerms,d=e.legalTermsNodeRef,f=e.hasLegalTermsFlash,_=e.onInvoiceError,E=e.planGroup,S=e.currencies,m=e.onCurrencyChange,h=e.hasOpenInvoice,y=e.purchaseState,T=l.paymentSourceId,P=(0,p.e7)([de.Z],(function(){return de.Z.get(u)}));o()(null!=P,"Missing newPlan");var N,b=(0,p.e7)([cn.Z],(function(){return cn.Z.hidePersonalInformation}));N=h?A.Z.Messages.BILLING_PURCHASE_DETAILS_HEADER:(0,Ee.PV)(u)?(0,Ee.W_)(t,P):A.Z.Messages.BILLING_SELECT_PLAN_GUILD_SUBSCRIPTION.format({planName:P.name})
;var v=F.M.EEA_COUNTRIES.has(dn.Z.ipCountryCodeWithFallback),O=y===un.A.PURCHASING||y===un.A.COMPLETED;return(0,r.jsxs)("div",{className:hn().stepBody,children:[(0,r.jsx)(I.vw,{tag:I.RB.H5,children:N}),null!=t?h?(0,r.jsx)(Nn,{premiumSubscription:t,onInvoiceError:_,priceOptions:l,preventFetch:!1}):(0,fn.R4)(t,u,E)?(0,r.jsx)(bn,{premiumSubscription:t,newPlan:P,onInvoiceError:_,planGroup:E,priceOptions:l,preventFetch:O}):(0,r.jsx)(vn,{premiumSubscription:t,newPlan:P,planGroup:E,priceOptions:l,preventFetch:O}):null,(0,r.jsxs)("div",{className:hn().paymentSourceWrapper,children:[(0,r.jsx)(I.vw,{tag:I.RB.H5,children:A.Z.Messages.PAYMENT_SOURCE_PAYMENT_REQUEST_INFO_TITLE}),(0,r.jsx)(sn.Z,{paymentSources:Object.values(a),selectedPaymentSourceId:T,onChange:i,onPaymentSourceAdd:s,hidePersonalInformation:b,disabled:O})]}),(0,r.jsxs)(an.b,{currencies:S,className:hn().currencyWrapper,children:[(0,r.jsx)(I.vw,{tag:I.RB.H5,children:A.Z.Messages.PAYMENT_CURRENCY}),(0,r.jsx)(an.Z,{
selectedCurrency:l.currency,currencies:S,onChange:m,disabled:O})]}),(0,r.jsx)(In.Z,{isActive:f,ref:d,children:(0,r.jsx)(on.Z,{onChange:c,finePrint:(0,r.jsx)(ln.Z,{subscriptionPlan:P,paymentSourceType:null===(n=a[null!=T?T:""])||void 0===n?void 0:n.type}),forceShow:!0,showPricingLink:P.currency!==ge.pKx.USD,showWithdrawalWaiver:v,disabled:O})})]})}function Nn(e){var n=e.premiumSubscription,t=e.onInvoiceError,l=e.priceOptions,i=e.preventFetch,s=Tn((0,pn.Ox)({subscriptionId:n.id,preventFetch:i}),2),o=s[0],u=s[1];a.useEffect((function(){t(u)}),[t,u]);var c=(0,Ee.Ap)(l.paymentSourceId);return null!=o?(0,r.jsxs)(Te.PO,{className:Sn().invoice,children:[(0,r.jsx)(_n.By,{invoice:o,isPrepaidPaymentSource:c}),(0,r.jsx)(_n.nd,{premiumSubscription:n,renewalInvoice:o,isUpdate:!0,isPrepaidPaymentSource:c})]}):(0,r.jsx)(I.$j,{})}function bn(e){var n=e.premiumSubscription,t=e.newPlan,l=e.onInvoiceError,i=e.planGroup,s=e.priceOptions,o=e.preventFetch,u=(0,Ee.al)(n,t.id,1,new Set(i)),c=Tn((0,pn.ED)({
subscriptionId:n.id,items:u,renewal:!1,applyEntitlements:!0,paymentSourceId:s.paymentSourceId,currency:s.currency,preventFetch:o}),2),d=c[0],f=c[1],p=Tn((0,pn.ED)({subscriptionId:n.id,items:u,renewal:!0,paymentSourceId:s.paymentSourceId,currency:s.currency,preventFetch:o}),2),_=p[0],E=p[1],S=null!=f?f:E;a.useEffect((function(){l(S)}),[l,S]);if(null!=S)return(0,r.jsx)(I.kz,{children:S.message});if(null==d||null==_)return(0,r.jsx)(I.$j,{className:hn().spinner});var m=(0,Ee.Ap)(s.paymentSourceId);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(_n.hG,{proratedInvoice:d,renewalInvoice:_}),(0,r.jsxs)(Te.PO,{className:hn().invoice,children:[(0,r.jsx)(Te.q9,{children:A.Z.Messages.BILLING_SWITCH_PLAN_PURCHASE_DETAILS}),(0,r.jsx)(_n.Lu,{invoice:d,newPlan:t,isPrepaidPaymentSource:m}),(0,r.jsx)(_n.nd,{premiumSubscription:n,proratedInvoice:d,renewalInvoice:_,isUpdate:!0,isPrepaidPaymentSource:m})]})]})}function vn(e){
var n,t=e.premiumSubscription,a=e.newPlan,l=e.planGroup,i=e.priceOptions,s=e.preventFetch,o=Tn((0,pn.ED)({subscriptionId:t.id,items:(0,Ee.al)(t,a.id,1,new Set(l)),renewal:!0,applyEntitlements:!1,paymentSourceId:i.paymentSourceId,currency:i.currency,preventFetch:s}),2),u=o[0],c=o[1];if(null!=c)return(0,r.jsx)(I.kz,{children:c.message});if(null==u)return(0,r.jsx)("div",{children:(0,r.jsx)(I.$j,{})});n=t.type===ge.NYc.PREMIUM?(0,Ee.Gf)(a.id):a.name;var d=(0,Ee.Ap)(i.paymentSourceId);return(0,r.jsxs)("div",{className:hn().bodyText,children:[(0,r.jsx)("div",{className:Sn().renewalInvoiceDate,children:A.Z.Messages.BILLING_SWITCH_PLAN_CHANGE_DATE.format({renewalDate:u.subscriptionPeriodStart})}),(0,r.jsxs)(Te.PO,{className:hn().invoice,children:[(0,r.jsx)(Te.q9,{children:A.Z.Messages.PREMIUM_SUBSCRIPTION_UPDATES}),(0,r.jsx)(Te.R$,{label:n,value:(0,Ee.PK)(a,i,!0)}),(0,r.jsx)(Te.KU,{}),(0,r.jsx)(_n.nd,{premiumSubscription:t,renewalInvoice:u,isUpdate:!0,isPrepaidPaymentSource:d})]})]})}
var An=t(922877),On=t(932847),gn=t(557473),Cn=t(960136),Rn=t(709947),Mn=t(851225),Ln=t(546005),xn=t(695784),jn=t(343657),Zn=t(727202),Gn=t.n(Zn);function wn(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function Un(e,n,t,r,a,l,i){try{var s=e[l](i),o=s.value}catch(e){t(e);return}s.done?n(o):Promise.resolve(o).then(r,a)}function kn(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function Dn(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))));r.forEach((function(n){kn(e,n,t[n])}))}return e}function Bn(e,n){n=null!=n?n:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e)
;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})));t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}));return e}function Fn(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++){t=l[r];n.indexOf(t)>=0||(a[t]=e[t])}return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++){t=l[r];n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}}return a}function Hn(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done);i=!0){l.push(r.value);if(n&&l.length===n)break}}catch(e){s=!0;a=e}finally{try{
i||null==t.return||t.return()}finally{if(s)throw a}}return l}}(e,n)||Yn(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Wn(e){return function(e){if(Array.isArray(e))return wn(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Yn(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Yn(e,n){if(e){if("string"==typeof e)return wn(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);return"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?wn(e,n):void 0}}var Kn=function(e,n){var t,r,a,l,i={label:0,sent:function(){if(1&a[0])throw a[1]
;return a[1]},trys:[],ops:[]};return l={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function s(l){return function(s){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;(r=0,a)&&(l=[2&l[0],a.value]);switch(l[0]){case 0:case 1:a=l;break;case 4:i.label++;return{value:l[1],done:!1};case 5:i.label++;r=l[1];l=[0];continue;case 7:l=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1];a=l;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(l);break}a[2]&&i.ops.pop();i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e];r=0}finally{t=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}
},Vn=[ie.h8.PLAN_SELECT,ie.h8.ADD_PAYMENT_STEPS,ie.h8.REVIEW,ie.h8.CONFIRM];function Xn(e,n){return e in n}function zn(e){var n=e.selectSku,t=e.onClose,a=e.isGift,l=B.Z.useExperiment({}).enabled,i=X.L.useExperiment({}).enableTier0,s=(0,Q.Z)(),o=l&&"PL"===s;if(!i){n(W.Si.TIER_2);return null}return(0,r.jsxs)("div",{className:hn().premiumSkuSelect,children:[(0,r.jsxs)(v.xB,{separator:!1,children:[(0,r.jsx)(I.vw,{tag:I.RB.H4,children:A.Z.Messages.BILLING_STEP_SELECT_PLAN}),(0,r.jsx)(v.ol,{onClick:t})]}),o&&(0,r.jsx)(re.Z,{fromBoostCancelModal:!1,className:hn().plnNotice}),(0,r.jsx)(qe,{onSelectSku:n,isGift:a})]})}function Qn(e,n,t,r,a){t(n);var l=ie.h8.PLAN_SELECT,i=(0,Ee.k5)(e);i!==W.Si.TIER_1&&i!==W.Si.TIER_2||n!==W.Si.TIER_0||a||(l=ie.h8.WHAT_YOU_LOSE);r(l)}function Jn(e){
var n,t=e.loadId,l=e.isGift,s=void 0!==l&&l,d=e.giftMessage,m=e.subscriptionTier,y=e.initialPlanId,O=e.followupSKUInfo,g=e.transitionState,C=e.onClose,R=e.onComplete,M=e.onSubscriptionConfirmation,L=e.analyticsObject,Z=e.analyticsLocation,G=e.analyticsSourceLocation,B=e.analyticsSubscriptionType,F=void 0===B?ge.NYc.PREMIUM:B,H=e.trialId,K=e.trialFooterMessageOverride,Q=e.postSuccessGuild,$=e.renderHeader,q=e.renderPurchaseConfirmation,ee=e.planGroup,ne=void 0===ee?W.Y1:ee,te=e.reviewWarningMessage,re=e.openInvoiceId,le=e.applicationId,se=e.guildId,ce=(0,P.usePaymentContext)(),pe=ce.activeSubscription,Ie=ce.blockedPayments,_e=(0,p.e7)([J.default],(function(){return J.default.getCurrentUser()})),Se=(0,w.Z)().analyticsLocations,me=(0,p.e7)([fe.Z],(function(){return fe.Z.hasFetchedSubscriptions()})),he=(0,p.e7)([de.Z],(function(){return de.Z.isFetchingForPremiumSKUs()})),ye=Vn,Te=Hn(a.useState((function(){return null!=y?ie.h8.REVIEW:null!=m?ie.h8.PLAN_SELECT:ie.h8.SKU_SELECT
})),2),Pe=Te[0],Ne=Te[1],ve=Hn(a.useState((function(){var e,n=null!=y?null===(e=de.Z.get(y))||void 0===e?void 0:e.skuId:null;return null!=n?n:m})),2),Ae=ve[0],Oe=ve[1],Ce=Hn(a.useState(y),2),Re=Ce[0],Me=Ce[1],Le=(0,p.e7)([de.Z],(function(){return null!=Re?de.Z.get(Re):null})),Ze=(0,p.e7)([An.Z],(function(){return An.Z.applicationIdsFetched.has(W.RQ)})),Ge=Hn(a.useState(!1),2),we=Ge[0],Ue=Ge[1],ke=a.useMemo((function(){var e,n=null==Le||W.YQ.includes(null==Le?void 0:Le.skuId);if(n)e=Wn(W.YQ);else{e=[Le.skuId];null!=pe&&(0,fn.yb)(pe).forEach((function(n){e.includes(n)||e.push(n)}))}return{skuIDs:e,isPremiumSKU:n}}),[pe,Le]),De=(0,U.V)(ke.skuIDs),Be=Hn(a.useState(un.A.WAITING),2),Fe=Be[0],He=Be[1],Ke=Hn(a.useState(!1),2),Ve=Ke[0],Xe=Ke[1],ze=Hn(a.useState(null),2),Qe=ze[0],Je=ze[1],$e=a.useRef(null),qe=Hn((0,j.Z)(!1,500),2),an=qe[0],ln=qe[1];(0,be.w)(pe,(function(){return C(!1)}),s);var sn=a.useRef(null!=pe?pe.planId:null);a.useEffect((function(){
null==sn.current&&null!=pe&&(sn.current=pe.planId)}),[pe]);var on=Hn((0,u.Z)((function(){return[f().v4(),Date.now()]})),2),cn=on[0],dn=on[1],pn=null==H||ke.isPremiumSKU&&!W.nG[H].skus.includes(Ae)?null:H,In={load_id:null!=t?t:cn,payment_type:"subscription",location:null!=Z?Z:L,source:G,subscription_type:F,subscription_plan_id:null==Le?void 0:Le.id,price:null==Le?void 0:Le.price,regular_price:null==Le?void 0:Le.price,currency:null==Le?void 0:Le.currency,is_gift:s,eligible_for_trial:null!=H,application_id:le,location_stack:Se,sku_id:Ae,guild_id:se,payment_modal_version:"v0"};a.useEffect((function(){me||(0,E.jg)()}),[me]);a.useEffect((function(){Ze||(0,S.yD)(W.RQ);ke.isPremiumSKU&&_.Z.wait((function(){return(0,h.Y2)()}));On.default.track(ge.rMx.PAYMENT_FLOW_STARTED,In)}),[]);var _n=(0,
ue.fL)(s||null==pe?void 0:pe.paymentSourceId),En=_n.paymentSourceId,Sn=_n.paymentSources,mn=_n.setPurchaseError,yn=_n.paymentAuthenticationState,Tn=_n.setPaymentSourceId,Nn=_n.paymentError,bn=_n.purchaseError,vn=_n.purchaseErrorBlockRef,Cn=_n.purchaseTokenAuthState,Rn=a.useRef(En),Ln=null!=Sn&&null!=En?null===(n=Sn[En])||void 0===n?void 0:n.country:null,xn=a.useRef(Ln);a.useEffect((function(){if(!(0,Ee.Z8)()){var e,n=null!=En?null===(e=Sn[En])||void 0===e?void 0:e.country:"",t=xn.current!==n&&Rn.current!==En;ke.isPremiumSKU&&(!De&&!he||t)&&_.Z.wait((function(){return(0,h.Y2)(void 0,En)}));Rn.current=En;xn.current=n}}),[Ze,De,En,Sn,he,ke.isPremiumSKU]);var jn=(0,c.Z)((function(){return Date.now()}),[Pe]),Zn=function(e,n){e===ie.h8.CONFIRM&&(null==R||R());Ne(e);mn(null);var t=Date.now();On.default.track(ge.rMx.PAYMENT_FLOW_STEP,Bn(Dn({},In),{from_step:null!=n?n:Pe,to_step:e===ie.h8.ADD_PAYMENT_STEPS?ie.h8.PAYMENT_TYPE:e,step_duration_ms:t-jn,flow_duration_ms:t-dn}))};(0,ae.bp)(Pe,yn,Zn)
;(0,ie.dZ)(Pe,Fe,He);oe(Pe,Cn,Zn);var wn=function(){null==C||C(Fe===un.A.COMPLETED)};(0,D.Z)(wn);var Un,Fn=Hn(a.useState(),2),Yn=Fn[0],Kn=Fn[1],Jn=null!=Le?Le:de.Z.get(W.Xh.PREMIUM_MONTH_TIER_2),$n=[];null!=Jn&&($n=(0,gn.DE)(Jn.id,En,s));Un=null!=pe&&$n.includes(pe.currency)?pe.currency:$n.length>0?$n[0]:je.pK.USD;var qn=(0,gn.gr)(Un,null==Jn?void 0:Jn.id,En,s,ke.skuIDs),et=qn.priceOptions,tt=qn.setCurrency,rt=qn.currencyLoading,lt=(0,ue.vP)({paymentModalArgs:_n,initialStep:ie.h8.PAYMENT_TYPE,prependSteps:[ie.h8.PLAN_SELECT],appendSteps:[ie.h8.REVIEW,ie.h8.CONFIRM],breadcrumpSteps:ye,currentBreadcrumpStep:Pe,onReturn:function(){var e=Object.values(Sn).length<1&&null==y?ie.h8.PLAN_SELECT:ie.h8.REVIEW;Zn(e,ie.h8.PAYMENT_TYPE)},onComplete:function(e){Zn(ie.h8.REVIEW,e)},onStepChange:function(e){var n=e.currentStep,t=e.toStep,r=Date.now();On.default.track(ge.rMx.PAYMENT_FLOW_STEP,Bn(Dn({},In),{from_step:n,to_step:t,step_duration_ms:r-jn,flow_duration_ms:r-dn}))}
}),it=Y.useExperiment({}).newPlans,st=null!=En?Sn[En]:null,ot=!s&&null!=Ae&&Ae===W.Si.TIER_2&&null!=_e&&_e.hasHadPremium()&&me&&null==pe&&V(st),ut=X.L.useExperiment({}).enableTier0,ct=a.useMemo((function(){if(null==Ae||!ke.isPremiumSKU)return[];var e=(0,Ee.V7)(Ae,ot?it:[],pe,s);return ut&&Ae===W.Si.TIER_1?e.filter((function(e){return e!==W.Xh.PREMIUM_YEAR_TIER_1})):e}),[it,Ae,pe,ke.isPremiumSKU,ot,ut,s]),dt=null!=Re&&W.o4.has(Re)&&null!=st&&!V(st)?new Error(A.Z.Messages.BILLING_ERROR_INVALID_PLAN_FOR_PAYMENT_SOURCE):null,ft=Hn(a.useState((0,Mn.Em)(H,En,null==Le?void 0:Le.skuId)),1)[0],pt=Hn(a.useState((0,Mn.sE)(H,En,null==Le?void 0:Le.skuId)),1)[0];a.useEffect((function(){ft&&Mn.ZP.trackExposure({});if(pt){Ne(ie.h8.REVIEW);Me(W.Xh.PREMIUM_MONTH_TIER_2)}}),[ft,pt]);var It=Fe!==un.A.PURCHASING&&(!me||!De||rt||!$n.includes(et.currency)),_t=null==Re||(0,Ee.PV)(Re),Et=z.ZP.useExperiment({}).enabled,St=(0,z.rK)();a.useEffect((function(){St&&s&&z.ZP.trackExposure({})}),[St,s])
;var mt,ht=Et&&St&&s&&Ae===W.Si.TIER_2;if(Ie)mt=(0,r.jsx)(k.Vq,{});else if(It)mt=(0,r.jsx)(nt,{});else{null==En&&null!=pe&&null!=pe.paymentSourceId&&Tn(pe.paymentSourceId);switch(Pe){case ie.h8.SKU_SELECT:mt=(0,r.jsx)(zn,{selectSku:function(e){return Qn(pe,e,Oe,Zn,s)},onClose:wn,isGift:s});break;case ie.h8.WHAT_YOU_LOSE:mt=(0,r.jsx)(at,{handleStepChange:Zn,handleClose:wn});break;case ie.h8.PLAN_SELECT:o()(null!=Ae,"Expected planId");mt=(0,r.jsx)(N.Z,{steps:ye,isGift:s,isSeasonalGift:ht,giftMessage:d,currentStep:Pe,paymentError:Nn,body:(0,r.jsx)(We,{premiumSubscription:null!=pe?pe:null,skuId:Ae,selectedPlanId:Re,setSelectedPlanId:Me,isGift:s,isSeasonalGift:ht,selectedGiftStyle:Yn,setSelectedGiftStyle:Kn,priceOptions:et,planOptions:ct,eligibleForMultiMonthPlans:ot}),footer:(0,r.jsx)(v.mz,{justify:b.Z.Justify.BETWEEN,align:b.Z.Align.CENTER,children:(0,r.jsx)(Ye,{paymentSources:Sn,onStepChange:Zn,selectedPlanId:Re,isGift:s,onBackClick:function(){return Zn(ie.h8.SKU_SELECT)},
showBackButton:null==y&&null==m,planOptions:ct})})});break;case ie.h8.ADD_PAYMENT_STEPS:mt=lt;break;case ie.h8.AWAITING_PURCHASE_TOKEN_AUTH:mt=x({steps:ye,currentStep:Pe,paymentError:_n.paymentError,className:Gn().body,isEmailResent:we,setIsEmailResent:Ue});break;case ie.h8.AWAITING_AUTHENTICATION:mt=(0,r.jsx)(T.b,{steps:ye,currentStep:Pe,paymentError:_n.paymentError,className:hn().awaitingAuthenticationStep});break;case ie.h8.REVIEW:o()(null!=Re,"Expected planId");mt=(0,r.jsx)(N.Z,{steps:ye,currentStep:Pe,paymentError:Nn,purchaseError:bn,purchaseErrorBlockRef:vn,planError:dt,hideBreadcrumbs:pt,hasCurrencies:$n.length>1,body:null==pe||s?(0,r.jsx)(tn.Z,{selectedPlanId:Re,isGift:s,paymentSources:Sn,onPaymentSourceChange:function(e){return Tn(null!=e?e.id:null)},priceOptions:et,currencies:$n,onCurrencyChange:function(e){return tt(e)},handlePaymentSourceAdd:function(){return Zn(ie.h8.ADD_PAYMENT_STEPS)},setHasAcceptedTerms:Xe,legalTermsNodeRef:$e,hasLegalTermsFlash:an,trialId:pn,
trialFooterMessageOverride:K,reviewWarningMessage:te,purchaseState:Fe}):(0,r.jsx)(Pn,{premiumSubscription:pe,paymentSources:Sn,priceOptions:et,onPaymentSourceChange:function(e){Tn(null!=e?e.id:null)},onPaymentSourceAdd:function(){Zn(ie.h8.ADD_PAYMENT_STEPS);Tn(null)},planId:Re,setHasAcceptedTerms:Xe,legalTermsNodeRef:$e,hasLegalTermsFlash:an,onInvoiceError:function(e){return Je(e)},planGroup:ne,currencies:$n,onCurrencyChange:function(e){return tt(e)},hasOpenInvoice:null!=re,purchaseState:Fe}),footer:(0,r.jsx)(rn.Z,{premiumSubscription:null!=pe?pe:null,planId:Re,setHasAcceptedTerms:Xe,hasAcceptedTerms:Ve,priceOptions:et,setPurchaseState:He,onBack:function(){return Zn(ie.h8.PLAN_SELECT)},onNext:function(){return Zn(ie.h8.CONFIRM)},onPurchaseError:function(e){return mn(e)},legalTermsNodeRef:$e,flashLegalTerms:function(){return ln(!0)},invoiceError:Qe,planError:dt,analyticsLocation:Z,baseAnalyticsData:In,flowStartTime:dn,isGift:s,giftStyle:Yn,trialId:pn,planGroup:ne,
purchaseTokenAuthState:Cn,openInvoiceId:re,backButtonEligible:_t})});break;case ie.h8.CONFIRM:o()(null!=Re,"Expected planId");o()(null!=Ae,"Expected selectedSkuId");o()(null!=Le,"Expected subscriptionPlan");var yt,Tt=function(){wn();null==M||M()};if(null!=q)yt=q(Le,Tt);else if(s)yt=(0,r.jsx)(nn.T,{planId:Re,selectedGiftStyle:Yn,onClose:Tt});else if(sn.current===Re){var Pt;yt=(0,r.jsx)(nn.Z,{planId:Re,enableNoPaymentTrial:pt,postSuccessGuild:Q,onClose:Tt,paymentSourceType:null===(Pt=Sn[null!=En?En:""])||void 0===Pt?void 0:Pt.type})}else{var Nt;yt=(0,r.jsx)(nn.Z,{followupSKUInfo:O,enableNoPaymentTrial:pt,startingPremiumSubscriptionPlanId:sn.current,planId:Re,onClose:Tt,isDowngrade:null!=pe&&(0,fn.GY)(pe,Re,ne),paymentSourceType:null===(Nt=Sn[null!=En?En:""])||void 0===Nt?void 0:Nt.type})}mt=(0,r.jsx)(N.Z,{steps:ye,currentStep:Pe,body:yt,hideBreadcrumbs:!0});break;default:throw new Error("Unexpected step ".concat(Pe))}}var bt=null;if(Ie)bt=null;else if(null!=$){
o()(null!=Le,"Expected subscriptionPlan");bt=$(Le,wn,Pe)}else if(Pe!==ie.h8.SKU_SELECT&&Pe!==ie.h8.WHAT_YOU_LOSE&&null!=Ae){o()(Xn(Ae,W.y7),"invalid sku id: ".concat(Ae));bt=Pe===ie.h8.CONFIRM&&s&&ht&&null!=Yn?(0,r.jsx)(xe.Z,{giftStyle:Yn,className:hn().seasonalGiftBoxHeaderIcon}):(0,r.jsx)(en.Z,{currentStep:Pe,purchaseState:Fe,premiumType:W.y7[Ae],onClose:wn,useWinterTheme:ht})}return(0,r.jsx)(I.Uk,{className:hn().shaker,isShaking:_t&&Fe===un.A.PURCHASING,intensity:2,children:(0,r.jsxs)(v.Y0,{className:i()(hn().root,kn({},hn().withHeader,null!=bt)),transitionState:g,children:[bt,mt]})})}function $n(){var e,n,t=Hn(a.useState(!1),2),l=t[0],i=t[1],s=(n=(e=function(){return Kn(this,(function(e){switch(e.label){case 0:i(!0);return[4,(0,m.xA)()];case 1:e.sent();return[2]}}))},function(){var n=this,t=arguments;return new Promise((function(r,a){var l=e.apply(n,t);function i(e){Un(l,r,a,i,s,"next",e)}function s(e){Un(l,r,a,i,s,"throw",e)}i(void 0)}))}),function(){return n.apply(this,arguments)
});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Cn.Z,{}),(0,r.jsx)(Rn.C3,{children:(0,r.jsx)(M,{className:Gn().body,isEmailResent:l,resendEmail:s})}),(0,r.jsx)(Rn.O3,{children:(0,r.jsx)(L,{})})]})}function qn(){return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Cn.Z,{}),(0,r.jsx)(Rn.C3,{children:(0,r.jsx)(T.F,{className:hn().awaitingAuthenticationStep})})]})}var et=[{key:null,renderStep:function(e){return(0,r.jsx)(tt,Dn({},e))}},{key:ie.h8.SKU_SELECT,renderStep:function(e){return(0,r.jsx)(rt,Dn({},e))},options:{renderHeader:!1,hideSlider:!0}},{key:ie.h8.WHAT_YOU_LOSE,renderStep:function(e){return(0,r.jsx)(at,Dn({},e))},options:{renderHeader:!1,hideSlider:!0}},{key:ie.h8.PLAN_SELECT,renderStep:function(e){return(0,r.jsx)(it,Dn({},e))},options:{renderHeader:!0,breadcrumb:function(){return A.Z.Messages.BILLING_STEP_SELECT_PLAN}}},{key:ie.h8.ADD_PAYMENT_STEPS,renderStep:function(e){return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(xn.v,Bn(Dn({},e),{breadcrumbSteps:Vn}))})},options:{
renderHeader:!0,breadcrumb:function(){return A.Z.Messages.BILLING_STEP_PAYMENT}}},{key:ie.h8.AWAITING_PURCHASE_TOKEN_AUTH,renderStep:function(){return(0,r.jsx)($n,{})}},{key:ie.h8.AWAITING_AUTHENTICATION,renderStep:function(){return(0,r.jsx)(qn,{})}},{key:ie.h8.REVIEW,renderStep:function(e){return(0,r.jsx)(st,Dn({},e))},options:{renderHeader:!0,breadcrumb:function(){return A.Z.Messages.BILLING_STEP_REVIEW}}},{key:ie.h8.CONFIRM,renderStep:function(e){return(0,r.jsx)(ot,Dn({},e))}}];function nt(){return(0,r.jsx)(I.$j,{className:hn().spinner})}function tt(e){var n=e.subscriptionTier,t=e.initialPlanId,l=e.setAnalyticsData,i=(0,P.usePaymentContext)(),s=i.blockedPayments,o=i.setStep,u=i.hasFetchedSubscriptions,c=i.hasFetchedSubscriptionPlans,d=i.currencyLoading,f=i.selectedSkuId,I=i.setSelectedSkuId,_=i.selectedPlan,E=i.setSelectedPlanId,m=i.priceOptions,h=i.isGift,y=Hn(a.useState(!u||!c||d),2),T=y[0],N=y[1],b=(0,p.e7)([An.Z],(function(){return An.Z.applicationIdsFetched.has(W.RQ)}))
;a.useEffect((function(){N(!u||!c||d)}),[d,c,u]);a.useEffect((function(){E(t);b||(0,S.yD)(W.RQ);if(!T&&!s)if(null!=t){var e;I(null===(e=de.Z.get(t))||void 0===e?void 0:e.skuId);o(ie.h8.REVIEW)}else if(null!=n){I(n);o(ie.h8.PLAN_SELECT)}else o(ie.h8.SKU_SELECT)}),[s,b,t,h,T,m,_,f,l,E,I,o,n]);return T?(0,r.jsx)(nt,{}):s?(0,r.jsx)(k.Vq,{}):null}function rt(e){var n=e.handleStepChange,t=e.handleClose,a=(0,P.usePaymentContext)(),l=a.setSelectedSkuId,i=a.activeSubscription,s=a.isGift;return(0,r.jsx)(zn,{selectSku:function(e){return Qn(i,e,l,n,s)},onClose:t,isGift:s})}function at(e){var n=e.handleStepChange,t=e.handleClose,a=(0,Z.ZP)(),l=(0,P.usePaymentContext)().activeSubscription,i=null!=l?(0,Ee.Af)(l):null,s=null!=i?(0,Ee.gq)(i.planId):null,u=null!=i?(0,Ee.Rd)(i.planId):null;o()(null!=u,"Expected premium type");return(0,r.jsx)(le.Z,{premiumType:u,titleText:A.Z.Messages.PREMIUM_DOWNGRADE_WHAT_YOU_LOSE_TITLE,subtitleText:A.Z.Messages.PREMIUM_DOWNGRADE_WHAT_YOU_LOSE_SUBTITLE.format({
subscriptionName:s}),footer:(0,r.jsxs)("div",{className:hn().whatYouLoseButtonContainer,children:[(0,r.jsx)(I.zx,{onClick:function(){return n(ie.h8.PLAN_SELECT)},children:A.Z.Messages.CONTINUE}),(0,r.jsx)(I.zx,{look:I.zx.Looks.LINK,color:a===je.BR.DARK?I.zx.Colors.WHITE:I.zx.Colors.PRIMARY,onClick:t,children:A.Z.Messages.PREMIUM_CANCEL_WHAT_YOU_LOSE_BACK})]}),onClose:t,isDowngrade:!0})}function lt(e){var n=e.giftMessage,t=void 0===n?A.Z.Messages.PREMIUM_PAYMENT_IS_GIFT:n;return!1===(0,P.usePaymentContext)().isGift?null:(0,r.jsx)(y.Z,{className:hn().paymentNote,iconSize:y.Z.Sizes.SMALL,icon:$.Z,color:null==t?y.Z.Colors.PRIMARY:y.Z.Colors.SECONDARY,children:t})}function it(e){var n=e.giftMessage,t=e.selectedGiftStyle,l=e.setSelectedGiftStyle,i=e.handleStepChange,s=e.isPremium,u=e.initialPlanId,c=e.subscriptionTier,d=e.trialId,f=(0,
P.usePaymentContext)(),I=f.activeSubscription,_=f.hasFetchedSubscriptions,E=f.isGift,S=f.paymentSourceId,m=f.paymentSources,h=f.selectedSkuId,y=f.selectedPlan,T=f.step,N=z.ZP.useExperiment({}).enabled,A=(0,z.rK)();a.useEffect((function(){A&&E&&z.ZP.trackExposure({})}),[A,E]);var O=N&&A&&E&&h===W.Si.TIER_2,g=null!=S?m[S]:null,C=Y.useExperiment({}).newPlans,R=(0,p.e7)([J.default],(function(){return J.default.getCurrentUser()})),M=!E&&null!=h&&h===W.Si.TIER_2&&null!=R&&R.hasHadPremium()&&_&&null==I&&V(g),L=a.useMemo((function(){return null!=h&&s?(0,Ee.V7)(h,M?C:[],I,E):[]}),[h,s,C,I,M,E]),x=null==u&&null==c;o()(null!=T,"Step should be set");return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(lt,{giftMessage:n}),(0,r.jsx)(Cn.Z,{}),(0,r.jsxs)(Rn.C3,{children:[(0,r.jsx)(te,{trialId:d,isGift:E,plan:y}),(0,r.jsx)(jn.Z,{}),(0,r.jsx)(We,{isGift:E,selectedGiftStyle:t,setSelectedGiftStyle:l,planOptions:L,eligibleForMultiMonthPlans:M,isSeasonalGift:O})]}),(0,r.jsx)(Rn.O3,{children:(0,r.jsx)(v.mz,{
justify:b.Z.Justify.BETWEEN,align:b.Z.Align.CENTER,children:(0,r.jsx)(Ye,{onStepChange:i,isGift:E,onBackClick:function(){return i(ie.h8.SKU_SELECT)},showBackButton:x,planOptions:L})})})]})}function st(e){var n=e.handleStepChange,t=e.trialId,l=e.trialFooterMessageOverride,i=e.reviewWarningMessage,s=e.planGroup,u=e.openInvoiceId,c=e.analyticsData,d=e.selectedGiftStyle,f=e.analyticsLocation,p=e.isPremium,I=e.giftMessage,_=(0,P.usePaymentContext)(),E=_.activeSubscription,S=_.setUpdatedSubscription,m=_.contextMetadata,h=_.currencies,y=_.isGift,T=_.paymentSourceId,N=_.paymentSources,b=_.priceOptions,v=_.purchaseError,O=_.purchaseTokenAuthState,g=_.selectedPlan,C=_.selectedSkuId,R=_.setCurrency,M=_.setPaymentSourceId,L=_.setPurchaseState,x=_.setPurchaseError,Z=_.step,G=_.purchaseState;o()(null!=g,"Expected plan to be selected");o()(null!=Z,"Step should be set");var w=a.useRef(null),U=Hn((0,
j.Z)(!1,500),2),k=U[0],D=U[1],B=Hn(a.useState(!1),2),F=B[0],H=B[1],Y=null==t||p&&!W.nG[t].skus.includes(C)?null:t;a.useEffect((function(){null!=v&&null!=w.current&&w.current.scrollIntoView({behavior:"smooth"})}),[v]);var K=a.useCallback((function(e){S(e);n(ie.h8.CONFIRM)}),[n,S]),X=null!=T?N[T]:null,z=null!=g&&W.o4.has(g.id)&&null!=X&&!V(X)?new Error(A.Z.Messages.BILLING_ERROR_INVALID_PLAN_FOR_PAYMENT_SOURCE):null,Q=a.useRef(null),J=Hn(a.useState(null),2),$=J[0],q=J[1];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(lt,{giftMessage:I}),(0,r.jsx)(Cn.Z,{}),(0,r.jsxs)(Rn.C3,{children:[(0,r.jsx)(jn.Z,{}),null==E||y?(0,r.jsx)(tn.Z,{selectedPlanId:g.id,isGift:y,paymentSources:N,onPaymentSourceChange:function(e){return M(null!=e?e.id:null)},priceOptions:b,currencies:h,onCurrencyChange:function(e){return R(e)},handlePaymentSourceAdd:function(){return n(ie.h8.ADD_PAYMENT_STEPS)},setHasAcceptedTerms:H,legalTermsNodeRef:Q,hasLegalTermsFlash:k,trialId:Y,trialFooterMessageOverride:l,
reviewWarningMessage:i,purchaseState:G}):(0,r.jsx)(Pn,{premiumSubscription:E,paymentSources:N,priceOptions:b,onPaymentSourceChange:function(e){M(null!=e?e.id:null)},onPaymentSourceAdd:function(){n(ie.h8.ADD_PAYMENT_STEPS);M(null)},planId:g.id,setHasAcceptedTerms:H,legalTermsNodeRef:Q,hasLegalTermsFlash:k,onInvoiceError:function(e){return q(e)},planGroup:s,currencies:h,onCurrencyChange:function(e){return R(e)},hasOpenInvoice:null!=u,purchaseState:G})]}),(0,r.jsx)(Rn.O3,{children:(0,r.jsx)(rn.Z,{premiumSubscription:null!=E?E:null,planId:g.id,setHasAcceptedTerms:H,hasAcceptedTerms:F,priceOptions:b,setPurchaseState:L,onBack:function(){return n(ie.h8.PLAN_SELECT)},onNext:K,onPurchaseError:function(e){return x(e)},legalTermsNodeRef:Q,flashLegalTerms:function(){return D(!0)},invoiceError:$,planError:z,analyticsLocation:f,baseAnalyticsData:c,flowStartTime:m.startTime,isGift:y,giftStyle:d,trialId:Y,planGroup:s,purchaseTokenAuthState:O,openInvoiceId:u,backButtonEligible:p})})]})}function ot(e){
var n,t=e.handleClose,a=e.planGroup,l=e.selectedGiftStyle,i=e.onSubscriptionConfirmation,s=e.renderPurchaseConfirmation,u=e.startingPremiumSubscriptionPlanIdRef,c=e.postSuccessGuild,d=e.followupSKUInfo,f=(0,P.usePaymentContext)(),p=f.activeSubscription,I=f.isGift,_=f.paymentSources,E=f.paymentSourceId,S=f.selectedPlan,m=f.selectedSkuId,h=f.step,y=f.updatedSubscription;o()(null!=S,"Expected plan to selected");o()(null!=m,"Expected selectedSkuId");o()(null!=h,"Step should be set");var T=function(){t();null==i||i()};if(null!=s)n=s(S,T,y);else if(I)n=(0,r.jsx)(nn.T,{planId:S.id,selectedGiftStyle:l,onClose:T});else if(u.current===S.id){var N;n=(0,r.jsx)(nn.Z,{planId:S.id,postSuccessGuild:c,onClose:T,paymentSourceType:null===(N=_[null!=E?E:""])||void 0===N?void 0:N.type})}else{var b;n=(0,r.jsx)(nn.Z,{followupSKUInfo:d,startingPremiumSubscriptionPlanId:u.current,planId:S.id,onClose:T,isDowngrade:null!=p&&(0,fn.GY)(p,S.id,a),
paymentSourceType:null===(b=_[null!=E?E:""])||void 0===b?void 0:b.type})}return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)(Rn.C3,{children:[(0,r.jsx)(jn.Z,{}),n]})})}function ut(e){var n=e.forceNewPaymentModal,t=Fn(e,["forceNewPaymentModal"]),l=Ln.Z.useExperiment({}).newModal;a.useEffect((function(){n||Ln.Z.trackExposure({})}),[n]);return n||l?function(e){var n=e.analyticsLocation,t=e.analyticsObject,l=e.analyticsSourceLocation,s=e.analyticsSubscriptionType,u=void 0===s?ge.NYc.PREMIUM:s,d=e.onComplete,f=e.transitionState,E=e.initialPlanId,S=e.giftMessage,m=e.subscriptionTier,y=e.onClose,T=e.trialId,N=e.isGift,b=void 0!==N&&N,A=e.trialFooterMessageOverride,O=e.reviewWarningMessage,g=e.planGroup,C=void 0===g?W.Y1:g,R=e.openInvoiceId,M=e.onSubscriptionConfirmation,L=e.renderPurchaseConfirmation,x=e.postSuccessGuild,j=e.followupSKUInfo,Z=e.renderHeader,G=e.applicationId,U=e.guildId,k=(0,
P.usePaymentContext)(),B=k.purchaseState,F=k.setPurchaseState,H=k.selectedSkuId,Y=k.selectedPlan,K=k.setStep,V=k.setPurchaseError,X=k.paymentAuthenticationState,Q=k.step,J=k.contextMetadata,$=k.purchaseTokenAuthState,q=k.activeSubscription,ee=k.priceOptions,ne=k.hasFetchedSubscriptionPlans,te=k.hasPaymentSources,re=(0,w.Z)().analyticsLocations,le=Hn(a.useState({load_id:J.loadId,payment_type:"subscription",location:null!=n?n:t,source:l,subscription_type:u,subscription_plan_id:null==Y?void 0:Y.id,is_gift:b,eligible_for_trial:null!=T,location_stack:re,sku_id:m,application_id:G,guild_id:U,payment_modal_version:"v1"}),2),se=le[0],ue=le[1];a.useEffect((function(){ue((function(e){var n=null!=Y?(0,Ee.aS)(Y.id,!1,b,ee):void 0;return Bn(Dn({},e),{subscription_plan_id:null==Y?void 0:Y.id,price:null==n?void 0:n.amount,regular_price:null==Y?void 0:Y.price,currency:ee.currency})}))}),[Y,b,ee]);var ce=(0,p.e7)([An.Z],(function(){return An.Z.applicationIdsFetched.has(W.RQ)}));a.useEffect((function(){
ce&&ne&&On.default.track(ge.rMx.PAYMENT_FLOW_STARTED,Bn(Dn({},se),{has_saved_payment_source:te}))}),[ce,ne]);a.useEffect((function(){_.Z.wait((function(){return(0,h.Y2)()}))}),[]);var de=a.useMemo((function(){return null==Y||(0,Ee.PV)(Y.id)}),[Y]),fe=Hn(a.useState(),2),pe=fe[0],Ie=fe[1],_e=(0,c.Z)((function(){return Date.now()}),[Q]),Se=a.useCallback((function(e,n){e===ie.h8.CONFIRM&&(null==d||d());K(e);V(null);var t=Date.now();On.default.track(ge.rMx.PAYMENT_FLOW_STEP,Bn(Dn({},se),{from_step:null!=n?n:Q,to_step:e===ie.h8.ADD_PAYMENT_STEPS?ie.h8.PAYMENT_TYPE:e,step_duration_ms:t-_e,flow_duration_ms:t-J.startTime}))}),[se,J.startTime,d,V,K,Q,_e]),me=a.useMemo((function(){return function(){return null==y?void 0:y(B===un.A.COMPLETED)}}),[y,B]);(0,ae.bp)(Q,X,Se);(0,ie.dZ)(Q,B,F);oe(Q,$,Se);(0,D.Z)(me);(0,be.w)(q,(function(){return y(!1)}),b);var he=a.useRef(null!=q?q.planId:null);a.useEffect((function(){null==he.current&&null!=q&&(he.current=q.planId)}),[q]);var ye={initialPlanId:E,
isPremium:de,giftMessage:S,selectedGiftStyle:pe,setSelectedGiftStyle:Ie,subscriptionTier:m,handleStepChange:Se,handleClose:me,analyticsData:se,setAnalyticsData:ue,trialId:T,trialFooterMessageOverride:A,reviewWarningMessage:O,planGroup:C,openInvoiceId:R,analyticsLocation:n,onSubscriptionConfirmation:M,renderPurchaseConfirmation:L,postSuccessGuild:x,followupSKUInfo:j,startingPremiumSubscriptionPlanIdRef:he},Te=z.ZP.useExperiment({}).enabled,Pe=(0,z.rK)();a.useEffect((function(){Pe&&b&&z.ZP.trackExposure({})}),[Pe,b]);var Ne=Te&&Pe&&b&&H===W.Si.TIER_2,ve=a.useMemo((function(){var e=null;if(Ne&&Q===ie.h8.CONFIRM&&null!=pe)e=(0,r.jsx)(xe.Z,{giftStyle:pe,className:hn().seasonalGiftBoxHeaderIcon});else if(null!=Z&&null!=Y&&null!=Q)e=Z(Y,me,Q);else if(Q!==ie.h8.SKU_SELECT&&null!=H){o()(Xn(H,W.y7),"invalid sku id: ".concat(H));e=(0,r.jsx)(en.Z,{currentStep:null!=Q?Q:void 0,purchaseState:B,premiumType:W.y7[H],onClose:me,useWinterTheme:Ne})}return e}),[Ne,pe,me,B,Z,Y,H,Q]);return(0,r.jsx)(I.Uk,{
className:hn().shaker,isShaking:de&&B===un.A.PURCHASING,intensity:2,children:(0,r.jsx)(v.Y0,{className:i()(hn().root,kn({},hn().withHeader,null!=ve)),transitionState:f,children:(0,r.jsx)(Rn.ZP,Dn({header:ve},ye))})})}(t):Jn(t)}function ct(e){var n=(0,p.e7)([fe.Z],(function(){return fe.Z.getPremiumTypeSubscription()})),t=(0,w.Z)(e.analyticsLocations,G.Z.PREMIUM_PAYMENT_MODAL).AnalyticsLocationProvider,a=e.subscriptionTier,l=e.isGift,i=e.loadId;if(null!=a&&!Object.values(W.Si).includes(a))throw new Error("subscriptionTier must be a premium subscription");return(0,r.jsx)(t,{children:(0,r.jsx)(P.PaymentContextProvider,{loadId:i,activeSubscription:n,stepConfigs:et,skuIDs:Wn(W.YQ),isGift:l,children:(0,r.jsx)(ut,Dn({},e))})})}},794057:(e,n,t)=>{t.d(n,{Z:()=>f});var r=t(785893),a=(t(667294),t(294184)),l=t.n(a),i=t(81951),s=t(95467),o=t(461061),u=t(959797),c=t(516178),d=t.n(c);const f=function(e){var n=e.fromBoostCancelModal,t=e.className;return(0,r.jsxs)("div",{className:l()(d().noticeRoot,t),
children:[(0,r.jsx)("div",{className:d().iconContainer,children:(0,r.jsx)(i.Z,{className:d().infoIcon})}),(0,r.jsx)("div",{className:d().text,children:(n?u.Z.Messages.LOCALIZED_PRICING_PLN_LEGACY_PRICING_BOOST_WARNING:u.Z.Messages.LOCALIZED_PRICING_PLN_LEGACY_PRICING_WARNING).format({helpCenterLink:s.Z.getArticleURL(o.BhN.LOCALIZED_PRICING)})})]})}},125313:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(785893),a=(t(667294),t(331535)),l=t(959797),i=t(241387),s=t.n(i);const o=function(e){var n=e.onClick;return(0,r.jsx)(a.ee,{onClick:n,className:s().link,children:l.Z.Messages.BACK})}},279480:(e,n,t)=>{t.d(n,{w:()=>d,H:()=>p});var r=t(667294),a=t(363010),l=t(992497),i=t(916957),s=t(922877),o=t(74030),u=t(375650),c=t(959797);function d(e,n,t){r.useEffect((function(){if(null!=e&&e.isPurchasedExternally&&null!=e.paymentGateway&&!t){l.Z.show({title:c.Z.Messages.BILLING_EXTERNAL_HEADER.format({paymentGatewayName:u.Vz[e.paymentGateway]}),body:c.Z.Messages.BILLING_EXTERNAL_MANAGE_ELSEWHERE.format({
paymentGatewayName:u.Vz[e.paymentGateway],subscriptionManagementLink:(0,o.JE)(e.paymentGateway,"SUBSCRIPTION_MANAGEMENT")}),confirmText:c.Z.Messages.OKAY});n()}}),[e])}var f=[];function p(e,n){var t=(0,a.e7)([i.Z],(function(){return i.Z.get(e)})),l=(0,a.e7)([s.Z],(function(){var e;return null!=t&&null!==(e=s.Z.getForSku(t.skuId))&&void 0!==e?e:f})),u=r.useMemo((function(){return Array.from(l).filter((function(e){var n=e.parentId,t=e.consumed;return null!=n&&!t}))}),[l]);return{hasEntitlements:!n&&null!=t&&null!=u&&u.length>=o.ZP.getIntervalMonths(t.interval,t.intervalCount),entitlements:u}}},677839:(e,n,t)=>{t.d(n,{T:()=>B,Z:()=>D});var r=t(785893),a=t(667294),l=t(441143),i=t.n(l),s=t(363010),o=t(331535),u=t(512172),c=t(305630),d=t(173436),f=t(323657);function p(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function I(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1;r.configurable=!0;"value"in r&&(r.writable=!0)
;Object.defineProperty(e,r.key,r)}}function _(e){_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return _(e)}function E(e,n){return!n||"object"!==m(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function S(e,n){S=Object.setPrototypeOf||function(e,n){e.__proto__=n;return e};return S(e,n)}var m=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function h(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var t,r=_(e);if(n){var a=_(this).constructor;t=Reflect.construct(r,arguments,a)}else t=r.apply(this,arguments);return E(this,t)}}var y=null,T=null,P=null
;function N(e){var n=e.error;y=n}function b(){y=null}var v=function(e){!function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}});n&&S(e,n)}(t,e);var n=h(t);function t(){p(this,t);return n.apply(this,arguments)}var r=t.prototype;r.getGiftCode=function(e){return e===P?T:null};r.__getLocalVars=function(){return{paymentError:y,giftCode:T,giftCodeSkuId:P}};!function(e,n,t){n&&I(e.prototype,n);t&&I(e,t)}(t,[{key:"paymentError",get:function(){return y}}]);return t}(s.ZP.Store);v.displayName="PremiumPaymentModalStore";const A=new v(d.Z,{PREMIUM_PAYMENT_SUBSCRIBE_FAIL:N,PREMIUM_PAYMENT_UPDATE_FAIL:N,PREMIUM_PAYMENT_SUBSCRIBE_SUCCESS:function(){b()},PREMIUM_PAYMENT_UPDATE_SUCCESS:b,PREMIUM_PAYMENT_ERROR_CLEAR:b,BRAINTREE_TOKENIZE_PAYPAL_FAIL:function(e){var n=e.message,t=e.code;y=new f.HF(n,t)},BRAINTREE_TOKENIZE_VENMO_FAIL:function(e){
var n=e.message,t=e.code;y=new f.HF(n,t)},SKU_PURCHASE_SUCCESS:function(e){T=e.giftCode;P=e.skuId},SKU_PURCHASE_FAIL:function(e){y=e.error},SKU_PURCHASE_AWAIT_CONFIRMATION:function(e){e.isGift&&(P=e.skuId)},GIFT_CODE_CREATE:function(e){var n=e.giftCode;if(0!==n.uses||n.sku_id!==P)return!1;T=n.code}});var O=t(916957),g=t(512238),C=t(956299),R=t(74030),M=t(796805),L=t(298716),x=t(461061),j=t(959797),Z=t(618941),G=t.n(Z);function w(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function U(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done);i=!0){l.push(r.value);if(n&&l.length===n)break}}catch(e){s=!0;a=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw a}}return l}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return w(e,n)
;var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return w(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e){var n,t,a,l=e.planId,o=e.startingPremiumSubscriptionPlanId,u=e.paymentSourceType,c=U((0,s.Wu)([O.Z],(function(){return[O.Z.get(o),O.Z.get(l)]})),2),d=c[0],f=c[1];i()(null!=d&&null!=f,"Missing startingPlan or newPlan");if(t=o,a=l,L.Y1.indexOf(t)<L.Y1.indexOf(a))switch(l){case L.Xh.PREMIUM_MONTH_TIER_1:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_1;x.X7u.has(null!=u?u:x.HeQ.UNKNOWN)&&(n=j.Z.Messages.BILLING_SWITCH_PLAN_DELAYED_CONFIRMATION_TIER_1.format());break;case L.Xh.PREMIUM_MONTH_TIER_2:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_UPGRADE_TIER_2_MONTH
;x.X7u.has(null!=u?u:x.HeQ.UNKNOWN)&&(n=j.Z.Messages.BILLING_SWITCH_PLAN_DELAYED_CONFIRMATION_TIER_2.format());break;case L.Xh.PREMIUM_YEAR_TIER_1:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_UPGRADE_TIER_1_YEAR;x.X7u.has(null!=u?u:x.HeQ.UNKNOWN)&&(n=j.Z.Messages.BILLING_SWITCH_PLAN_DELAYED_CONFIRMATION_UPGRADE_TIER_1_YEAR.format());break;case L.Xh.PREMIUM_YEAR_TIER_2:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_UPGRADE_TIER_2_YEAR.format({numFreeGuildSubscriptions:L.cb});x.X7u.has(null!=u?u:x.HeQ.UNKNOWN)&&(n=j.Z.Messages.BILLING_SWITCH_PLAN_DELAYED_CONFIRMATION_UPGRADE_TIER_2_YEAR.format({numFreeGuildSubscriptions:L.cb}));break;case L.Xh.PREMIUM_3_MONTH_TIER_2:case L.Xh.PREMIUM_6_MONTH_TIER_2:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_UPGRADE_TIER_2_MULTI_MONTH;break;case L.Xh.PREMIUM_MONTH_TIER_0:case L.Xh.PREMIUM_YEAR_TIER_0:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TO_TIER_0;break;default:throw new Error("Unexpected planId: ".concat(l))
}else if(d.skuId===L.Si.TIER_2&&f.skuId===L.Si.TIER_1)n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_2_TO_TIER_1;else switch(f.skuId){case L.Si.TIER_0:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TO_TIER_0;break;case L.Si.TIER_1:n=j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_1_YEAR_TO_MONTH;break;case L.Si.TIER_2:n=1!==d.intervalCount?j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_2_GENERIC_TO_MONTH:j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_2_YEAR_TO_MONTH;break;default:throw new Error("Unexpected skuId: ".concat(f.skuId))}return(0,r.jsx)("div",{className:G().text,children:n})}function D(e){var n,t=e.planId,l=e.enableNoPaymentTrial,c=e.startingPremiumSubscriptionPlanId,d=e.onClose,f=e.followupSKUInfo,p=e.isDowngrade,I=e.hideClose,_=e.postSuccessGuild,E=e.paymentSourceType,S=a.useContext(C.Z),m=(0,s.e7)([g.Z],(function(){return null!=f?g.Z.get(f.id):null}));a.useEffect((function(){if(null!=f&&null==m){var e=f.applicationId,n=f.id;(0,u.jU)(e,n).catch(x.VqG)}}),[f,m])
;var h=function(e){return e.skuId===L.Si.TIER_0?x.X7u.has(null!=E?E:x.HeQ.UNKNOWN)?j.Z.Messages.BILLING_SWITCH_PLAN_DELAYED_CONFIRMATION_TIER_1.format():j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_0:e.skuId===L.Si.TIER_1?x.X7u.has(null!=E?E:x.HeQ.UNKNOWN)?j.Z.Messages.BILLING_SWITCH_PLAN_DELAYED_CONFIRMATION_TIER_1.format():j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_1:x.X7u.has(null!=E?E:x.HeQ.UNKNOWN)?j.Z.Messages.BILLING_SWITCH_PLAN_DELAYED_CONFIRMATION_TIER_2.format():l?j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_2_NO_PAYMENT_TRIAL:j.Z.Messages.BILLING_SWITCH_PLAN_CONFIRM_TIER_2};if(null!=m)n=(0,r.jsx)("div",{className:G().text,children:j.Z.Messages.PREMIUM_PAYMENT_CONFIRMATION_BLURB_IAP.format({skuName:m.name})});else if(null!=c)n=(0,r.jsx)(k,{planId:t,startingPremiumSubscriptionPlanId:c});else if(null!=_){var y=O.Z.get(t);i()(null!=y,"Missing plan");n=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:G().text,children:h(y)}),(0,r.jsx)("div",{className:G().text,
children:j.Z.Messages.BILLING_POST_PURCHASE_JOIN_GUILD_FOR_EMOJI.format({guildName:_.name})})]})}else{var T=O.Z.get(t);i()(null!=T,"Missing plan");n=(0,r.jsx)("div",{className:G().text,children:h(T)})}var P,N=R.ZP.getPremiumType(t);i()(null!=N,"premium type should not be null in purchase confirmation");P=null!=m?j.Z.Messages.PREMIUM_PAYMENT_CONFIRMATION_BUTTON_IAP.format({skuName:m.name}):p?j.Z.Messages.PREMIUM_DOWNGRADE_DONE_BUTTON:null!=_?j.Z.Messages.BILLING_POST_PURCHASE_JOIN_GUILD_FOR_EMOJI_CTA:j.Z.Messages.PREMIUM_UPGRADE_DONE_BUTTON;return(0,r.jsxs)("div",{className:G().confirmation,children:[(0,r.jsx)(M.C,{className:G().banner,theme:S,premiumType:N,type:x.X7u.has(null!=E?E:x.HeQ.UNKNOWN)?M.C.Types.PREMIUM_PAYMENT_STARTED:null!=c?M.C.Types.PREMIUM_UPDATED:M.C.Types.PREMIUM_ACTIVATED}),n,I?null:(0,r.jsx)(o.zx,{onClick:d,children:P})]})}function B(e){var n=e.planId,t=e.selectedGiftStyle,a=e.onClose,l=(0,s.e7)([O.Z],(function(){return O.Z.get(n)}));i()(null!=l,"Missing plan")
;var o=(0,s.e7)([A],(function(){return A.getGiftCode(l.skuId)}));return(0,r.jsx)(c.Z,{giftCode:o,subscriptionPlan:l,onClose:a,selectedGiftStyle:t})}},230903:(e,n,t)=>{t.d(n,{Z:()=>Z});var r=t(785893),a=(t(667294),t(441143)),l=t.n(a),i=t(43833),s=t(363010),o=t(331535),u=t(238307),c=t(556137),d=t(909187),f=t(655868),p=t(428455),I=t(832010),_=t(154765),E=t(851225),S=t(893321),m=t(378564),h=t(916957),y=t(436035),T=t(74030),P=t(56435),N=t(212658),b=t(939042),v=t(470352),A=t(112508),O=t(279480),g=t(461061),C=t(375650),R=t(959797),M=t(968071),L=t.n(M);function x(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function j(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done);i=!0){l.push(r.value);if(n&&l.length===n)break}}catch(e){s=!0;a=e}finally{try{
i||null==t.return||t.return()}finally{if(s)throw a}}return l}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return x(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return x(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e){var n,t=e.selectedPlanId,a=e.paymentSources,M=e.priceOptions,x=e.currencies,Z=e.onCurrencyChange,G=e.isGift,w=void 0!==G&&G,U=e.onPaymentSourceChange,k=e.handlePaymentSourceAdd,D=e.setHasAcceptedTerms,B=e.legalTermsNodeRef,F=e.hasLegalTermsFlash,H=e.trialId,W=e.trialFooterMessageOverride,Y=e.reviewWarningMessage,K=e.metadata,V=e.purchaseState,X=e.hideSubscriptionDetails,z=(0,s.e7)([h.Z],(function(){return h.Z.get(t)})),Q=null!=H
;l()(null!=z,"Missing plan");var J,$,q=[{planId:z.id,quantity:1}],ee=V===_.A.PURCHASING||V===_.A.COMPLETED,ne=w||ee,te=j((0,N.ED)({items:q,renewal:!1,preventFetch:ne,applyEntitlements:!0,paymentSourceId:M.paymentSourceId,currency:M.currency,trialId:H,metadata:K}),2),re=te[0],ae=te[1],le=j((0,N.ED)({items:q,renewal:!0,preventFetch:ne,trialId:H,paymentSourceId:M.paymentSourceId,currency:M.currency,metadata:K}),2),ie=le[0],se=le[1],oe=null!=ae?ae:se,ue=(0,s.e7)([S.Z],(function(){return S.Z.enabled})),ce=M.paymentSourceId,de=(0,O.H)(z.id,w),fe=de.hasEntitlements,pe=de.entitlements,Ie=(0,T.Ap)(M.paymentSourceId),_e=(0,E.sE)(H,ce,t);if(null!=oe){var Ee=oe.message;oe.code===p.SM.INVALID_CURRENCY_FOR_PAYMENT_SOURCE&&(Ee=R.Z.Messages.BILLING_ERROR_UNSUPPORTED_CURRENCY);return(0,r.jsx)(o.kz,{children:Ee})}if(w)$=(0,r.jsx)(A.e9,{paymentSourceId:M.paymentSourceId,plan:z,className:L().invoice,isPrepaidPaymentSource:Ie});else{if(null==re||null==ie)return(0,r.jsx)(o.$j,{})
;Q&&re.subscriptionPeriodEnd!==ie.subscriptionPeriodEnd&&(J=re.subscriptionPeriodEnd);$=(0,r.jsxs)(b.PO,{className:L().invoice,children:[(0,r.jsx)(b.q9,{children:R.Z.Messages.BILLING_SWITCH_PLAN_PURCHASE_DETAILS}),(0,r.jsx)(A.Lu,{invoice:re,newPlan:z,isPrepaidPaymentSource:Ie}),Ie?null:(0,r.jsx)(A.nd,{renewalInvoice:ie,isTrial:Q,priceOptions:M,overrideRenewalDate:J,trialFooterMessageOverride:W,hideSubscriptionDetails:X})]})}var Se=i.M.EEA_COUNTRIES.has(m.Z.ipCountryCodeWithFallback),me=function(e,n,t){var r=null,a=null,l=null;if(e&&null!=n){var i=T.ZP.getIntervalForInvoice(n),s=i.intervalType,o=i.intervalCount,u=(0,P.og)((0,P.T4)(n.total,n.currency),s,o),c=null!=t?t:n.subscriptionPeriodEnd;r=R.Z.Messages.BILLING_LEGAL_MUMBO_JUMBO_TRIAL_TERMS_LABEL.format({termsURL:g.EYA.TERMS,paidURL:g.EYA.PAID_TERMS,rate:u,renewalDate:c});a=L().trialCheckbox;l=L().trialCheckboxLabel}return{checkboxLabel:r,checkboxClassname:a,checkboxLabelClassname:l}
}(Q,ie,J),he=me.checkboxLabel,ye=me.checkboxClassname,Te=me.checkboxLabelClassname,Pe=R.Z.Messages.BILLING_SELECT_PLAN_GUILD_SUBSCRIPTION.format({planName:z.name});w?Pe=R.Z.Messages.PAYMENT_MODAL_SUBTITLE_PREMIUM_GIFT:(0,T.PV)(z.id)&&(Pe=T.ZP.getBillingReviewSubheader(null,z));return _e?null:(0,r.jsxs)("div",{className:L().stepBody,children:[null!=Y&&(0,r.jsxs)("div",{className:L().reviewWarningMessageContainer,children:[(0,r.jsx)(y.Z,{color:(0,I.Lq)(g.Ilk.YELLOW_300),width:20,height:20}),(0,r.jsx)(o.xv,{className:L().reviewWarningMessage,variant:"text-sm/normal",children:Y})]}),(0,r.jsx)(o.vw,{tag:o.RB.H5,children:Pe}),$,(0,r.jsxs)("div",{className:L().paymentSourceWrapper,children:[(0,r.jsx)(o.vw,{tag:o.RB.H5,children:R.Z.Messages.PAYMENT_SOURCE_PAYMENT_REQUEST_INFO_TITLE}),(0,r.jsx)(d.Z,{paymentSources:Object.values(a),selectedPaymentSourceId:ce,prependOption:fe?{label:R.Z.Messages.ATTACH_PAYMENT_SOURCE_PROMPT_OPTION_OPTIONAL,value:null}:null,onChange:U,onPaymentSourceAdd:k,
hidePersonalInformation:ue}),fe&&null==ce?(0,r.jsx)("div",{className:L().paymentSourceOptionalWarning,children:R.Z.Messages.ATTACH_PAYMENT_SOURCE_OPTIONAL_WITH_ENTITLEMENTS_WARNING.format({months:pe.length})}):null,(0,r.jsxs)(u.b,{currencies:x,className:L().currencyWrapper,children:[(0,r.jsx)(o.vw,{tag:o.RB.H5,children:R.Z.Messages.PAYMENT_CURRENCY}),(0,r.jsx)(u.Z,{selectedCurrency:M.currency,currencies:x,onChange:Z})]})]}),(0,r.jsx)(v.Z,{isActive:F,ref:B,children:(0,r.jsx)(f.Z,{onChange:D,forceShow:!0,checkboxLabel:he,checkboxClassname:ye,checkboxLabelClassname:Te,finePrint:(0,r.jsx)(c.Z,{hide:Q,subscriptionPlan:z,isGift:w,paymentSourceType:null===(n=a[null!=ce?ce:""])||void 0===n?void 0:n.type}),showPricingLink:z.currency!==C.pK.USD,showWithdrawalWaiver:Se,disabled:ee})})]})}},711462:(e,n,t)=>{t.d(n,{Z:()=>H})
;var r=t(785893),a=t(667294),l=t(441143),i=t.n(l),s=t(363010),o=t(331535),u=t(173436),c=t(737325),d=t(976882),f=t(951667),p=t(512172),I=t(64833),_=t(154765),E=t(851225),S=t(551705),m=t(775584),h=t(707955),y=t(792018),T=t(916957),P=t(487502),N=t(757987),b=t(67416),v=t(932847),A=t(74030),O=t(862325),g=t(194503),C=t(125313),R=t(279480),M=t(298716),L=t(461061),x=t(375650),j=t(959797);function Z(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=new Array(n);t<n;t++)r[t]=e[t];return r}function G(e,n,t,r,a,l,i){try{var s=e[l](i),o=s.value}catch(e){t(e);return}s.done?n(o):Promise.resolve(o).then(r,a)}function w(e){return function(){var n=this,t=arguments;return new Promise((function(r,a){var l=e.apply(n,t);function i(e){G(l,r,a,i,s,"next",e)}function s(e){G(l,r,a,i,s,"throw",e)}i(void 0)}))}}function U(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function k(e){for(var n=1;n<arguments.length;n++){
var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))));r.forEach((function(n){U(e,n,t[n])}))}return e}function D(e,n){n=null!=n?n:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):function(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})));t.push.apply(t,r)}return t}(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}));return e}function B(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,a,l=[],i=!0,s=!1;try{for(t=t.call(e);!(i=(r=t.next()).done);i=!0){l.push(r.value)
;if(n&&l.length===n)break}}catch(e){s=!0;a=e}finally{try{i||null==t.return||t.return()}finally{if(s)throw a}}return l}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return Z(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(t);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Z(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var F=function(e,n){var t,r,a,l,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return l={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function s(l){return function(s){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,
r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;(r=0,a)&&(l=[2&l[0],a.value]);switch(l[0]){case 0:case 1:a=l;break;case 4:i.label++;return{value:l[1],done:!1};case 5:i.label++;r=l[1];l=[0];continue;case 7:l=i.ops.pop();i.trys.pop();continue;default:if(!(a=i.trys,a=a.length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1];a=l;break}if(a&&i.label<a[2]){i.label=a[2];i.ops.push(l);break}a[2]&&i.ops.pop();i.trys.pop();continue}l=n.call(e,i)}catch(e){l=[6,e];r=0}finally{t=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function H(e){
var n=e.premiumSubscription,t=e.planId,l=e.setPurchaseState,Z=e.setHasAcceptedTerms,G=e.hasAcceptedTerms,U=e.priceOptions,H=e.onBack,W=e.onNext,Y=e.legalTermsNodeRef,K=e.flashLegalTerms,V=e.invoiceError,X=e.planError,z=e.onPurchaseError,Q=e.baseAnalyticsData,J=e.flowStartTime,$=e.isGift,q=void 0!==$&&$,ee=e.giftStyle,ne=e.trialId,te=e.planGroup,re=e.analyticsLocation,ae=e.purchaseTokenAuthState,le=e.openInvoiceId,ie=e.metadata,se=e.backButtonEligible,oe=e.disablePurchase,ue=function(){if(null!=Y.current){Y.current.scrollIntoView({behavior:"smooth"});K()}},ce=(0,s.e7)([T.Z],(function(){return T.Z.get(t)})),de=(0,E.sE)(ne,U.paymentSourceId,t),fe=(0,s.e7)([m.Z],(function(){return m.Z.popupCallbackCalled})),pe=(0,I.Z)().analyticsLocations;i()(null!=ce,"Missing subscriptionPlan");var Ie=U.paymentSourceId,_e=(0,s.e7)([h.Z],(function(){return null!=Ie?h.Z.getPaymentSource(Ie):null})),Ee=B(a.useState(de),2),Se=Ee[0],me=Ee[1],he=B(a.useState(!1),2),ye=he[0],Te=he[1],Pe=(0,
R.H)(t,q).hasEntitlements,Ne=(0,A.Ap)(U.paymentSourceId),be=function(e,n,t,r,a){return t?j.Z.Messages.PAYMENT_MODAL_BUTTON_PREMIUM_GIFT:a?j.Z.Messages.BILLING_SELECT_PLAN:null!=n?(0,O.R4)(n,e.id,r)?j.Z.Messages.BILLING_SWITCH_PLAN_UPGRADE:j.Z.Messages.BILLING_SWITCH_PLAN_CHANGE:(0,A.PV)(e.id)?(0,A.W_)(null,e):j.Z.Messages.BILLING_SELECT_PLAN_GUILD_SUBSCRIPTION.format({planName:e.name})}(ce,n,q,te,Ne),ve=null!=_e||Pe||de;a.useEffect((function(){var e,n=(e=w((function(){var e;return F(this,(function(n){switch(n.label){case 0:if(!0!==fe)return[3,6];n.label=1;case 1:n.trys.push([1,3,4,5]);return null==m.Z.redirectedPaymentId?[2]:[4,(0,c.OP)(m.Z.redirectedPaymentId)];case 2:n.sent();l(_.A.COMPLETED);W();return[3,5];case 3:e=n.sent();l(_.A.FAIL);z(e);v.default.track(L.rMx.PAYMENT_FLOW_FAILED,D(k({},Q),{payment_source_id:Ie,duration_ms:Date.now()-J}));return[3,5];case 4:me(!1);(0,c.K2)();return[7];case 5:return[3,8];case 6:return ae!==y.I.SUCCESS?[3,8]:[4,Ce()];case 7:n.sent();n.label=8
;case 8:return[2]}}))})),function(){return e.apply(this,arguments)});n()}),[fe]);a.useEffect((function(){de&&!q&&null==n&&Ce()}),[de,q,n]);var Ae,Oe,ge=(0,g.U)(),Ce=(Ae=w((function(){var e,r,a,s,o;return F(this,(function(I){switch(I.label){case 0:l(_.A.PURCHASING);Z(!0);me(!0);u.Z.wait(d.fw);z(null);I.label=1;case 1:I.trys.push([1,13,14,15]);i()(ve,"Missing paymentSource");v.default.track(L.rMx.PAYMENT_FLOW_COMPLETED,D(k({},Q),{duration_ms:Date.now()-J}));if(ye)return[2];if(!q)return[3,3];r=(0,A.aS)(ce.id,!1,!0,U);return[4,(0,p.ZZ)(M.RQ,ce.skuId,{expectedAmount:r.amount,expectedCurrency:r.currency,paymentSource:_e,subscriptionPlanId:t,isGift:!0,giftStyle:ee})];case 2:e=I.sent();return[3,12];case 3:return ge&&null!=le&&null!=_e&&null!=n?x.Uk.has(_e.type)?[4,(0,c.G)(n,le,_e,U.currency)]:[3,5]:[3,8];case 4:a=I.sent();return[3,7];case 5:return[4,(0,c.Mg)(n,{paymentSource:_e,currency:U.currency},pe,re)];case 6:a=I.sent();I.label=7;case 7:e=a;return[3,12];case 8:return null==n?[3,10]:[4,(0,
c.Mg)(n,{items:(0,A.al)(n,t,1,new Set(te)),paymentSource:_e,currency:U.currency},pe,re)];case 9:e=I.sent();return[3,12];case 10:return[4,(0,f.Ld)({planId:t,currency:U.currency,paymentSource:_e,trialId:ne,metadata:ie})];case 11:e=I.sent();I.label=12;case 12:if(e.redirectConfirmation){Te(null!=e.redirectURL);return[2]}l(_.A.COMPLETED);if("subscription"in e){s=null!=e.subscription?S.Z.createFromServer(e.subscription):null;W(s)}else W();return[3,15];case 13:o=I.sent();l(_.A.FAIL);z(o);v.default.track(L.rMx.PAYMENT_FLOW_FAILED,D(k({},Q),{payment_source_id:Ie,duration_ms:Date.now()-J}));return[3,15];case 14:ye||me(!1);return[7];case 15:return[2]}}))})),function(){return Ae.apply(this,arguments)});Oe=null!=V||null!=X||oe?(0,r.jsx)(o.zx,{color:o.zx.Colors.GREEN,disabled:!0,children:be}):ve?G?(0,r.jsx)(o.zx,{"data-testid":"purchase",onClick:Ce,color:o.zx.Colors.GREEN,submitting:Se,children:be}):(0,r.jsx)(N.ZP,{text:j.Z.Messages.BILLING_ACCEPT_TERMS_PAID_SERVICES_TOOLTIP,children:function(e){
return(0,r.jsx)(o.zx,D(k({},e),{color:o.zx.Colors.GREEN,type:"submit",onClick:ue,"data-testid":"submitButton",children:be}))}}):(0,r.jsx)(N.ZP,{text:j.Z.Messages.BILLING_SELECT_PAYMENT_SOURCE_TOOLTIP,children:function(e){return(0,r.jsx)(o.zx,D(k({},e),{color:o.zx.Colors.GREEN,type:"submit","data-testid":"submitButton",disabled:!0,children:be}))}});var Re=null!=le;return de?null:(0,r.jsxs)(b.mz,{justify:P.Z.Justify.BETWEEN,align:P.Z.Align.CENTER,children:[Oe,se&&!Re?(0,r.jsx)(C.Z,{onClick:H}):null]})}},672561:(e,n,t)=>{t.d(n,{Z:()=>r});const r=[{label:"Alberta",value:"AB"},{label:"British Columbia",value:"BC"},{label:"Manitoba",value:"MB"},{label:"New Brunswick",value:"NB"},{label:"Newfoundland and Labrador",value:"NL"},{label:"Nova Scotia",value:"NS"},{label:"Ontario",value:"ON"},{label:"Prince Edward Island",value:"PE"},{label:"Quebec",value:"QC"},{label:"Saskatchewan",value:"SK"},{label:"Northwest Territories",value:"NT"},{label:"Nunavut",value:"NU"},{label:"Yukon",value:"YT"}]},
188068:(e,n,t)=>{t.d(n,{Z:()=>r});const r=[{label:"Alabama",value:"AL"},{label:"Alaska",value:"AK"},{label:"American Samoa",value:"AS"},{label:"Arizona",value:"AZ"},{label:"Arkansas",value:"AR"},{label:"Armed Forces: Americas",value:"AA"},{label:"Armed Forces: Europe",value:"AE"},{label:"Armed Forces: Pacific",value:"AP"},{label:"California",value:"CA"},{label:"Colorado",value:"CO"},{label:"Connecticut",value:"CT"},{label:"Delaware",value:"DE"},{label:"District Of Columbia",value:"DC"},{label:"Federated States Of Micronesia",value:"FM"},{label:"Florida",value:"FL"},{label:"Georgia",value:"GA"},{label:"Guam",value:"GU"},{label:"Hawaii",value:"HI"},{label:"Idaho",value:"ID"},{label:"Illinois",value:"IL"},{label:"Indiana",value:"IN"},{label:"Iowa",value:"IA"},{label:"Kansas",value:"KS"},{label:"Kentucky",value:"KY"},{label:"Louisiana",value:"LA"},{label:"Maine",value:"ME"},{label:"Marshall Islands",value:"MH"},{label:"Maryland",value:"MD"},{label:"Massachusetts",value:"MA"},{
label:"Michigan",value:"MI"},{label:"Minnesota",value:"MN"},{label:"Mississippi",value:"MS"},{label:"Missouri",value:"MO"},{label:"Montana",value:"MT"},{label:"Nebraska",value:"NE"},{label:"Nevada",value:"NV"},{label:"New Hampshire",value:"NH"},{label:"New Jersey",value:"NJ"},{label:"New Mexico",value:"NM"},{label:"New York",value:"NY"},{label:"North Carolina",value:"NC"},{label:"North Dakota",value:"ND"},{label:"Northern Mariana Islands",value:"MP"},{label:"Ohio",value:"OH"},{label:"Oklahoma",value:"OK"},{label:"Oregon",value:"OR"},{label:"Palau",value:"PW"},{label:"Pennsylvania",value:"PA"},{label:"Puerto Rico",value:"PR"},{label:"Rhode Island",value:"RI"},{label:"South Carolina",value:"SC"},{label:"South Dakota",value:"SD"},{label:"Tennessee",value:"TN"},{label:"Texas",value:"TX"},{label:"Utah",value:"UT"},{label:"Vermont",value:"VT"},{label:"Virgin Islands",value:"VI"},{label:"Virginia",value:"VA"},{label:"Washington",value:"WA"},{label:"West Virginia",value:"WV"},{
label:"Wisconsin",value:"WI"},{label:"Wyoming",value:"WY"}]},530853:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(667294);var a=[];function l(e,n){var t=(0,r.useRef)(),l=(0,r.useRef)(a);if(l.current===a){t.current=e();l.current=n}else if(!function(e,n){if(e.length!==n.length)return!1;for(var t=0;t<n.length&&t<e.length;t++)if(!Object.is(e[t],n[t]))return!1;return!0}(n,l.current)){t.current=e();l.current=n}return t.current}}}]);
//# sourceMappingURL=baeb09fe54bed6597970.js.map