"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[33166],{633166:(e,n,r)=>{r.r(n);r.d(n,{default:()=>x});var t=r(785893),l=r(667294),a=r(294184),o=r.n(a),i=r(202351),u=r(281110),s=r(945460),c=r(736818),d=r(21372),f=r(567403),N=r(682776),h=r(473903),v=r(652591),p=r(749565),b=r(2590),m=r(473708),y=r(509433),g=r.n(y);function A(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}function E(e,n,r,t,l,a,o){try{var i=e[a](o),u=i.value}catch(e){r(e);return}i.done?n(u):Promise.resolve(u).then(t,l)}function C(e,n,r){n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r;return e}function M(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var t,l,a=[],o=!0,i=!1;try{for(r=r.call(e);!(o=(t=r.next()).done);o=!0){a.push(t.value);if(n&&a.length===n)break}}catch(e){i=!0
;l=e}finally{try{o||null==r.return||r.return()}finally{if(i)throw l}}return a}}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return A(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var k=function(e,n){var r,t,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,t&&(l=2&a[0]?t.return:a[0]?t.throw||((l=t.return)&&l.call(t),
0):t.next)&&!(l=l.call(t,a[1])).done)return l;(t=0,l)&&(a=[2&a[0],l.value]);switch(a[0]){case 0:case 1:l=a;break;case 4:o.label++;return{value:a[1],done:!1};case 5:o.label++;t=a[1];a=[0];continue;case 7:a=o.ops.pop();o.trys.pop();continue;default:if(!(l=o.trys,l=l.length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1];l=a;break}if(l&&o.label<l[2]){o.label=l[2];o.ops.push(a);break}l[2]&&o.ops.pop();o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e];t=0}finally{r=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};function I(e){var n=e.disabled,r=void 0!==n&&n,a=e.user,i=e.setNickname,u=e.nickname,d=e.error,f=e.hasNick,N=l.useRef(null),h=l.useCallback((function(){var e;i("");null===(e=N.current)||void 0===e||e.focus()}),[i]);return(0,t.jsxs)(t.Fragment,{children:[r||null==a||a.id===c.default.getId()?null:(0,t.jsx)(s.Card,{type:s.Card.Types.WARNING,
className:g().card,children:(0,t.jsx)(s.Text,{className:g().warning,variant:"text-md/normal",children:m.Z.Messages.CHANGE_NICKNAME_WARNING})}),(0,t.jsx)(s.FormTitle,{className:o()(g().itemGroup,C({},g().disabled,r)),children:r?m.Z.Messages.CHANGE_IDENTITY_MODAL_CHANGE_NICKNAME_DISABLED:m.Z.Messages.NICKNAME}),(0,t.jsx)(s.TextInput,{disabled:r,inputRef:N,maxLength:b.l$U,value:u,placeholder:p.ZP.getName(a),onChange:i,autoFocus:!0}),null!=d?(0,t.jsx)(s.Text,{variant:"text-xs/normal",color:"text-danger",className:g().nickError,children:d}):null,f&&!r?(0,t.jsx)(s.Button,{look:s.Button.Looks.LINK,color:s.Button.Colors.LINK,size:s.Button.Sizes.NONE,onClick:h,className:g().reset,children:m.Z.Messages.RESET_NICKNAME}):null]})}const x=function(e){var n,r=e.transitionState,a=e.user,o=e.guildId,c=e.onClose,p=e.analyticsSource,y=(0,i.e7)([d.ZP],(function(){return null!=o?d.ZP.getMember(o,a.id):null})),A=(0,i.e7)([N.Z,h.default,f.Z],(function(){var e,n=f.Z.getGuild(o)
;return null!=n&&((null===(e=h.default.getCurrentUser())||void 0===e?void 0:e.id)===a.id?N.Z.can(b.Plq.CHANGE_NICKNAME,n)||N.Z.can(b.Plq.MANAGE_NICKNAMES,n):N.Z.canManageUser(b.Plq.MANAGE_NICKNAMES,a.id,n))})),C=M(l.useState(!1),2),x=C[0],_=C[1],S=M(l.useState(null!==(n=null==y?void 0:y.nick)&&void 0!==n?n:""),2),Z=S[0],j=S[1],w=M(l.useState({}),2),G=w[0],T=w[1];l.useEffect((function(){v.default.track(b.rMx.OPEN_MODAL,{type:"Change Server Identity",location:b.ZY5.GUILD_CHANNEL,source:p})}),[]);var L,R,D=l.useCallback((R=(L=function(e){var n,r,t,l,i,s,d,f,N,h,v,p,g;return k(this,(function(A){switch(A.label){case 0:e.preventDefault();n=null;Z!==(null!==(r=null==y?void 0:y.nick)&&void 0!==r?r:"")&&((n=null!=n?n:{}).nick=Z);if(null==n){c();return[2]}A.label=1;case 1:A.trys.push([1,3,,4]);_(!0);return[4,u.Z.patch({url:b.ANM.GUILD_MEMBER(o,a.id),body:n})];case 2:A.sent();c();return[3,4];case 3:t=A.sent();_(!1)
;null!=(null==(d=null!==(s=null===(l=t.body)||void 0===l?void 0:l.errors)&&void 0!==s?s:null)?void 0:d.nick)?i=(null===(f=d.nick)||void 0===f||null===(N=f._errors)||void 0===N||null===(h=N[0])||void 0===h?void 0:h.message)||m.Z.Messages.CHANGE_IDENTITY_MODAL_UNKNOWN_ERROR:null!=(null==d?void 0:d.username)&&(i=(null===(v=d.username)||void 0===v||null===(p=v._errors)||void 0===p||null===(g=p[0])||void 0===g?void 0:g.message)||m.Z.Messages.CHANGE_IDENTITY_MODAL_UNKNOWN_ERROR);T({nick:i});return[3,4];case 4:return[2]}}))},function(){var e=this,n=arguments;return new Promise((function(r,t){var l=L.apply(e,n);function a(e){E(l,r,t,a,o,"next",e)}function o(e){E(l,r,t,a,o,"throw",e)}a(void 0)}))}),function(e){return R.apply(this,arguments)}),[o,Z,c,a,y]);return(0,t.jsx)(s.ModalRoot,{"aria-label":m.Z.Messages.CHANGE_IDENTITY,transitionState:r,children:(0,t.jsxs)("form",{onSubmit:D,children:[(0,t.jsx)(s.ModalHeader,{separator:!1,children:(0,t.jsx)(s.Heading,{variant:"heading-lg/semibold",
children:m.Z.Messages.CHANGE_NICKNAME})}),(0,t.jsx)(s.ModalContent,{className:g().modalContent,children:(0,t.jsx)(I,{disabled:!A,user:a,error:G.nick,nickname:Z,setNickname:j,hasNick:null!=(null==y?void 0:y.nick)})}),(0,t.jsxs)(s.ModalFooter,{children:[(0,t.jsx)(s.Button,{type:"submit",disabled:x,children:m.Z.Messages.SAVE}),(0,t.jsx)(s.Button,{onClick:c,look:s.Button.Looks.LINK,color:s.Button.Colors.PRIMARY,children:m.Z.Messages.CANCEL})]})]})})}}}]);
//# sourceMappingURL=b44087cb46b6c7af0aef.js.map