"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[57731],{395951:(e,t,n)=>{n.d(t,{FD:()=>A,Zy:()=>N,ss:()=>y,S2:()=>v,Mn:()=>R,ol:()=>b,V3:()=>U,I5:()=>m,OZ:()=>O,cV:()=>I,b9:()=>Z,si:()=>w,W3:()=>M,P6:()=>D,_V:()=>P});var r=n(675860),o=n(444450),a=n(338093),s=n(173436),i=n(655695),l=n(932847),u=n(917870),c=n(301513),p=n(742269),d=n(461061),_=n(959797);function f(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){n(e);return}i.done?t(l):Promise.resolve(l).then(r,o)}function E(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function s(e){f(a,r,o,s,i,"next",e)}function i(e){f(a,r,o,s,i,"throw",e)}s(void 0)}))}}function S(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function T(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n)
;"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){S(e,t,n[t])}))}return e}var h=function(e,t){var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;(r=0,o)&&(a=[2&a[0],o.value]);switch(a[0]){case 0:case 1:o=a;break;case 4:s.label++;return{value:a[1],done:!1};case 5:s.label++;r=a[1];a=[0];continue;case 7:a=s.ops.pop();s.trys.pop();continue;default:if(!(o=s.trys,o=o.length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}
if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1];o=a;break}if(o&&s.label<o[2]){s.label=o[2];s.ops.push(a);break}o[2]&&s.ops.pop();s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e];r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};function A(){s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_INIT"})}function N(){s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_CLOSE"})}function y(e,t){var n=t?_.Z.Messages.DELETE_ACCOUNT:_.Z.Messages.DISABLE_ACCOUNT,o=t?d.ANM.DELETE_ACCOUNT:d.ANM.DISABLE_ACCOUNT;return(0,c.Z)((function(t){return r.Z.post({url:o,body:T({password:e},t),oldFormErrors:!0})}),{modalProps:{title:n},checkEnabled:!1}).then((function(){s.Z.dispatch({type:"LOGOUT"});(0,i.uL)(d.Z5c.DEFAULT_LOGGED_OUT)}))}function v(e){return C.apply(this,arguments)}function C(){return(C=E((function(e){var t,n,o;return h(this,(function(a){switch(a.label){case 0:return[4,r.Z.patch({url:d.ANM.ME,body:e,oldFormErrors:!0})]
;case 1:t=a.sent();if((n=t.body).token){o=n.token;delete n.token;s.Z.dispatch({type:"UPDATE_TOKEN",token:o,userId:n.id});null!=(null==e?void 0:e.password)&&null!=(null==e?void 0:e.new_password)&&s.Z.dispatch({type:"PASSWORD_UPDATED",userId:n.id})}s.Z.dispatch({type:"CURRENT_USER_UPDATE",user:n});return[2,t]}}))}))).apply(this,arguments)}function R(e){var t=e.username,n=e.discriminator,r=e.email,a=e.emailToken,i=e.password,f=e.avatar,E=e.avatarDecoration,S=e.newPassword,h=e.displayName;s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_SUBMIT"});return(0,c.Z)((function(e){var s=T({username:t,email:r,email_token:a,password:i,avatar:f,discriminator:n,display_name:h,new_password:S},e);void 0!==E&&(null==E?s.avatar_decoration_preset=null:E.isCustom?s.avatar_decoration=E.data:s.avatar_decoration_preset=E.name);var l=o.Z.get(d.JkL),u=(0,p.xJ)();if(null!=u&&null!=l){s.push_provider=u;s.push_token=l}var c=o.Z.get(d.scU);if(null!=d.mvA&&null!=c){s.push_voip_provider=d.mvA;s.push_voip_token=c}return v(s)
}),{checkEnabled:!1,modalProps:{title:_.Z.Messages.TWO_FA_CHANGE_ACCOUNT},hooks:{onEarlyClose:function(){return s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_SUBMIT_FAILURE",errors:{}})}}}).then((function(e){var t=e.body;l.default.track(d.rMx.USER_AVATAR_UPDATED,{animated:(0,u.xR)(t.avatar)});s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_SUBMIT_SUCCESS"});return e}),(function(e){s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_SUBMIT_FAILURE",errors:e.body});return e}))}function b(){return r.Z.get({url:d.ANM.USER_HARVEST,oldFormErrors:!0})}function U(){return r.Z.post({url:d.ANM.USER_HARVEST,oldFormErrors:!0})}function m(e){s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_SET_PENDING_AVATAR",avatar:e});null==e?a.uv.announce(_.Z.Messages.A11Y_ANNOUNCEMENT_AVATAR_NONE):a.uv.announce(_.Z.Messages.A11Y_ANNOUNCEMENT_AVATAR_CHANGED)}function O(e){s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_SET_PENDING_DISPLAY_NAME",displayName:e})}function I(e){s.Z.dispatch({
type:"USER_SETTINGS_ACCOUNT_SET_PENDING_AVATAR_DECORATION",avatarDecoration:e})}function Z(){s.Z.dispatch({type:"USER_SETTINGS_CLEAR_ERRORS"})}function w(){s.Z.dispatch({type:"USER_SETTINGS_RESET_PENDING_ACCOUNT_CHANGES"})}function M(){s.Z.dispatch({type:"USER_SETTINGS_RESET_ALL_PENDING"})}function D(){s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_RESET_AND_CLOSE_FORM"})}function P(e){s.Z.dispatch({type:"USER_SETTINGS_ACCOUNT_SET_DISABLE_SUBMIT",disable:e})}},57731:(e,t,n)=>{n.r(t);n.d(t,{default:()=>v});var r=n(785893),o=n(667294),a=n(363010),s=n(331535),i=n(395951),l=n(493925),u=n(462428),c=n(67416),p=n(429244),d=n(461061),_=n(86030),f=n(959797),E=n(843204),S=n.n(E);function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t,n,r,o,a,s){try{var i=e[a](s),l=i.value}catch(e){n(e);return}i.done?t(l):Promise.resolve(l).then(r,o)}function A(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){
var a=e.apply(t,n);function s(e){h(a,r,o,s,i,"next",e)}function i(e){h(a,r,o,s,i,"throw",e)}s(void 0)}))}}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a=[],s=!0,i=!1;try{for(n=n.call(e);!(s=(r=n.next()).done);s=!0){a.push(r.value);if(t&&a.length===t)break}}catch(e){i=!0;o=e}finally{try{s||null==n.return||n.return()}finally{if(i)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return T(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return T(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var y=function(e,t){
var n,r,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;(r=0,o)&&(a=[2&a[0],o.value]);switch(a[0]){case 0:case 1:o=a;break;case 4:s.label++;return{value:a[1],done:!1};case 5:s.label++;r=a[1];a=[0];continue;case 7:a=s.ops.pop();s.trys.pop();continue;default:if(!(o=s.trys,o=o.length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1];o=a;break}if(o&&s.label<o[2]){s.label=o[2];s.ops.push(a);break}o[2]&&s.ops.pop();s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e];r=0}finally{n=o=0}if(5&a[0])throw a[1]
;return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};function v(e){var t,n,E,T,h=e.transitionState,v=e.onSuccess,C=e.onClose,R=e.requirementsUpdated,b=e.noSkip,U=void 0!==b&&b,m=N(o.useState(""),2),O=m[0],I=m[1],Z=N(o.useState(""),2),w=Z[0],M=Z[1],D=N(o.useState(""),2),P=D[0],g=D[1],x=N(o.useState(null),2),k=x[0],G=x[1],L=N(o.useState(null),2),j=L[0],F=L[1],B=(0,a.e7)([l.Z],(function(){return l.Z.getErrors()})),W=(0,a.e7)([l.Z],(function(){return l.Z.getFormState()})),z=o.useRef(null);o.useEffect((function(){if(h===_.Dv.ENTERED){var e;null===(e=z.current)||void 0===e||e.focus()}}),[h]);function V(){V=A((function(e){var t,n,r;return y(this,(function(o){switch(o.label){case 0:e.preventDefault();(0,i.b9)();t=!1;if(""===w){G(f.Z.Messages.PASSWORD_REQUIREMENTS_EMPTY);t=!0}else G(null);if(w!==P){F(f.Z.Messages.FORM_LABEL_NEW_PASSWORD_MISMATCH);t=!0}else F(null);return t?[2]:[4,(0,i.Mn)({password:O,newPassword:w})];case 1:
(null==(n=o.sent())?void 0:n.ok)?v():null!=(null==n||null===(r=n.body)||void 0===r?void 0:r.username)&&(0,p.P)();return[2]}}))}));return V.apply(this,arguments)}return(0,r.jsxs)(c.Y0,{transitionState:h,children:[(0,r.jsxs)(c.xB,{separator:!1,className:S().header,children:[(0,r.jsx)(u.Z,{color:u.Z.Colors.HEADER_PRIMARY,size:u.Z.Sizes.SIZE_24,className:S().title,children:f.Z.Messages.UPDATE_PASSWORD}),(0,r.jsx)(s.xv,{color:"header-secondary",variant:"text-md/normal",className:S().subtitle,children:R?f.Z.Messages.FORCE_PASSWORD_UPDATE_DESCRIPTION:f.Z.Messages.USER_SETTINGS_ACCOUNT_CHANGE_PASSWORD_PROMPT_DESKTOP}),!0!==U&&(0,r.jsx)(c.ol,{onClick:C,className:S().modalCloseButton})]}),(0,r.jsxs)("form",{onSubmit:function(e){return V.apply(this,arguments)},children:[(0,r.jsxs)(c.hz,{className:S().content,children:[(0,r.jsx)(s.xJ,{title:f.Z.Messages.FORM_LABEL_CURRENT_PASSWORD,error:null==B||null===(t=B.password)||void 0===t?void 0:t[0],children:(0,r.jsx)(s.oi,{type:"password",value:O,
onChange:I,inputRef:z})}),(0,r.jsx)(s.xJ,{className:S().newPassword,title:f.Z.Messages.FORM_LABEL_NEW_PASSWORD,error:null!==(T=null!==(E=null==B||null===(n=B.new_password)||void 0===n?void 0:n[0])&&void 0!==E?E:k)&&void 0!==T?T:void 0,children:(0,r.jsx)(s.oi,{type:"password",value:w,onChange:M})}),(0,r.jsx)(s.xJ,{className:S().newPassword,title:f.Z.Messages.FORM_LABEL_CONFIRM_NEW_PASSWORD,error:null!=j?j:void 0,children:(0,r.jsx)(s.oi,{type:"password",value:P,onChange:g})})]}),(0,r.jsxs)(c.mz,{children:[(0,r.jsx)(s.zx,{type:"submit",color:s.zx.Colors.BRAND,size:s.zx.Sizes.MEDIUM,submitting:W===d.QZA.SUBMITTING,children:f.Z.Messages.DONE}),!0!==U&&(0,r.jsx)(s.zx,{className:S().cancel,look:s.zx.Looks.LINK,color:s.zx.Colors.PRIMARY,onClick:C,children:f.Z.Messages.CANCEL})]})]})]})}},429244:(e,t,n)=>{n.d(t,{P:()=>s});var r=n(112712),o=n(911324),a=n(959797);function s(){(0,o.CF)((0,r.Yz)(a.Z.Messages.USER_SETTINGS_UPDATE_FAILURE,r.pC.FAILURE))}}}]);
//# sourceMappingURL=22279361ce3718c6f636.js.map