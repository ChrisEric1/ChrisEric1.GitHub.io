"use strict";(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[64873],{964873:(e,n,t)=>{t.r(n);t.d(n,{default:()=>G});var r=t(785893),l=t(667294),a=t(294184),o=t.n(a),i=t(363010),s=t(331535),c=t(173436),u=t(160156),d=t(53211),h=t(808525),f=t(356004),p=t(1812),g=t(653772),m=t(940712),b=t(105405),O=t(379822),v=t(859023),y=t(969225),x=t(272729),_=t(555784),L=t(67416),M=t(897576),j=t(932847),w=t(461061),C=t(959797),I=t(705143),N=t.n(I);function Z(e,n,t,r,l,a,o){try{var i=e[a](o),s=i.value}catch(e){t(e);return}i.done?n(s):Promise.resolve(s).then(r,l)}function F(e){return function(){var n=this,t=arguments;return new Promise((function(r,l){var a=e.apply(n,t);function o(e){Z(a,r,l,o,i,"next",e)}function i(e){Z(a,r,l,o,i,"throw",e)}o(void 0)}))}}function S(e,n,t){n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t;return e}function E(e){E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){
return e.__proto__||Object.getPrototypeOf(e)};return E(e)}function A(e,n){return!n||"object"!==P(n)&&"function"!=typeof n?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):n}function D(e,n){D=Object.setPrototypeOf||function(e,n){e.__proto__=n;return e};return D(e,n)}var P=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function T(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var t,r=E(e);if(n){var l=E(this).constructor;t=Reflect.construct(r,arguments,l)}else t=r.apply(this,arguments);return A(this,t)}}var k=function(e,n){var t,r,l,a,o={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return a={next:i(0),
throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(l=2&a[0]?r.return:a[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,a[1])).done)return l;(r=0,l)&&(a=[2&a[0],l.value]);switch(a[0]){case 0:case 1:l=a;break;case 4:o.label++;return{value:a[1],done:!1};case 5:o.label++;r=a[1];a=[0];continue;case 7:a=o.ops.pop();o.trys.pop();continue;default:if(!(l=o.trys,l=l.length>0&&l[l.length-1])&&(6===a[0]||2===a[0])){o=0;continue}if(3===a[0]&&(!l||a[1]>l[0]&&a[1]<l[3])){o.label=a[1];break}if(6===a[0]&&o.label<l[1]){o.label=l[1];l=a;break}if(l&&o.label<l[2]){o.label=l[2];o.ops.push(a);break}l[2]&&o.ops.pop();o.trys.pop();continue}a=n.call(e,o)}catch(e){a=[6,e];r=0}finally{t=l=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}};var R=function(e){!function(e,n){
if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}});n&&D(e,n)}(a,e);var n=T(a);function a(e){!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,a);var l;(l=n.call(this,e)).handleGuildSelect=function(e){var n=l.props.guilds,t=l.state.selectedGuildId,r=n[e].channels,a=l.getDefaultChannelId(r);t!==e&&l.setState({selectedGuildId:e,selectedChannelId:a,channels:r})};l.handleChannelSelect=function(e){l.setState({selectedChannelId:e})};l.handleFollow=function(){var e=l.props,n=e.channel,a=e.onClose,o=l.state,i=o.selectedChannelId,s=o.selectedGuildId;if(null!=i){l.setState({submitting:!0});u.Z.createChannelFollower(i,n.id).then((function(){c.Z.dispatch({type:"CHANNEL_FOLLOWER_CREATED",channelId:i,guildId:s});a();(0,M.ZD)(F((function(){var e,n;return k(this,(function(l){switch(l.label){case 0:
return[4,Promise.all([t.e(40532),t.e(63617)]).then(t.bind(t,263617))];case 1:e=l.sent(),n=e.default;return[2,function(e){return(0,r.jsx)(n,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{},r=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))));r.forEach((function(n){S(e,n,t[n])}))}return e}({},e))}]}}))})))})).catch((function(e){e.body.code===w.evJ.TOO_MANY_WEBHOOKS?l.setState({errorMessage:C.Z.Messages.FOLLOW_MODAL_TOO_MANY_WEBHOOKS,submitting:!1}):l.setState({errorMessage:C.Z.Messages.FOLLOW_MODAL_FAIL,submitting:!1})}))}};var o=e.guilds,i=e.lastChannelFollowingDestination,s=i.guildId,d=i.channelId;l.state={selectedGuildId:s,selectedChannelId:d,channels:null!=s&&null!=o[s]?o[s].channels:[],errorMessage:null,submitting:!1,headerId:(0,x.hQ)("modal")};return l}var i=a.prototype;i.componentDidMount=function(){
j.default.track(w.rMx.OPEN_MODAL,{type:"Follow Channel Modal",num_guild_permissions:Object.keys(this.props.guilds).length,location:"Chat Input Blocker - Follow Channel"})};i.getDefaultChannelId=function(e){var n=e.find((function(e){var n=e.channel;return"general"===(0,d.F6)(n,v.default,b.Z)})),t=null!=n?n:e[0];return null!=t?t.channel.id:null};i.renderFooter=function(){var e=this.state,n=e.selectedGuildId,t=e.selectedChannelId,a=e.submitting,o=this.props.onClose;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(s.zx,{submitting:a,onClick:this.handleFollow,disabled:null==n||null==t,children:C.Z.Messages.FOLLOW}),(0,r.jsx)(s.zx,{look:s.zx.Looks.LINK,color:s.zx.Colors.PRIMARY,onClick:o,children:C.Z.Messages.CANCEL})]})};i.renderForm=function(){var e=this.props.guilds,n=this.state,t=n.channels,a=n.selectedGuildId,o=n.selectedChannelId,i=n.errorMessage,c=Object.keys(e).map((function(n){var t=e[n].guild;return{value:n,label:t.toString(),guild:t}})),u=t.map((function(e){
var n=e.channel,t=e.category;return{value:n.id,label:(0,d.F6)(n,v.default,b.Z),channel:n,category:t}})),f=0===c.length,p=f?C.Z.Messages.FOLLOW_MODAL_HINT_NO_PERMS:C.Z.Messages.FOLLOW_MODAL_HINT;return(0,r.jsxs)(l.Fragment,{children:[(0,r.jsx)(s.xJ,{className:N().bottomMargin,title:C.Z.Messages.FORM_LABEL_SEND_TO,children:(0,r.jsx)(s.Vc,{value:a,options:c,isDisabled:f,onChange:this.handleGuildSelect,renderOptionPrefix:function(e){return function(e){if(null==e)return null;var n=e.guild;return(0,r.jsx)(y.Z,{guild:n,size:y.Z.Sizes.MINI})}(e)}})}),(0,r.jsx)(s.xJ,{className:N().bottomMargin,title:C.Z.Messages.FORM_LABEL_SELECT_CHANNEL,children:(0,r.jsx)(s.Vc,{value:o,options:u,isDisabled:0===u.length,onChange:this.handleChannelSelect,renderOptionPrefix:function(e){return function(e){if(null==e)return null;var n=e.channel,t=(0,h.KS)(n);return null!=t&&(0,r.jsx)(t,{width:16,height:16,className:N().icon})}(e)}})}),(0,r.jsx)(s.xv,{variant:"text-sm/normal",
color:f||null!=i?"text-danger":"text-muted",className:N().bottomMargin,children:null!=i?i:p})]})};i.renderBody=function(){var e=this.props.channel.nsfw;return(0,r.jsxs)("div",{className:N().body,children:[(0,r.jsx)(s.X6,{variant:"heading-lg/semibold",id:this.state.headerId,children:C.Z.Messages.FOLLOW_MODAL_TITLE}),(0,r.jsx)(s.xv,{color:"text-muted",className:o()(N().topMargin,S({},N().formMargin,!e)),variant:"text-sm/normal",children:C.Z.Messages.FOLLOW_MODAL_BODY}),e?(0,r.jsx)(s.xv,{className:o()(N().formMargin,N().topMargin),color:"text-danger",variant:"text-sm/normal",children:C.Z.Messages.FOLLOW_MODAL_WARNING}):null]})};i.renderHeader=function(){var e,n=this.props,t=n.guildToFollow,l=n.channelNameToFollow,a=n.channel,o=null!==(e=(0,h.KS)(a))&&void 0!==e?e:_.Z;return(0,r.jsxs)(L.xB,{className:N().header,children:[(0,r.jsx)(y.Z,{guild:t,size:y.Z.Sizes.LARGE}),(0,r.jsx)("div",{className:N().channelContainer,children:(0,r.jsxs)("div",{className:N().channel,children:[(0,r.jsx)(o,{
width:20,height:20,className:N().channelIcon}),(0,r.jsx)(s.xv,{variant:"text-md/medium",className:N().channelName,children:l})]})})]})};i.render=function(){var e=this.props.transitionState;return(0,r.jsxs)(L.Y0,{transitionState:e,"aria-labelledby":this.state.headerId,children:[this.renderHeader(),(0,r.jsxs)(L.hz,{className:N().content,children:[this.renderBody(),this.renderForm()]}),(0,r.jsx)(L.mz,{children:this.renderFooter()})]})};return a}(l.PureComponent);const G=i.ZP.connectStores([g.Z,f.Z,p.ZP,m.Z,O.Z],(function(e){var n=e.channel,t=g.Z.getGuild(n.guild_id),r=Object.values(g.Z.getGuilds()).reduce((function(e,n){var t=p.ZP.getChannels(n.id).SELECTABLE.map((function(e){return e.channel})).filter((function(e){return e.type===w.d4z.GUILD_TEXT&&m.Z.can(w.Plq.MANAGE_WEBHOOKS,e)})).map((function(e){var n=f.Z.getChannel(e.parent_id);return{channel:e,category:null!=n?n.name:null}}));t.length>0&&(e[n.id]={guild:n,channels:t});return e}),{}),l=O.Z.getLastChannelFollowingDestination()
;return{guildToFollow:t,channelNameToFollow:n.name,guilds:r,lastChannelFollowingDestination:null!=l?l:{}}}),{forwardRef:!0})(R)}}]);
//# sourceMappingURL=801c29a15ec831c49380.js.map