/*! For license information please see fc075577baa56cd62cce.js.LICENSE.txt */
(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[86651],{178598:function(e,t,n){var r,o=o||function(e){"use strict";if("undefined"==typeof navigator||!/MSIE [1-9]\./.test(navigator.userAgent)){var t=e.document,n=function(){return e.URL||e.webkitURL||e},r=t.createElementNS("http://www.w3.org/1999/xhtml","a"),o="download"in r,i=/Version\/[\d\.]+.*Safari/.test(navigator.userAgent),a=e.webkitRequestFileSystem,s=e.requestFileSystem||a||e.mozRequestFileSystem,c=function(t){(e.setImmediate||e.setTimeout)((function(){throw t}),0)},l="application/octet-stream",u=0,f=function(e){setTimeout((function(){"string"==typeof e?n().revokeObjectURL(e):e.remove()}),4e4)},d=function(e,t,n){for(var r=(t=[].concat(t)).length;r--;){var o=e["on"+t[r]];if("function"==typeof o)try{o.call(e,n||e)}catch(e){c(e)}}},p=function(e){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["ï»¿",e],{type:e.type}):e},h=function(t,c,h){h||(t=p(t))
;var S,y,b,O=this,m=t.type,_=!1,M=function(){d(O,"writestart progress write writeend".split(" "))},v=function(){if(y&&i&&"undefined"!=typeof FileReader){var r=new FileReader;r.onloadend=function(){var e=r.result;y.location.href="data:attachment/file"+e.slice(e.search(/[,;]/));O.readyState=O.DONE;M()};r.readAsDataURL(t);O.readyState=O.INIT}else{!_&&S||(S=n().createObjectURL(t));if(y)y.location.href=S;else{void 0===e.open(S,"_blank")&&i&&(e.location.href=S)}O.readyState=O.DONE;M();f(S)}},g=function(e){return function(){if(O.readyState!==O.DONE)return e.apply(this,arguments)}},w={create:!0,exclusive:!1};O.readyState=O.INIT;c||(c="download");if(o){S=n().createObjectURL(t);setTimeout((function(){r.href=S;r.download=c;e=r,t=new MouseEvent("click"),e.dispatchEvent(t);var e,t;M();f(S);O.readyState=O.DONE}))}else{if(e.chrome&&m&&m!==l){b=t.slice||t.webkitSlice;t=b.call(t,0,t.size,l);_=!0}a&&"download"!==c&&(c+=".download");(m===l||a)&&(y=e);if(s){u+=t.size;s(e.TEMPORARY,u,g((function(e){
e.root.getDirectory("saved",w,g((function(e){var n=function(){e.getFile(c,w,g((function(e){e.createWriter(g((function(n){n.onwriteend=function(t){y.location.href=e.toURL();O.readyState=O.DONE;d(O,"writeend",t);f(e)};n.onerror=function(){var e=n.error;e.code!==e.ABORT_ERR&&v()};"writestart progress write abort".split(" ").forEach((function(e){n["on"+e]=O["on"+e]}));n.write(t);O.abort=function(){n.abort();O.readyState=O.DONE};O.readyState=O.WRITING})),v)})),v)};e.getFile(c,{create:!1},g((function(e){e.remove();n()})),g((function(e){e.code===e.NOT_FOUND_ERR?n():v()})))})),v)})),v)}else v()}},S=h.prototype;if("undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob)return function(e,t,n){n||(e=p(e));return navigator.msSaveOrOpenBlob(e,t||"download")};S.abort=function(){var e=this;e.readyState=e.DONE;d(e,"abort")};S.readyState=S.INIT=0;S.WRITING=1;S.DONE=2;S.error=S.onwritestart=S.onprogress=S.onwrite=S.onabort=S.onerror=S.onwriteend=null;return function(e,t,n){return new h(e,t,n)}}
}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);e.exports?e.exports.saveAs=o:null!==n.amdD&&null!==n.amdO&&void 0!==(r=function(){return o}.apply(t,[]))&&(e.exports=r)},322837:(e,t,n)=>{"use strict";n.d(t,{Z:()=>p});var r=n(667294),o=n(178598),i=n(306472),a=n(120415);function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function c(e){c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return c(e)}function l(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e,t){u=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return u(e,t)}var f=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1
;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return l(this,n)}}var p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&u(e,t)}(n,e);var t=d(n);function n(){s(this,n);var e;(e=t.apply(this,arguments)).handleFileDownload=function(t){t.preventDefault();var n=e.getFileContents(),r=e.props,o=r.fileName,i=r.onDownload;a.FB?e.downloadNative(n,o):e.downloadHtml5(n,o);null==i||i()};return e}var c=n.prototype;c.getFileContents=function(){var e=this.props.fileContents;"function"==typeof e&&(e=e());return e};c.downloadNative=function(e,t){
i.Z.fileManager.saveWithDialog(e,t)};c.downloadHtml5=function(e,t){var n=new Blob([e],{type:this.props.contentType});(0,o.saveAs)(n,t)};c.render=function(){var e=this.props.children,t=r.Children.only(e);return r.cloneElement(t,{onClick:this.handleFileDownload})};return n}(r.Component)},286651:(e,t,n)=>{"use strict";n.r(t);n.d(t,{default:()=>T});var r=n(785893),o=n(667294),i=n(441143),a=n.n(i),s=n(202351),c=n(945460),l=n(130671),u=n(322837),f=n(411177),d=n(883064),p=n(426797),h=n(694444),S=n(473903),y=n(107364),b=n(975651),O=n(2590),m=n(58118),_=n(473708),M=n(201744),v=n.n(M);function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function w(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function E(e){E=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)};return E(e)}function A(e){for(var t=1;t<arguments.length;t++){
var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){w(e,t,n[t])}))}return e}function C(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function x(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||(o[n]=e[n])}return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e)
;for(r=0;r<i.length;r++){n=i[r];t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}}return o}function N(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e,t){j=Object.setPrototypeOf||function(e,t){e.__proto__=t;return e};return j(e,t)}var R=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})));return!0}catch(e){return!1}}();return function(){var n,r=E(e);if(t){var o=E(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return N(this,n)}}var F=function(e){
var t=e.label,n=e.text,o=e.children,i=x(e,["label","text","children"]);return(0,r.jsxs)(y.Z,C(A({direction:y.Z.Direction.VERTICAL},i),{children:[(0,r.jsx)(c.FormTitle,{tag:"h2",children:t}),null!=n?(0,r.jsx)(c.Text,{variant:"text-md/normal",className:v().sectionBody,children:n}):null,(0,r.jsx)(y.Z.Child,{wrap:!0,children:o})]}))},B=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});t&&j(e,t)}(n,e);var t=D(n);function n(){g(this,n);var e;(e=t.apply(this,arguments)).state={didAddBackup:!1,showConfirmModal:!1};e.handleCloseModal=function(){var t=e.props,n=t.onClose,r=t.currentUser,o=e.state.didAddBackup,i=r.hasFlag(O.xW$.MFA_SMS);o||i?null==n||n():e.setState({showConfirmModal:!0})};e.getDownloadFileContents=function(){var t=e.props.backupCodes.map((function(e){var t=e.consumed,n=e.code
;return"* ".concat(n.substr(0,4),"-").concat(n.substr(4)," ").concat(t?"(".concat(_.Z.Messages.TWO_FA_BACKUP_CODE_USED,")"):"")})).join("\r\n"),n=_.Z.Messages.TWO_FA_DISCORD_BACKUP_CODES.format({email:e.props.currentUser.email});return"".concat(n,"\r\n\r\n").concat(t)};e.handleChangePhoneNumber=function(){e.openPhoneVerificationModal()};e.handleEnableSMS=function(){var t=function(){(0,c.openModal)((function(t){return(0,r.jsx)(b.default,C(A({},t),{handleSubmit:function(t){e.setState({didAddBackup:!0});return l.Z.enableSMS(t)},title:_.Z.Messages.MFA_SMS_ENABLE}))}))};null==e.props.currentUser.phone?e.openPhoneVerificationModal({onAddedPhone:t}):t()};return e}var o=n.prototype;o.renderSMSSection=function(){var e=this.props.currentUser,t=null!=this.props.currentUser.phone,n=e.hasFlag(O.xW$.MFA_SMS),o=e.hasFlag(O.xW$.PARTNER)||e.hasFlag(O.xW$.STAFF);return t?(0,r.jsxs)(F,{label:_.Z.Messages.MFA_SMS_ENABLE,text:_.Z.Messages.MFA_SMS_AUTH_SALES_PITCH,children:[(0,r.jsxs)(c.Text,{
variant:"text-md/normal",className:v().sectionBody,children:[(0,r.jsx)("strong",{className:v().phoneNumber,children:_.Z.Messages.MFA_SMS_AUTH_CURRENT_PHONE.format({phoneNumber:e.phone})}),(0,r.jsx)(c.Button,{look:c.Button.Looks.LINK,color:c.Button.Colors.LINK,size:c.Button.Sizes.MIN,className:v().linkButton,onClick:this.handleChangePhoneNumber,children:_.Z.Messages.CHANGE_PHONE_NUMBER})]}),(0,r.jsx)(c.Button,{onClick:this.handleEnableSMS,disabled:n||o,color:c.Button.Colors.GREEN,size:c.Button.Sizes.SMALL,children:o?_.Z.Messages.MFA_SMS_DISABLED_PARTNER:n?_.Z.Messages.MFA_SMS_ALREADY_ENABLED:_.Z.Messages.MFA_SMS_ENABLE})]}):(0,r.jsx)(F,{label:_.Z.Messages.MFA_SMS_ENABLE,text:_.Z.Messages.MFA_SMS_AUTH_SALES_PITCH,children:(0,r.jsx)(c.Button,{onClick:this.handleEnableSMS,color:c.Button.Colors.GREEN,size:c.Button.Sizes.SMALL,disabled:o,children:o?_.Z.Messages.MFA_SMS_DISABLED_PARTNER:_.Z.Messages.MFA_SMS_ADD_PHONE})})};o.renderBackupCodesSection=function(){var e=this;return(0,r.jsx)(F,{
label:_.Z.Messages.TWO_FA_DOWNLOAD_CODES,text:_.Z.Messages.TWO_FA_BACKUP_CODES_WARNING.format(),children:(0,r.jsx)(u.Z,{fileContents:this.getDownloadFileContents,contentType:"text/plain",fileName:"discord_backup_codes.txt",onDownload:function(){return e.setState({didAddBackup:!0})},children:(0,r.jsx)(c.Button,{color:c.Button.Colors.GREEN,size:c.Button.Sizes.SMALL,children:_.Z.Messages.TWO_FA_DOWNLOAD_CODES})})})};o.renderHeader=function(){return(0,r.jsxs)(c.ModalHeader,{separator:!1,children:[(0,r.jsxs)(y.Z.Child,{grow:1,shrink:1,children:[(0,r.jsx)(c.Heading,{variant:"heading-lg/semibold",className:v().header,children:d.Z.parse(_.Z.Messages.TWO_FA_SUCCESS_HEADER)}),(0,r.jsx)(c.Text,{variant:"text-xs/normal",className:v().subHeader,children:_.Z.Messages.MFA_SMS_ENABLE_SHOULD_DO.format()})]}),(0,r.jsx)(y.Z.Child,{grow:0,children:(0,r.jsx)(c.ModalCloseButton,{onClick:this.handleCloseModal})})]})};o.renderConfirmModal=function(){var e=this,t=this.props.onClose;return(0,
r.jsx)(c.DeclarativeConfirmModal,{dismissable:!0,header:_.Z.Messages.TWO_FA_CONFIRM_TITLE,confirmText:_.Z.Messages.TWO_FA_CONFIRM_CONFIRM,cancelText:_.Z.Messages.CANCEL,onCancel:function(){return e.setState({showConfirmModal:!1})},onConfirm:t,children:(0,r.jsx)(c.Text,{variant:"text-md/normal",color:"text-normal",children:_.Z.Messages.TWO_FA_CONFIRM_BODY})})};o.render=function(){var e=this.props.transitionState,t=this.state.showConfirmModal;return(0,r.jsxs)(c.ModalRoot,{transitionState:e,className:v().modal,children:[this.renderHeader(),(0,r.jsxs)(c.ModalContent,{className:v().modalInner,children:[this.renderSMSSection(),(0,r.jsx)(c.FormDivider,{className:v().divider}),this.renderBackupCodesSection()]}),t&&this.renderConfirmModal()]})};o.openPhoneVerificationModal=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,c.openModal)((function(t){return(0,r.jsx)(f.default,A({reason:p.L.MFA_PHONE_UPDATE},t,e))}),{modalKey:m.M})};return n}(o.PureComponent)
;const T=s.ZP.connectStores([S.default,h.Z],(function(){var e=S.default.getCurrentUser();a()(null!=e,"MFAEnableSuccess: currentUser cannot be undefined");return{currentUser:e,backupCodes:h.Z.getBackupCodes()}}))(B)}}]);
//# sourceMappingURL=fc075577baa56cd62cce.js.map