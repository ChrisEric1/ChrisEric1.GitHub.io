(window.webpackJsonp=window.webpackJsonp||[]).push([[187],{1417:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(1)),a=i(r(5)),o=l(r(127)),u=i(r(1282));function i(e){return e&&e.__esModule?e:{default:e}}function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}function l(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var d=function(e){var t,r;function i(){return e.apply(this,arguments)||this}return r=e,(t=i).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,i.prototype.render=function(){var e=this.props,t=e.className,r=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,["className"]);return n.createElement(o.default,p({},r,{className:(0,a.default)(u.default.formStatusAlert,t)}))},i}(n.Component);t.default=d,d.displayName="FormStatusAlert",d.Types=o.AlertTypes},1517:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a=c(r(1)),o=d(r(5)),u=c(r(56)),i=d(r(182)),s=d(r(411)),l=r(18),p=d(r(1317));function d(e){return e&&e.__esModule?e:{default:e}}function f(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return f=function(){return e},e}function c(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=f();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function h(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,u=arguments.length-3;if(t||0===u||(t={children:void 0}),1===u)t.children=a;else if(u>1){for(var i=new Array(u),s=0;s<u;s++)i[s]=arguments[s+3];t.children=i}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function v(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}var m=function(e){function t(t){var r;return(r=e.call(this,t)||this).hasError=function(e){var t=r.props.validator;return null!=t&&!t(e)},r.handleInputBlur=function(e,t){var n=e.currentTarget.value;r.setState({hasError:r.hasError(n)}),r.props.onChange(t,n)},r.handleRemoveClick=function(){var e=r.props,t=e.name;(0,e.onRemove)(t)},r.state={hasError:r.hasError(t.value)},r}return v(t,e),t.prototype.render=function(){var e,t=this.state.hasError,r=this.props,n=r.name,a=r.maxLength,u=r.validator,l=r.value,d=null!=u;return h("div",{className:p.default.inputWrapper},void 0,h(s.default,{className:p.default.input,inputClassName:(0,o.default)((e={},e[p.default.isValid]=d&&l&&!t,e[p.default.hasError]=d&&l&&t,e)),name:n,defaultValue:l,onBlur:this.handleInputBlur,maxLength:a}),h("button",{className:p.default.removeButton,onClick:this.handleRemoveClick,tabIndex:-1,type:"button"},void 0,h(i.default,{className:p.default.removeButtonIcon,name:i.default.Names.CLOSE})))},t}(a.PureComponent);m.displayName="Input";var y=function(e){return{inputs:e.values}},g=function(e){var t=e.split("#")[1];return Number(t)},b=function(e){function t(){for(var t,r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return(t=e.call.apply(e,[this].concat(n))||this).state=y(t.props),t.getButtonText=function(){if(t.state.inputs.length>0)return l.Messages.MultiTextInput.ADD_ANOTHER;var e=t.props.type.substr(0,1).toUpperCase()+t.props.type.substr(1);return l.Messages.MultiTextInput.ADD_ONE.format({name:e})},t.handleAddClick=function(){var e=t.props.onChange,r=[].concat(t.state.inputs,[""]);t.setState({inputs:r}),e&&e(r)},t.handleInputChange=function(e,r){var n=t.props.onChange;if(null!=e){var a=[].concat(t.state.inputs);a[g(e)]=r,t.setState({inputs:a}),n&&n(a)}},t.handleInputRemove=function(e){if(!(t.state.inputs.length<=0)){var r=t.props.onChange,n=[].concat(t.state.inputs);n.splice(g(e),1),t.setState({inputs:n}),r&&r(n)}},t.resetInputFields=function(){t.setState(y(t.props))},t}v(t,e);var r=t.prototype;return r.renderAddAction=function(){var e=this.props.maxCount,t=this.state.inputs;return null!=e&&t.length>=e?null:h(u.default,{height:u.ButtonHeight.MEDIUM,onClick:this.handleAddClick},void 0,this.getButtonText())},r.renderInputFields=function(){var e,t=this,r=this.props,n=r.maxCount,a=r.maxLength,u=r.namePrefix,i=r.type,s=r.validator,l=this.state.inputs;if(0===l.length)return null;var d=l.map(function(e,r){return h(m,{type:i,maxLength:a,name:u+"#"+r,value:e,onChange:t.handleInputChange,onRemove:t.handleInputRemove,validator:s},e+"-"+r)});return h("div",{className:(0,o.default)(p.default.inputsWrapper,(e={},e[p.default.inputsWrapperFlush]=null!=n&&l.length>=n,e))},void 0,d)},r.render=function(){return h("div",{},void 0,this.renderInputFields(),this.renderAddAction())},t}(a.PureComponent);b.displayName="TextboxInputRepeater",b.defaultProps={values:[]};var S=b;t.default=S},1727:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,a=E(r(1)),o=O(r(12)),u=E(r(129)),i=E(r(2367)),s=O(r(128)),l=E(r(408)),p=r(97),d=r(194),f=r(448),c=O(r(414)),h=O(r(409)),v=O(r(1417)),m=O(r(1517)),y=O(r(412)),g=O(r(410)),b=O(r(413)),S=O(r(416)),M=r(3),C=r(18);function O(e){return e&&e.__esModule?e:{default:e}}function _(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return _=function(){return e},e}function E(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=_();if(t&&t.has(e))return t.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var o=n?Object.getOwnPropertyDescriptor(e,a):null;o&&(o.get||o.set)?Object.defineProperty(r,a,o):r[a]=e[a]}return r.default=e,t&&t.set(e,r),r}function P(e,t,r,a){n||(n="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103);var o=e&&e.defaultProps,u=arguments.length-3;if(t||0===u||(t={children:void 0}),1===u)t.children=a;else if(u>1){for(var i=new Array(u),s=0;s<u;s++)i[s]=arguments[s+3];t.children=i}if(t&&o)for(var l in o)void 0===t[l]&&(t[l]=o[l]);else t||(t=o||{});return{$$typeof:n,type:e,key:void 0===r?null:""+r,ref:null,props:t,_owner:null}}function R(e){var t=0;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return A(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A(e,t)}(e)))return function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var j="developers",w="publishers",I=(0,f.callMeMaybe)(i.fetchCompanies),F=function(e){return null!=e?e.map(function(e){return e.name}):[]},N=function(e){return e.trim().toLowerCase()},x=function(e,t){return Object.keys(e).reduce(function(r,n){var a=n.startsWith(j),o=n.startsWith(w);if(a||o){var u=e[n],s=N(u);return""===s?r:r.concat(I(s,{name:u}).then(function(e,t){return function(r){return null==r||0===r.length?i.createCompany(t,{name:e}).then(function(t){return I.setResolveValue(N(e),[t]),t}):r[0]}}(u,t)).then(function(e){return{type:a?j:w,id:e.id}}))}return r},[])},U=function(e){var t,r;function n(){for(var t,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(t=e.call.apply(e,[this].concat(n))||this).formRef=a.createRef(),t.developersRef=a.createRef(),t.publishersRef=a.createRef(),t.state={errorMessage:null,hasUnsavedChanges:!1,isSubmitting:!1,hasSubmitted:!1},t.handleMetadataFormChange=function(){t.state.hasUnsavedChanges||t.setState({hasUnsavedChanges:!0})},t.handleMetadataFormReset=function(){var e=t.formRef.current,r=t.publishersRef.current,n=t.developersRef.current;null!=e&&e.resetForm(),null!=r&&r.resetInputFields(),null!=n&&n.resetInputFields(),t.setState({errorMessage:null,hasSubmitted:!1,hasUnsavedChanges:!1})},t.handleMetadataFormSubmit=function(e){var r=t.props.application;t.setState({isSubmitting:!0},function(){Promise.all(x(e,r.owner.id)).then(function(e){var t,n=e.reduce(function(e,t){return e[t.type].push(t.id),e},((t={})[w]=[],t[j]=[],t));return u.updateApplication(r.id,{developer_ids:n[j],publisher_ids:n[w]})}).then(function(){t.setState({errorMessage:null,hasSubmitted:!0,hasUnsavedChanges:!1,isSubmitting:!1})}).catch(function(e){var r=(0,p.getMessageFromAPIError)(e,C.Messages.Errors.ERROR_SUBMITTING_FORM.format());t.setState({errorMessage:r,hasSubmitted:!1,isSubmitting:!1})})})},t}r=e,(t=n).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r;var o=n.prototype;return o.componentDidMount=function(){for(var e,t=this.props.application,r=t.developers,n=void 0===r?[]:r,a=t.publishers,o=void 0===a?[]:a,u=R(n.concat(o));!(e=u()).done;){var i=e.value;I.setResolveValue(N(i.name),[i])}},o.renderCompanyFields=function(){var e=this.props.application;return(0,d.hasFlag)(e.owner.flags,M.UserFlags.TEAM_PSEUDO_USER)?P(a.Fragment,{},void 0,P(l.GridSection,{},void 0,P(l.GridChild,{columnSpread:12,columnSpreadMedium:8,columnSpreadLarge:6,columnSpreadExtraLarge:6},void 0,P(h.default,{},void 0,C.Messages.Metadata.DEVELOPERS),a.createElement(m.default,{maxCount:5,namePrefix:j,onChange:this.handleMetadataFormChange,type:C.Messages.Metadata.DEVELOPERS,values:F(e.developers),ref:this.developersRef}))),P(l.GridSection,{},void 0,P(l.GridChild,{columnSpread:12,columnSpreadMedium:8,columnSpreadLarge:6,columnSpreadExtraLarge:6},void 0,P(h.default,{},void 0,C.Messages.Metadata.PUBLISHERS),a.createElement(m.default,{maxCount:5,namePrefix:w,onChange:this.handleMetadataFormChange,type:C.Messages.Metadata.PUBLISHERS,values:F(e.publishers),ref:this.publishersRef})))):null},o.renderFormStatus=function(){var e=this.state,t=e.errorMessage,r=e.hasSubmitted;return null!=t?P(v.default,{type:v.default.Types.ERROR},void 0,t):r?P(v.default,{type:v.default.Types.SUCCESS},void 0,C.Messages.Alerts.SUCCESS_CHANGES_SAVED):null},o.render=function(){var e=this.state,t=e.hasUnsavedChanges,r=e.isSubmitting;return a.createElement(c.default,{onChange:this.handleMetadataFormChange,onSubmit:this.handleMetadataFormSubmit,ref:this.formRef},P(g.default,{},void 0,P(y.default,{},void 0,C.Messages.Metadata.HEADING),P(b.default,{isFlush:!0},void 0,C.Messages.Metadata.SUBHEADING),this.renderFormStatus()),P(g.default,{isFlush:!0},void 0,P(l.default,{},void 0,this.renderCompanyFields())),P(S.default,{isVisible:t,onReset:this.handleMetadataFormReset,submitting:r}))},n}(a.Component);U.displayName="Metadata";var k=o.default.connectStores([s.default],function(e){var t=e.match.params.id;return{application:s.default.getApplication(t)}})(U);t.default=k},2367:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fetchCompanies=t.createCompany=void 0;var n=s(r(59)),a=s(r(19)),o=r(97),u=s(r(20)),i=r(3);function s(e){return e&&e.__esModule?e:{default:e}}t.createCompany=function(e,t){return n.default.post({url:i.Endpoints.TEAM_COMPANIES(e),body:{name:t.name}}).then(function(e){return a.default.dispatch({type:u.default.COMPANY_CREATE_SUCCESS,company:e.body}),e.body}).catch(o.APIErrorHandler)};t.fetchCompanies=function(e){return n.default.get({url:i.Endpoints.COMPANIES,query:{name:e.name}}).then(function(e){return a.default.dispatch({type:u.default.COMPANY_QUERY_SUCCESS,companies:e.body}),e.body})}}}]);
//# sourceMappingURL=926a959db55aea9618ce.js.map