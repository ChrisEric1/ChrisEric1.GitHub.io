(this.webpackChunkdiscord_app=this.webpackChunkdiscord_app||[]).push([[98010],{429547:(e,t,n)=>{e.exports=n.p+"750214196f39660492a313dbe5c84fe4.svg"},834005:(e,t,n)=>{e.exports=n.p+"68458539d5672f6045fff5d505dd566a.svg"},707233:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(785893),l=n(667294),i=n(294184),s=n.n(i),a=n(945460),o=n(557617),u=n(656016),c=n.n(u);function d(e){var t=e.filename,n=e.className,i=e.filters,u=e.buttonText,d=e.placeholder,f=e.onFileSelect,m=l.useRef(null);return(0,r.jsxs)("div",{className:s()(n,c().fileUpload),children:[(0,r.jsx)("input",{className:c().fileUploadInput,tabIndex:-1,readOnly:!0,placeholder:d,type:"text",value:t}),(0,r.jsxs)(a.Button,{size:a.Button.Sizes.MIN,className:c().fileUploadButton,children:[u,(0,r.jsx)(o.Z,{ref:m,tabIndex:-1,onChange:function(e){var t,n=null===(t=e.currentTarget.files)||void 0===t?void 0:t[0];f(n)},multiple:!1,filters:i})]})]})}},856729:(e,t,n)=>{"use strict";n.r(t);n.d(t,{default:()=>re})
;var r=n(785893),l=n(667294),i=n(294184),s=n.n(i),a=n(468811),o=n.n(a),u=n(202351),c=n(575945),d=n(945460),f=n(77413),m=n(748308),p=n(135855),I=n(707233),_=n(311260),E=n(64234),g=n(473903),v=n(847197),T=n(107364),h=n(386991),L=n(652591),b=n(452723),D=n(348592),S=n(347117),y=n(840598),x=(0,n(260561).B)({kind:"guild",id:"2021-07_stickers_lottie_upload",label:"Lottie Sticker Uploads",defaultConfig:{enabled:!1},treatments:[{id:1,label:"Allow Lottie sticker uploads",config:{enabled:!0}}]}),O=n(514351),j=n(513586),C=n(600277),P=n(719833),R=n(2590),U=n(473708),A=n(958497),N=n.n(A),M=n(429547),w=n.n(M),k=n(834005),Z=n.n(k);function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G(e,t,n,r,l,i,s){try{var a=e[i](s),o=a.value}catch(e){n(e);return}a.done?t(o):Promise.resolve(o).then(r,l)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(r,l){var i=e.apply(t,n);function s(e){G(i,r,l,s,a,"next",e)}
function a(e){G(i,r,l,s,a,"throw",e)}s(void 0)}))}}function F(e,t,n){t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n;return e}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))));r.forEach((function(t){F(e,t,n[t])}))}return e}function H(e,t){t=null!=t?t:{};Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})));n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}));return e}function V(e,t){return function(e){
if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,l,i=[],s=!0,a=!1;try{for(n=n.call(e);!(s=(r=n.next()).done);s=!0){i.push(r.value);if(t&&i.length===t)break}}catch(e){a=!0;l=e}finally{try{s||null==n.return||n.return()}finally{if(a)throw l}}return i}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var q=function(e,t){var n,r,l,i,s={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},
"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(l=2&i[0]?r.return:i[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,i[1])).done)return l;(r=0,l)&&(i=[2&i[0],l.value]);switch(i[0]){case 0:case 1:l=i;break;case 4:s.label++;return{value:i[1],done:!1};case 5:s.label++;r=i[1];i=[0];continue;case 7:i=s.ops.pop();s.trys.pop();continue;default:if(!(l=s.trys,l=l.length>0&&l[l.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!l||i[1]>l[0]&&i[1]<l[3])){s.label=i[1];break}if(6===i[0]&&s.label<l[1]){s.label=l[1];l=i;break}if(l&&s.label<l[2]){s.label=l[2];s.ops.push(i);break}l[2]&&s.ops.pop();s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e];r=0}finally{n=l=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},W=320,J=new Set(["application/json","image/png","image/apng","image/gif"]),Y=[{
name:"Sticker file",extensions:["json","png","apng","gif"]}];function X(e,t){L.default.track(R.rMx.STICKER_UPLOAD_COMPLETED,{successful:e,error:null!=t?t:""})}var $=function(e){var t=e.stickerPreview;return(0,r.jsxs)("div",{className:N().preview,children:[(0,r.jsx)("div",{className:N().previewDark,children:null!=t?t:(0,r.jsx)("img",{src:w(),alt:U.Z.Messages.GUILD_STICKER_PREVIEW_IMG_ALT_DARK})}),(0,r.jsx)("div",{className:N().previewLight,children:null!=t?t:(0,r.jsx)("img",{src:Z(),alt:U.Z.Messages.GUILD_STICKER_PREVIEW_IMG_ALT_LIGHT})})]})};function Q(e){if(null==e)return null;var t={className:N().emoji,emojiName:e.optionallyDiverseSequence,autoplay:!0};return function(){return(0,r.jsx)(f.Z,z({},t))}}var ee=function(e){var t=e.emoji,n=e.onSelectEmoji;return(0,r.jsx)(d.Popout,{animation:d.Popout.Animation.NONE,position:"top",renderPopout:function(e){var t=e.closePopout;return(0,r.jsx)(m.Z,{closePopout:t,pickerIntention:R.HzX.GUILD_STICKER_RELATED_EMOJI,onNavigateAway:t,
onSelectEmoji:function(e,r){n(e);r&&t()}})},children:function(e,n){var l=n.isShown;return(0,r.jsxs)("div",H(z({className:N().emojiInputContainer},e),{children:[(0,r.jsx)(v.Z,{className:N().emojiButton,active:l,tabIndex:0,renderButtonContents:Q(t)}),(0,r.jsx)(d.TextInput,{inputClassName:N().emojiText,placeholder:U.Z.Messages.GUILD_STICKER_UPLOAD_RELATED_EMOJI_PLACEHOLDER,value:null!=t?":".concat(t.uniqueName,":"):"",readOnly:!0})]}))}})};function te(e){return ne.apply(this,arguments)}function ne(){return(ne=B((function(e){var t,n,r;return q(this,(function(l){switch(l.label){case 0:return[4,(0,S.fD)(e)];case 1:t=l.sent();(n=new Image).src=t;return[4,n.decode()];case 2:l.sent();r=(0,_.Ae)(n,W,W);return[2,(0,S.Bo)(r,e.name,e.type)]}}))}))).apply(this,arguments)}function re(e){var t,n,i,a,f,m,_,v,A,M=e.transitionState,w=e.onClose,k=e.guildId,Z=e.sticker,K=(0,u.e7)([E.Z],(function(){return E.Z.theme
})),G=null!==(n=null===(t=g.default.getCurrentUser())||void 0===t?void 0:t.isStaff())&&void 0!==n&&n?P.OC:P.Ht,F=V(l.useState(null),2),H=F[0],W=F[1],Q=V(l.useState(null!==(i=null==Z?void 0:Z.name)&&void 0!==i?i:""),2),ne=Q[0],re=Q[1],le=V(l.useState({file:null,filename:null!==(a=(0,j._V)(Z))&&void 0!==a?a:""}),2),ie=le[0],se=le[1],ae=V(l.useState(null!=(null==Z?void 0:Z.tags)&&null!==(f=p.ZP.getByName(Z.tags))&&void 0!==f?f:null),2),oe=ae[0],ue=ae[1],ce=V(l.useState(null!==(m=null==Z?void 0:Z.description)&&void 0!==m?m:""),2),de=ce[0],fe=ce[1],me=V(l.useState(!1),2),pe=me[0],Ie=me[1],_e=V(l.useState(null),2),Ee=_e[0],ge=_e[1],ve=null!=Z,Te=ve||null!=(null==ie?void 0:ie.file),he=0===de.length||de.length>=2&&de.length<=100,Le=!pe&&!0!==(null==Ee?void 0:Ee.isBlocking)&&ne.length>=2&&(null!=oe||null!=(null==Z?void 0:Z.tags)&&""!==(null==Z?void 0:Z.tags))&&Te&&he,be=x.getCurrentConfig({guildId:k}).enabled,De=(_=B((function(e){var t,n,r,l,i,s,a,u;return q(this,(function(c){switch(c.label){
case 0:if(null==e)return[2];n=null===(t=e.type)||void 0===t?void 0:t.split(";")[0];if(!J.has(n)){ge({message:U.Z.Messages.GUILD_STICKER_UNKNOWN_MIME_TYPE,isBlocking:!0});return[2]}r=e;return(l="image/png"===n&&e.size>G)?[4,(0,S.c0)(e)]:[3,2];case 1:l=!c.sent();c.label=2;case 2:return l?[4,te(e)]:[3,4];case 3:r=c.sent();i=r.size>G;L.default.track(R.rMx.STICKER_FILE_RESIZED,{original_file_size_bytes:e.size,resized_file_size_bytes:r.size,resized_file_too_big:i});c.label=4;case 4:if(r.size>G){ge({message:U.Z.Messages.GUILD_STICKER_FILE_TOO_BIG.format({maxSize:(0,b.IC)(G,{useKibibytes:!0})}),isBlocking:null==ie.file});L.default.track(R.rMx.STICKER_UPLOAD_FILE_SIZE_LIMIT_EXCEEDED,{size:r.size,filetype:n});return[2]}if((s=(0,j.Zv)(r.type))!==O.u3.LOTTIE)return[3,5];if(!be){ge({message:U.Z.Messages.GUILD_STICKER_UNSUPPORTED_MIME_TYPE.format({articleURL:D.Z.getArticleURL(R.BhN.STICKERS_UPLOAD)}),isBlocking:!0});return[2]}(a=new FileReader).addEventListener("load",(function(){W({id:o().v4(),
formatType:s,content:a.result});ge(null)}));a.readAsText(r);return[3,7];case 5:return[4,(0,S.fD)(r)];case 6:u=c.sent();W({id:o().v4(),formatType:s,content:u});ge(null);c.label=7;case 7:se({file:r,filename:r.name});return[2]}}))})),function(e){return _.apply(this,arguments)}),Se=function(){var e=B((function(e){var t,n,r,l,i,s,a,o;return q(this,(function(u){switch(u.label){case 0:e.preventDefault();r=null!==(n=null!==(t=null==oe?void 0:oe.uniqueName)&&void 0!==t?t:null==Z?void 0:Z.tags)&&void 0!==n?n:"";u.label=1;case 1:u.trys.push([1,6,7,8]);Ie(!0);return ve?[4,(0,y.Jf)(k,null!==(l=null==Z?void 0:Z.id)&&void 0!==l?l:"",{name:ne,tags:r,description:de})]:[3,3];case 2:u.sent();return[3,5];case 3:(s=new FormData).append("name",ne);s.append("tags",r);s.append("description",de);null!=(null==ie?void 0:ie.file)&&s.append("file",ie.file);c=null!==(a=null===(i=ie.file)||void 0===i?void 0:i.type)&&void 0!==a?a:"",L.default.track(R.rMx.STICKER_UPLOAD_STARTED,{filetype:c});return[4,(0,y.lY)(k,s)]
;case 4:u.sent();X(!0);u.label=5;case 5:w();return[3,8];case 6:o=u.sent();ge({message:o.body.message,isBlocking:!1});X(!1,o.body.message);return[3,8];case 7:Ie(!1);return[7];case 8:return[2]}var c}))}));return function(t){return e.apply(this,arguments)}}(),ye=l.useCallback((function(){ge({message:U.Z.Messages.GUILD_STICKER_INVALID_STICKER,isBlocking:!0})}),[]),xe=function(e){var t=e.sticker,n=e.previewData,l=e.onStickerError;if(null!=t)return(0,r.jsx)(C.ZP,{size:160,sticker:t});if(null==n)return null;var i=n.id,s=n.formatType,a=n.content;return(0,r.jsx)(C.ZP,{assetData:a,fileUri:a,size:160,sticker:{name:i,description:"",id:i,pack_id:"",format_type:s},onError:l},i)}({sticker:Z,previewData:H,onStickerError:ye}),Oe=be?U.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION:U.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_NO_LOTTIE;return(0,r.jsxs)(d.ModalRoot,{transitionState:M,"aria-labelledby":"STICKER_UPLOAD_MODAL",className:N().modal,children:[(0,r.jsx)(d.ModalCloseButton,{onClick:w,
className:N().modalClose}),(0,r.jsxs)("form",{onSubmit:Se,className:N().form,children:[(0,r.jsxs)(d.ModalContent,{className:N().modalContent,children:[(0,r.jsxs)(d.ModalHeader,{direction:T.Z.Direction.VERTICAL,separator:!1,className:N().modalHeader,children:[(0,r.jsx)(d.Heading,{variant:"heading-xl/semibold",className:N().modalHeaderTitle,children:U.Z.Messages.GUILD_STICKER_UPLOAD_TITLE}),(0,r.jsx)(d.Text,{variant:"text-md/normal",children:Oe.format({fileSize:(0,b.IC)(P.Ht,{useKibibytes:!0})})})]}),(0,r.jsx)(d.FormSection,{title:U.Z.Messages.GUILD_STICKER_UPLOAD_PREVIEW_TITLE,className:N().formItem,children:(0,r.jsx)($,{stickerPreview:xe})}),(0,r.jsxs)(d.FormSection,{className:s()(N().formItem,N().formItemRow),children:[(0,r.jsx)(d.FormItem,{title:ve?U.Z.Messages.GUILD_STICKER_UPLOAD_FILE_TITLE_BLOCKED:U.Z.Messages.GUILD_STICKER_UPLOAD_FILE_TITLE,required:!0,className:N().formItemRowChild,children:ve?(0,r.jsx)(d.TextInput,{disabled:!0,
value:null!==(v=null==ie?void 0:ie.filename)&&void 0!==v?v:""}):(0,r.jsx)(I.Z,{buttonText:U.Z.Messages.GUILD_STICKER_UPLOAD_FILE_BUTTON,filters:Y,filename:null!==(A=null==ie?void 0:ie.filename)&&void 0!==A?A:"",placeholder:U.Z.Messages.GUILD_STICKER_UPLOAD_FILE_PLACEHOLDER,onFileSelect:De})}),(0,r.jsx)(d.FormItem,{title:U.Z.Messages.GUILD_STICKER_UPLOAD_RELATED_EMOJI_TITLE,required:!0,className:N().formItemRowChild,children:(0,r.jsx)(ee,{emoji:oe,onSelectEmoji:ue})})]}),(0,r.jsx)(d.FormItem,{title:U.Z.Messages.GUILD_STICKER_UPLOAD_NAME_TITLE,required:!0,className:N().formItem,children:(0,r.jsx)(d.TextInput,{value:ne,onChange:re,placeholder:U.Z.Messages.GUILD_STICKER_UPLOAD_NAME_PLACEHOLDER,maxLength:30})}),(0,r.jsxs)("div",{className:N().formItem,children:[(0,r.jsxs)(d.FormTitle,{children:[U.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_TITLE,(0,r.jsx)(d.Tooltip,{text:U.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_TOOLTIP,children:function(e){return(0,r.jsx)(h.Z,z({className:N().infoIcon
},e))}})]}),(0,r.jsx)(d.TextArea,{value:de,onChange:fe,placeholder:U.Z.Messages.GUILD_STICKER_UPLOAD_DESCRIPTION_PLACEHOLDER,maxLength:100})]}),null!=Ee&&(0,r.jsx)(d.Text,{className:N().formItem,variant:"text-sm/normal",color:"text-danger",children:Ee.message})]}),(0,r.jsxs)(d.ModalFooter,{className:N().modalFooter,children:[(0,r.jsx)(d.Button,{type:"submit",disabled:!Le,children:ve?U.Z.Messages.GUILD_STICKERS_UPDATE:U.Z.Messages.UPLOAD}),(0,r.jsx)(d.Button,{look:d.Button.Looks.LINK,color:(0,c.ap)(K)?d.Button.Colors.PRIMARY:d.Button.Colors.WHITE,onClick:w,children:U.Z.Messages.NEVERMIND})]})]})]})}}}]);
//# sourceMappingURL=8d798b70eb7d4ef68e41.js.map