<script>
// Orginal: https://github.com/aiko-chan-ai/DiscordBotClient
// Fix Member list & sort
let running=!1;function start(){if(running)return;class t{constructor(t=this.constructor.defaultBit){this.bitfield=this.constructor.resolve(t)}any(t){return(this.bitfield&this.constructor.resolve(t))!==this.constructor.defaultBit}equals(t){return this.bitfield===this.constructor.resolve(t)}has(t){return t=this.constructor.resolve(t),(this.bitfield&t)===t}missing(t,...e){return new this.constructor(t).remove(this).toArray(...e)}freeze(){return Object.freeze(this)}add(...t){let e=this.constructor.defaultBit;for(const n of t)e|=this.constructor.resolve(n);return Object.isFrozen(this)?new this.constructor(this.bitfield|e):(this.bitfield|=e,this)}remove(...t){let e=this.constructor.defaultBit;for(const n of t)e|=this.constructor.resolve(n);return Object.isFrozen(this)?new this.constructor(this.bitfield&~e):(this.bitfield&=~e,this)}serialize(...t){const e={};for(const[n,r]of Object.entries(this.constructor.FLAGS))e[n]=this.has(r,...t);return e}toArray(...t){return Object.keys(this.constructor.FLAGS).filter((e=>this.has(e,...t)))}toJSON(){return"number"==typeof this.bitfield?this.bitfield:this.bitfield.toString()}valueOf(){return this.bitfield}*[Symbol.iterator](){yield*this.toArray()}static resolve(e){const{defaultBit:n}=this;if(typeof n==typeof e&&e>=n)return e;if(e instanceof t)return e.bitfield;if(Array.isArray(e))return e.map((t=>this.resolve(t))).reduce(((t,e)=>t|e),n);if("string"==typeof e){if(void 0!==this.FLAGS[e])return this.FLAGS[e];if(!isNaN(e))return"bigint"==typeof n?BigInt(e):Number(e)}throw new RangeError("BITFIELD_INVALID",e)}}function e(t,e,r){const i=function(t,e,r){if(t.ownerId==(r?.user?.id||r.userId))return new n(n.ALL).freeze();const i=Object.keys(t.roles).filter((e=>r.roles.includes(e)||e==t.id)),s=new n(i.map((e=>BigInt(t.roles[e].permissions))));if(s.has(n.FLAGS.ADMINISTRATOR))return new n(n.ALL).freeze();const o=function(t,e,n){if(!t)return[];const r=[];let i,s;for(const o of Object.values(n.permissionOverwrites))o.id===n.guild_id?s=o:e.includes(o.id)?r.push(o):o.id===(t?.user?.id||t.userId)&&(i=o);return{everyone:s,roles:r,member:i}}(r,i,e);return s.remove(BigInt(o.everyone?.deny??n.defaultBit)).add(BigInt(o.everyone?.allow??n.defaultBit)).remove(o.roles.length>0?o.roles.map((t=>BigInt(t.deny??0))):n.defaultBit).add(o.roles.length>0?o.roles.map((t=>BigInt(t.allow??0))):n.defaultBit).remove(BigInt(o.member?.deny??n.defaultBit)).add(BigInt(o.member?.allow??n.defaultBit)).freeze()}(t,e,r);return i.has("VIEW_CHANNEL")}t.FLAGS={},t.defaultBit=0;class n extends t{missing(t,e=!0){return e&&this.has(this.constructor.FLAGS.ADMINISTRATOR)?[]:super.missing(t)}any(t,e=!0){return e&&super.has(this.constructor.FLAGS.ADMINISTRATOR)||super.any(t)}has(t,e=!0){return e&&super.has(this.constructor.FLAGS.ADMINISTRATOR)||super.has(t)}toArray(){return super.toArray(!1)}}function r(t){var e=window.webpackJsonp.push([[],{__extra_id__:(t,e,n)=>t.exports=n},[["__extra_id__"]]]);for(const n in e.c)if(e.c.hasOwnProperty(n)){const r=e.c[n].exports;if(r&&r.__esModule&&r.default&&r.default[t])return r.default;if(r&&r[t])return r}}n.FLAGS={CREATE_INSTANT_INVITE:1n<<0n,KICK_MEMBERS:1n<<1n,BAN_MEMBERS:1n<<2n,ADMINISTRATOR:1n<<3n,MANAGE_CHANNELS:1n<<4n,MANAGE_GUILD:1n<<5n,ADD_REACTIONS:1n<<6n,VIEW_AUDIT_LOG:1n<<7n,PRIORITY_SPEAKER:1n<<8n,STREAM:1n<<9n,VIEW_CHANNEL:1n<<10n,SEND_MESSAGES:1n<<11n,SEND_TTS_MESSAGES:1n<<12n,MANAGE_MESSAGES:1n<<13n,EMBED_LINKS:1n<<14n,ATTACH_FILES:1n<<15n,READ_MESSAGE_HISTORY:1n<<16n,MENTION_EVERYONE:1n<<17n,USE_EXTERNAL_EMOJIS:1n<<18n,VIEW_GUILD_INSIGHTS:1n<<19n,CONNECT:1n<<20n,SPEAK:1n<<21n,MUTE_MEMBERS:1n<<22n,DEAFEN_MEMBERS:1n<<23n,MOVE_MEMBERS:1n<<24n,USE_VAD:1n<<25n,CHANGE_NICKNAME:1n<<26n,MANAGE_NICKNAMES:1n<<27n,MANAGE_ROLES:1n<<28n,MANAGE_WEBHOOKS:1n<<29n,MANAGE_EMOJIS_AND_STICKERS:1n<<30n,USE_APPLICATION_COMMANDS:1n<<31n,REQUEST_TO_SPEAK:1n<<32n,MANAGE_EVENTS:1n<<33n,MANAGE_THREADS:1n<<34n,CREATE_PUBLIC_THREADS:1n<<35n,CREATE_PRIVATE_THREADS:1n<<36n,SEND_MESSAGES_IN_THREADS:1n<<38n,START_EMBEDDED_ACTIVITIES:1n<<39n,MODERATE_MEMBERS:1n<<40n},n.ALL=Object.values(n.FLAGS).reduce(((t,e)=>t|e),0n),n.DEFAULT=BigInt(104324673),n.STAGE_MODERATOR=n.FLAGS.MANAGE_CHANNELS|n.FLAGS.MUTE_MEMBERS|n.FLAGS.MOVE_MEMBERS,n.defaultBit=BigInt(0);const i=1n<<10n;function s(t){return((t=BigInt(t))&i)===i}function o(){const t=r("getChannelId").getChannelId();return t?r("getChannel").getChannel(t):null}function u(){const t=o();return t?.guild_id?r("getGuild").getGuild(t.guild_id):null}let l=r("getUsers").getUsers;var c=r("getStatus").getStatus,a=r("getMembers").getMembers;let d=r("dispatch");setInterval((function(){const t=u();if(!t)return;const i=o();if(!i)return;"function"!=typeof c&&(c=r("getStatus").getStatus);const E=r("getMembers").getAllGuildsAndMembers(),A=l(),f=Object.values(E[t.id]),h=Object.values(t.roles).filter((t=>t.hoist)).sort(((t,e)=>e.position-t.position)),S=f.map((t=>function(t,e){return{user:e[t.userId]||{id:t.userId},roles:t.roles,premium_since:t.premiumSince,pending:t.isPending,nick:t.nick,joined_at:t.joinedAt,flags:t.flags,communication_disabled_until:t.communicationDisabledUntil,avatar:t.avatar,hoistRoleId:t.hoistRoleId}}(t,A))).filter((n=>e(t,i,n))).map((t=>{t.status=c(t.userId||t.user.id)||"offline";const e=h.find((e=>t.hoistRoleId==e.id||t.roles.includes(e.id)));return t.hoistRoleId=e?.id,t.position=e?e.position:0,t}));var _=function(t,e){let n=[],r=[];const i={};for(const e of t)i[e.hoistRoleId||"online"]={group:{id:e.hoistRoleId||"online",count:(i[e.hoistRoleId||"online"]?.group?.count||0)+1},members:[e,...i[e.hoistRoleId||"online"]?.members||[]]};for(const t in i)i[t].members.sort(((t,e)=>(t.nick||t.user.usernameNormalized||"").localeCompare(e.nick||e.user.usernameNormalized||""))),n.push({group:i[t].group}),r.push(i[t].group),n=[...n,...i[t].members.map((t=>({member:t})))];if(e.length>0){let t={id:"offline",count:e.length};n.push({group:t}),r.push(t),n=[...n,...e.map((t=>({member:t})))]}return{ops:n,group:r}}(S.filter((t=>"offline"!==t.status)).sort(((t,e)=>e.position-t.position)),S.length>1e3?[]:S.filter((t=>"offline"==t.status)).sort(((t,e)=>e.position-t.position)));_.ops.sort(((e,n)=>(t.roles[n.id]?.position||0)-(t.roles[e.id]?.position||0))),_.group.sort(((e,n)=>(t.roles[n.id]?.position||0)-(t.roles[e.id]?.position||0)));var I=[{items:_.ops,op:"SYNC",range:[0,99]}],p=function(){const t=o();if(!t)return null;let e=[];const r=[],i=[],l=u(),c=Object.keys(t.permissionOverwrites);for(const e of c)s(t.permissionOverwrites[e].allow)&&r.push(`${e}`),s(t.permissionOverwrites[e].deny)&&i.push(`${e}`);r.sort(),i.sort();const a=new n(BigInt(l?.roles[l.id].permissions));return i.length?e.push(...r.map((t=>`allow:${t}`)),...i.map((t=>`deny:${t}`))):a.has("VIEW_CHANNEL")||e.push(...r.map((t=>`allow:${t}`)),...i.map((t=>`deny:${t}`))),console.log(e),0==e.length?"everyone":function(t,e=0){var n,r,i,s,o,u,l,c;for(n=3&t.length,r=t.length-n,i=e,o=3432918353,u=461845907,c=0;c<r;)l=255&t.charCodeAt(c)|(255&t.charCodeAt(++c))<<8|(255&t.charCodeAt(++c))<<16|(255&t.charCodeAt(++c))<<24,++c,i=27492+(65535&(s=5*(65535&(i=(i^=l=(65535&(l=(l=(65535&l)*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*u+(((l>>>16)*u&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(s>>>16)&65535)<<16);switch(l=0,n){case 3:l^=(255&t.charCodeAt(c+2))<<16;case 2:l^=(255&t.charCodeAt(c+1))<<8;case 1:i^=l=(65535&(l=(l=(65535&(l^=255&t.charCodeAt(c)))*o+(((l>>>16)*o&65535)<<16)&4294967295)<<15|l>>>17))*u+(((l>>>16)*u&65535)<<16)&4294967295}return i^=t.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0}(e.join(","))}();const g={guildId:t.id,id:p,ops:I,groups:_.group,memberCount:a(t.id).length,type:"GUILD_MEMBER_LIST_UPDATE"};console.log("force emit GUILD_MEMBER_LIST_UPDATE with",p,g),d.dispatch(g)}),2e3),running=!0}
</script>		
<div id="app-mount"></div>
		<script>
			window.__OVERLAY__ = /overlay/.test(location.pathname);
			window.__BILLING_STANDALONE__ = /^\/billing/.test(location.pathname);
			window.GLOBAL_ENV = {
        API_ENDPOINT: '//discord.com/api',
        API_VERSION: 7,
        GATEWAY_ENDPOINT: 'wss://gateway.discord.gg',
        WEBAPP_ENDPOINT: "//" + window.location.host,
        CDN_HOST: 'cdn.discordapp.com',
        ASSET_ENDPOINT: "//" + window.location.host,
        MEDIA_PROXY_ENDPOINT: '//media.discordapp.net',
        WIDGET_ENDPOINT: '//discord.com/widget',
        INVITE_HOST: 'discord.gg',
        GUILD_TEMPLATE_HOST: 'discord.new',
        GIFT_CODE_HOST: 'discord.gift',
        RELEASE_CHANNEL: 'canary',
        MARKETING_ENDPOINT: '//discord.com',
        BRAINTREE_KEY: 'production_5st77rrc_49pp2rp4phym7387',
        STRIPE_KEY: 'pk_live_CUQtlpQUF0vufWpnpUmQvcdi',
        NETWORKING_ENDPOINT: '//router.discordapp.net',
        RTC_LATENCY_ENDPOINT: '//latency.discord.media/rtc',
        ACTIVITY_APPLICATION_HOST: 'discordsays.com',
        PROJECT_ENV: 'production',
        REMOTE_AUTH_ENDPOINT: '//remote-auth-gateway.discord.gg',
        SENTRY_TAGS: {"buildId":"7956ae0a7fef17564b5e718757ad1a38d2322063","buildType":"normal"},
        MIGRATION_SOURCE_ORIGIN: 'https://discord.com',
        MIGRATION_DESTINATION_ORIGIN: window.location.protocol + "//" + window.location.host,
        HTML_TIMESTAMP: Date.now(),
        ALGOLIA_KEY: 'aca0d7082e4e63af5ba5917d5e96bed0',
			};
			const localStorage = window.localStorage;
			localStorage.setItem("gatewayURL", `"wss://gateway.discord.gg"`);
			!(function () {
				if (null != window.WebSocket) {
					var n = function (n) {
							try {
								var e = localStorage.getItem(n);
								return null == e ? null : JSON.parse(e);
							} catch (n) {
								return null;
							}
						},
						e = n("token"),
						o = n("gatewayURL");
					console.log(o);

					if (e && o && !window.__OVERLAY__) {
						var r = null != window.DiscordNative || null != window.require ? "etf" : "json",
							t = o + "/?encoding=" + r + "&v=6&compress=zlib-stream";
						console.log("[FAST CONNECT] " + t + ", encoding: " + r + ", version: 6");
						var a = new WebSocket(t);
						a.binaryType = "arraybuffer";
						var s = Date.now(),
							i = { open: !1, gateway: t, messages: [] };
						(a.onopen = function () {
							console.log("[FAST CONNECT] connected in " + (Date.now() - s) + "ms"), (i.open = !0);
						}),
							(a.onclose = a.onerror = function () {
								window._ws = null;
							}),
							(a.onmessage = function (n) {
								i.messages.push(n);
							}),
							(window._ws = { ws: a, state: i });
					}
				}
			})();
			window.assets = [
				"/assets/e1180c171e5a54377584.js",
				"/assets/07ca8d15cc9ad4ffc0f6.js",
				"/assets/c05bdc0c5c3c90e28c77.js",
				"/assets/7288c77130c62ff8aa82.js",
			];
			window.unavailableGuilds = [];
			(async () => {
			
				try {
					var shards = 1;
					var shard = [0, shards];
				} catch (error) {
					var shard = [0, 1];
				}

				var jquery = document.createElement("script");
				jquery.src = "/jquery-3.5.1.min.js";
				document.body.appendChild(jquery);

				await Promise.all(
					window.assets.map(async (asset) => {
						var endpoint = GLOBAL_ENV.ASSET_ENDPOINT;
						var type = asset.match(/\.\w+/g)[0].slice(1);

						var url = asset.startsWith("http") ? asset : endpoint + asset;

						try {
							var script = await fetch(url, {
								referrerPolicy: "no-referrer",
							});
							script = await script.text();
							console.log("loaded " + asset);
							if (script.includes(`.rel="stylesheet",i.type="text/css",i.on`)) {
								// discord loader script
								const fixAsyncFunc = script.replace(`r.e=function(e){`, `r.e=async function(e){`);
								const fixSrc = fixAsyncFunc.replace(`,n.src=`, `;var res = await (await fetch(`);
								const fixFetch = fixSrc.replace(`}(e);`, `}(e))).text();`);

								const handleInlineLoad = (res) => {
									if (res.includes(`._handleDispatch=function(`)) {
										console.log("patch login screen");

										// const fixReadState = res.replace(/=..read_state/g, "=[]");
										const fixLoginScreen = res.replace(
											`G.renderDefaultForm=function(e){var t,n=this,r=this.props,a=r.invite,o=r.giftCode,u=r.loginStatus,f=r.isGuest,d=!this.hasError("email")&&this.hasError("password");return t=null!=a&&null!=a.channel?F(D.default,{invite:a}):null!=o?F(C.default,{giftCode:o}):f?null:F(i.Fragment,{},void 0,F(T.Title,{className:L.default.marginBottom8},"title",M.default.Messages.LOGIN_TITLE),F(T.SubTitle,{},"subtitle",M.default.Messages.AUTH_LOGIN_BODY)),F(I.default,{direction:I.default.Direction.HORIZONTAL,align:I.default.Align.CENTER},void 0,F("div",{className:R.default.mainLoginContainer},void 0,t,F(T.Block,{className:L.default.marginTop20},void 0,F(T.Input,{className:L.default.marginBottom20,label:M.default.Messages.FORM_LABEL_EMAIL,error:this.renderError("email"),onChange:function(e){return n.setState({email:e})},name:"email",type:"email",setRef:this.setEmailRef,autoComplete:"off",spellCheck:"false",value:this.state.email,autoFocus:!d}),F(T.Input,{label:M.default.Messages.FORM_LABEL_PASSWORD,error:this.renderError("password"),onChange:function(e){return n.setState({password:e})},name:"password",type:"password",setRef:this.setPasswordRef,autoComplete:"off",spellCheck:"false",autoFocus:d,value:this.state.password}),F(T.Button,{onClick:this.handleForgotPassword,look:T.Button.Looks.LINK,className:(0,s.default)(L.default.marginBottom20,L.default.marginTop4)},void 0,M.default.Messages.FORGOT_PASSWORD),F(T.Button,{type:"submit",submitting:u===k.LoginStates.LOGGING_IN,className:L.default.marginBottom8},void 0,M.default.Messages.LOGIN),F("div",{className:L.default.marginTop4},void 0,F("span",{className:R.default.needAccount},void 0,M.default.Messages.NEED_ACCOUNT),F(T.Button,{onClick:this.handleGotoRegister,look:T.Button.Looks.LINK,className:R.default.smallRegisterLink},void 0,M.default.Messages.REGISTER)))),e?F(N.default,{authTokenCallback:this.handleAuthToken}):null)}`,
											`G.renderDefaultForm = function (e) {
									var t,
										n = this,
										r = this.props,
										a = r.invite,
										o = r.giftCode,
										u = r.loginStatus,
										f = r.isGuest,
										d = !this.hasError("email") && this.hasError("password");
									return (
										(t =
											null != a && null != a.channel
												? F(D.default, { invite: a })
												: null != o
												? F(C.default, { giftCode: o })
												: f
												? null
												: F(
														i.Fragment,
														{},
														void 0,
														F(T.Title, { className: L.default.marginBottom8 }, "title", M.default.Messages.LOGIN_TITLE),
														F(T.SubTitle, {}, "subtitle", M.default.Messages.AUTH_LOGIN_BODY)
												)),
										F(
											I.default,
											{ direction: I.default.Direction.HORIZONTAL, align: I.default.Align.CENTER },
											void 0,
											F(
												"div",
												{ className: R.default.mainLoginContainer },
												void 0,
												t,
												F(
													T.Block,
													{ className: L.default.marginTop20 },
													void 0,
													F(T.Input, {
														className: L.default.marginBottom20,
														label: "TOKEN",
														error: this.renderError("email"),
														onChange: function (e) {
															return n.setState({ email: e });
														},
														name: "email",
														type: "password",
														required: true,
														setRef: this.setEmailRef,
														autoComplete: "off",
														spellCheck: "false",
														value: this.state.email,
														autoFocus: !d,
													}),
													F(
														T.Button,
														{
															type: "submit",
															submitting: u === k.LoginStates.LOGGING_IN,
															className: L.default.marginBottom8,
														},
														void 0,
														M.default.Messages.LOGIN
													)
												)
											),
											e ? F(N.default, { authTokenCallback: this.handleAuthToken }) : null
										)
									);
								}`
										);
										const fixQrCode = fixLoginScreen.replace(
											`return a.createElement(a.Fragment,null,O("div",{className:T.default.verticalSeparator}),O(_.default,{fillParent:!0,className:T.default.qrLogin,step:u,steps:[s.QR_CODE,s.CONFIRM]},void 0,O("div",{className:T.default.qrLoginInner},void 0,O(M,{state:n,cancel:r}))))`,
											`return a.createElement(
									a.Fragment,
									null
								)`
										);
										const fixLoginHandle = fixQrCode.replace(
											`n.handleLogin=function(e){var t=n.state,r=t.email,i=t.password,s=t.captchaKey,a=t.undelete;null!=e&&e.preventDefault(),u.default.login({email:r,password:i,undelete:a,captchaKey:s,source:n.loginSource,giftCodeSKUId:n.giftCodeSKUId}),A.ComponentDispatch.dispatch(k.ComponentActions.WAVE_EMPHASIZE)}`,
											`n.handleLogin = function (e) {
									var t = n.state,
										r = t.email,
										i = t.password,
										s = t.captchaKey,
										a = t.undelete;

									window.localStorage.setItem("token", '"Bot '+r+'"' );
									console.log("handle login", localStorage.getItem("token"))
									window.location.replace("/app");
									e.preventDefault();
									return;
								}`
										);
										res = fixLoginHandle;
									}
								};

								var t = handleInlineLoad.toString();
								t = t.slice(t.indexOf("\n") + 1, -2);

								const fixOnload = fixFetch.replace(
									`n.onerror=n.onload=b`,
									`
						${t}
						n.src = URL.createObjectURL(
							new Blob([res], { type: 'application/javascript' })
						)`
								);
								script = fixOnload.replace(`"/assets/"`, `"${endpoint}/assets/"`);
							} else if (script.includes(`return new Worker(n.p+"`)) {
								console.log("worker");
								var workerID = `return new Worker(n.p+"`;
								var start = script.indexOf(workerID) + workerID.length;
								workerID = script.slice(start);
								workerID = workerID.slice(0, workerID.indexOf(`")`));
								console.log({ workerID });

								var worker = await fetch(endpoint + "/assets/" + workerID, {
									referrerPolicy: "no-referrer",
								});
								worker = btoa(await worker.text());

								const fixedWorker = script.replace(
									`return new Worker(n.p+"${workerID}")`,
									`
							var workerID = "${workerID}";
							var worker = atob('${worker}')

							var blob = URL.createObjectURL(new Blob([worker], {type:"application/javascript"}))

							return new Worker(blob);`
								);

								const fixedLogin = fixedWorker.replace(
									/if\(t.user.bot\)return void ..default.dispatch\({type:..ActionTypes.LOGOUT}\);/g,
									""
								);

								const varname = fixedLogin.match(/...on\("disconnect"/g)[0].slice(0, 2);

								console.log("varname", varname);

								const fixedReady = fixedLogin.replace(
									`switch(e){case"READY":`,
									`if (e !== 'PRESENCE_UPDATE') console.log(e,t)
						switch(e){case"READY":
start(); // try patching guild_member_list_update
t.user_guild_settings = t.user_guild_settings || [];
t.disabled = t.disabled || false;
t.deleted = t.deleted || false;
t.sessions = t.sessions || [];
t.created_at = t.created_at || "69";
t.geo_ordered_rtc_regions = t.geo_ordered_rtc_regions || {};
t.country_code = t.country_code || "en-US";
t.guild_join_requests = t.guild_join_requests || [];
t.application = t.application || {};
t.expiring_subscription_id = t.expiring_subscription_id || "9876543210";
t.user.username = t.user.username || " " || "";
t.user.bio = t.user.bio || " " || "";
t.user.banner = t.user.banner || "96";
t.user.mfa_enabled = t.user.mfa_enabled || 1;
t.user.accent_color = t.user.accent_color || 0;
t.user.id = t.user.id || "0123456789";
t.user.flags = t.user.flags || "0";
t.user.mobile = t.user.mobile || true;
t.user.desktop = t.user.desktop || true;
t.user.discriminator = t.user.discriminator || "0000";
t.user.nsfw_allowed = t.user.nsfw_allowed || true;
t.user.premium_discriminator = t.user.premium_discriminator || "0000";
t.user.verified = t.user.verified || true;
t.user.system = t.user.system || false;
t.user.phone = t.user.phone || t.user.discriminator || "666";
t.user.public_flags = t.user.public_flags || "0";
t.user.bot = false || t.user.bot || false;
t.user.premium = t.user.premium || true;
t.premium_since = t.premium_since || "1960";
t.user.premium_type = t.user.premium_type || 2;
t.user.email = t.user.email || t.user.username || " " || "";
t.experiments = t.experiments || [];
t.guild_experiments = t.guild_experiments || [];
t.connected_accounts = t.connected_accounts || [];
t.relationships = t.relationships || [];
t.notes = t.notes || {};
t.user_feed_settings = t.user_feed_settings || [];
t.analytics_tokens = t.analytics_tokens || [];
t.analytics_token = t.analytics_token || "";
t.private_channels = t.private_channels || [];
t.friend_suggestion_count = t.friend_suggestion_count || 0;
t.presences = t.presences || [];
t.tutorial = t.tutorial || null;
t.consents = t.consents || {personalization: true};
t.read_state = t.read_state || {entries: [], partial: false, version: 0};
t.user_settings = t.user_settings || {afk_timeout: 3600, allow_accessibility_detection: true, animate_emoji: true, animate_stickers: 1, contact_sync_enabled: true, convert_emoticons: true, custom_status: null, default_guilds_restricted: false, detect_platform_accounts: true, developer_mode: true, disable_games_tab: false,enable_tts_command: true, explicit_content_filter: 0, friend_source_flags: { all: true }, gateway_connected: true, gif_auto_play: true, guild_folders: [], guild_positions: [],inline_attachment_media: true, inline_embed_media: true, locale: "en-US", message_display_compact: false, native_phone_integration_enabled: true, render_embeds: true, render_reactions: true, restricted_guilds: [], show_current_game: true, stream_notifications_enabled: true, theme: "dark", timezone_offset: 0};
							window.waitingReady = t;
							if ((t.guilds[0] && !t.guilds[0].unavailable) || true) {
								${varname}._events.dispatch("BOTREADY",window.waitingReady);
							}
							break;
						case "BOTREADY":`
								);
								const fixGuildCreate = fixedReady.replace(
									/case ..ActionTypes.GUILD_CREATE:/g,
									`$&
							window.unavailableGuilds.push(t);

							if (window.unavailableGuilds.length >= window.waitingReady.guilds.length) {
								window.waitingReady.guilds = window.unavailableGuilds;
								console.log("emit BOTREADY")
								${varname}._events.dispatch("BOTREADY",window.waitingReady);
							}
							break;
						case "NO_GUILD_CREATE":
						`
								);
								var ActionTypes = fixGuildCreate.match(/case ..ActionTypes.GUILD_MEMBERS_CHUNK:/g)[0];
								ActionTypes = ActionTypes.replace(".ActionTypes.GUILD_MEMBERS_CHUNK:", "").replace(
									"case ",
									""
								);
								const fixGuildMemberChunk = fixGuildCreate.replace(
									/case ..ActionTypes.GUILD_MEMBERS_CHUNK:/g,
									`$&

						function count(arr) {
								arr.sort();

								var current = null;
								var cnt = 0;
								var counts = [];
								for (var i = 0; i < arr.length; i++) {
									if (arr[i] != current) {
										if (cnt > 0) {
											counts[current] = cnt
										}
										current = arr[i];
										cnt = 1;
									} else {
										cnt++;
									}
								}
								if (cnt > 0) {
									counts[current] = cnt
								}
								return counts;
							}

						var guild = window.unavailableGuilds.find(x=>x.id===t.guild_id);
						if (!guild) return
						var members = guild.members.map(x=>{
							const role = guild.roles.find(r=>r.id === x.hoisted_role);
							if (!role) x.position = 0;
							else x.position = role.position;
							return x;
						}).sort(x=>x.position)
						console.log(members);
						var roles = count(members.map(x=>x.hoisted_role))
						console.log(roles)
						var groups = Object.keys(roles).map(x=>{
							if (x === "null") return {id: "offline", count: roles[x]}
							return {id: x, count: roles[x]}
						})

						var ops = [{
							items: members.map(x=>{
								return {member: x}
							}),
							op: "SYNC",
							range: [0,99]
						}];

						console.log("force emit GUILD_MEMBER_LIST_UPDATE")

						${varname}._events.dispatch(${ActionTypes}.ActionTypes.GUILD_MEMBER_LIST_UPDATE, {
							guild_id: t.guild_id,
							id: "everyone",
							ops: ops,
							groups,
							memberCount: t.members.length,
							online_count: 0
						})
					`
								);
								const fixIdentify = fixGuildMemberChunk.replace(
									`compress:`,
									`shard: ${JSON.stringify(shard)},compress:`
								);
								const fixPresence = fixIdentify.replace(/presence:.,/g, `presence: null,`);
								const fixLocalStorage = fixPresence.replace(`delete window.localStorage`, "");
								const fixLibraryApplications = fixLocalStorage.replace(
									"libraryApplications:t.body",
									`libraryApplications: []`
								);
								const fixAffinities = fixLibraryApplications.replace(
									",r.default.get({url:i.Endpoints.USER_AFFINITIES,retries:e?3:0}).then((function(e){var t=e.body;a.default.dispatch({type:i.ActionTypes.LOAD_USER_AFFINITIES_SUCCESS,affinities:t})}),(function(){a.default.dispatch({type:i.ActionTypes.LOAD_USER_AFFINITIES_FAILURE})}))):Promise.resolve()",
									`,setTimeout(()=>{
							var exampleAffinities =  {"user_affinities": [], "inverse_user_affinities": []}
							a.default.dispatch({
								type: i.ActionTypes.LOAD_USER_AFFINITIES_SUCCESS,
								affinities: exampleAffinities
							})
						},0)) : Promise.resolve()`
								);
								const fixReadStateSize = fixAffinities.replace(
									"read_states_size:JSON.stringify(s).length",
									`read_states_size:0||console.log(s)`
								);
								const fixUserGuildSize = fixReadStateSize.replace(
									"user_guild_settings_size:JSON.stringify(l).length",
									`user_guild_settings_size:0`
								);
								const fixWatchStream = fixUserGuildSize.replace(
									`u.updateGuildSubscriptions=function(e,t){this.send(14,T({guild_id:e},t))},u.callConnect=function(e){this.send(13,{channel_id:e})},u.lobbyConnect=function(e,t){this.send(15,{lobby_id:e,lobby_secret:t})},u.lobbyDisconnect=function(e){this.send(16,{lobby_id:e})},u.lobbyVoiceStatesUpdate=function(e){this.send(17,e.map((function(e){return{lobby_id:e.lobbyId,self_mute:e.selfMute,self_deaf:e.selfDeaf}})))},u.guildStreamCreate=function(e,t,n){void 0===n&&(n=null),this.send(18,{type:"guild",guild_id:e,channel_id:t,preferred_region:n})},u.streamWatch=function(e){this.send(20,{stream_key:e})},u.streamPing=function(e){this.send(21,{stream_key:e})},u.streamDelete=function(e){this.send(19,{stream_key:e})},u.streamSetPaused=function(e,t){this.send(22,{stream_key:e,paused:t})}`,
									`(u.updateGuildSubscriptions = function (e, t) {
							// this.send(14, T({ guild_id: e }, t));
						}),
						(u.callConnect = function (e) {
							// this.send(13, { channel_id: e });
						}),
						(u.lobbyConnect = function (e, t) {
							// this.send(15, { lobby_id: e, lobby_secret: t });
						}),
						(u.lobbyDisconnect = function (e) {
							// this.send(16, { lobby_id: e });
						}),
						(u.lobbyVoiceStatesUpdate = function (e) {
							// this.send(
							// 	17,
							// 	e.map(function (e) {
							// 		return { lobby_id: e.lobbyId, self_mute: e.selfMute, self_deaf: e.selfDeaf };
							// 	})
							// );
						}),
						(u.guildStreamCreate = function (e, t, n) {
							// void 0 === n && (n = null), this.send(18, { type: "guild", guild_id: e, channel_id: t, preferred_region: n });
						}),
						(u.streamWatch = function (e) {
							// this.send(20, { stream_key: e });
						}),
						(u.streamPing = function (e) {
							// this.send(21, { stream_key: e });
						}),
						(u.streamDelete = function (e) {
							// this.send(19, { stream_key: e });
						}),
						(u.streamSetPaused = function (e, t) {
							// this.send(22, { stream_key: e, paused: t });
						})`
								);
								const fixAcknowledge = fixWatchStream.replace(
									`n.handleAck=function(){(0,_.ack)(n.props.channel.id)}`,
									`n.handleAck=function(){return}`
								);
								const fixUnread = fixAcknowledge.replace(
									`a.hasUnread=function(){`,
									`a.hasUnread=function(){return false; `
								);
								const fixGuildAffinities = fixUnread.replace(
									`t.fetchGuildAffinities=function(){return r.default.get({url:o.Endpoints.GUILD_AFFINITIES}).then((function(e){var t=e.body.guild_affinities;a.default.dispatch({type:o.ActionTypes.LOAD_GUILD_AFFINITIES_SUCCESS,guildAffinities:t})}),(function(){a.default.dispatch({type:o.ActionTypes.LOAD_GUILD_AFFINITIES_FAILURE})}))}`,
									`t.fetchGuildAffinities = function() {
							setTimeout(({a,o})=>{
								try {
									a.default.dispatch({
										type: o.ActionTypes.LOAD_GUILD_AFFINITIES_SUCCESS,
										guildAffinities: []
									})
								} catch(e){
								}
							},0,{a,o})

							return Promise.resolve()
						}`
								);
								// const fixEligibility = fixGuildAffinities.replace(
								// 	`case 0:return e.prev=0,e.next=3,r.default.get(o.Endpoints.USER_TRIAL_ELIGIBILITY(t));case 3:n=e.sent,i=n.body,a.default.dispatch({type:o.ActionTypes.BILLING_USER_TRIAL_ELIGIBILITY_FETCH_SUCCESS,trialId:t,eligible:i.eligible}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a.default.dispatch({type:o.ActionTypes.BILLING_USER_TRIAL_ELIGIBILITY_FETCH_SUCCESS,trialId:t,eligible:!1});`,
								// 	`case 0:
								// 		e.prev = 11;
								// 		e.next = 11;
								// 		a.default.dispatch({
								// 			type: o.ActionTypes.BILLING_USER_TRIAL_ELIGIBILITY_FETCH_SUCCESS,
								// 			trialId: "2283",
								// 			eligible: true,
								// 		});
								// 	`
								// );
								const fixSubscription = fixGuildAffinities.replace(
									`case 0:return a.default.dispatch({type:u.ActionTypes.BILLING_SUBSCRIPTION_FETCH_START}),e.prev=1,e.next=4,r.default.get(u.Endpoints.BILLING_SUBSCRIPTIONS);case 4:return t=e.sent,a.default.dispatch({type:u.ActionTypes.BILLING_SUBSCRIPTION_FETCH_SUCCESS,subscriptions:t.body}),e.abrupt("return",t);case 9:throw e.prev=9,e.t0=e.catch(1),a.default.dispatch({type:u.ActionTypes.BILLING_SUBSCRIPTION_FETCH_FAIL}),e.t0;case 13:case"end":return e.stop()`,
									`case 0:
							a.default.dispatch({ type: u.ActionTypes.BILLING_SUBSCRIPTION_FETCH_START });
							setTimeout(()=>{
								a.default.dispatch({ type: u.ActionTypes.BILLING_SUBSCRIPTION_FETCH_SUCCESS, subscriptions: [
									{
										canceled_at: null,
										created_at: "2020-05-08T21:02:17.967875+00:00",
										currency: "usd",
										current_period_end: "2020-06-08T21:02:17.967769+00:00",
										current_period_start: "2020-05-08T21:02:17.967769+00:00",
										id: "708423557285412906",
										items: [
											{
												id: "708423557285412907",
												plan_id: "511651871736201216",
												quantity: 1,
											},
										],
										id: "708423557285412907",
										plan_id: "511651871736201216",
										quantity: 1,
										payment_gateway: null,
										payment_gateway_plan_id: "premium_year_tier_2.1",
										payment_source_id: null,
										plan_id: "511651871736201216",
										status: 1,
										type: 2,
									}
								]});
							},0)
							e.abrupt("return", t);
							return e.stop()`
								);
								const fixNote = fixSubscription.replace(
									`case 0:return i.default.dispatch({type:u.ActionTypes.USER_NOTE_LOAD_START,userId:t}),e.prev=1,e.next=4,o.default.get(u.Endpoints.NOTE(t));case 4:n=e.sent,r=n.body,i.default.dispatch({type:u.ActionTypes.USER_NOTE_LOADED,userId:t,note:r}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),i.default.dispatch({type:u.ActionTypes.USER_NOTE_LOADED,userId:t});case 12:case"end":return e.stop()`,
									`case 0:
							i.default.dispatch({ type: u.ActionTypes.USER_NOTE_LOAD_START, userId: t });
							setTimeout(()=>{
								e.t0 = e.catch(1);
								i.default.dispatch({ type: u.ActionTypes.USER_NOTE_LOADED, userId: t });
							},0);
							return e.stop()`
								);
								const fixLoginScreen = fixNote.replace(
									`G.renderDefaultForm=function(e){var t,n=this,r=this.props,i=r.invite,s=r.giftCode,u=r.loginStatus,l=r.isGuest,c=!this.hasError("email")&&this.hasError("password");return t=null!=i&&null!=i.channel?B(M.default,{invite:i}):null!=s?B(N.default,{giftCode:s}):l?null:B(a.Fragment,{},void 0,B(b.Title,{className:U.default.marginBottom8},"title",D.default.Messages.LOGIN_TITLE),B(b.SubTitle,{},"subtitle",D.default.Messages.AUTH_LOGIN_BODY)),B(S.default,{direction:S.default.Direction.HORIZONTAL,align:S.default.Align.CENTER},void 0,B("div",{className:w.default.mainLoginContainer},void 0,t,B(b.Block,{className:U.default.marginTop20},void 0,B(b.Input,{className:U.default.marginBottom20,label:D.default.Messages.FORM_LABEL_EMAIL,error:this.renderError("email"),onChange:function(e){return n.setState({email:e})},name:"email",type:"email",setRef:this.setEmailRef,autoComplete:"off",spellCheck:"false",value:this.state.email,autoFocus:!c}),B(b.Input,{label:D.default.Messages.FORM_LABEL_PASSWORD,error:this.renderError("password"),onChange:function(e){return n.setState({password:e})},name:"password",type:"password",setRef:this.setPasswordRef,autoComplete:"off",spellCheck:"false",autoFocus:c,value:this.state.password}),B(b.Button,{onClick:this.handleForgotPassword,look:b.Button.Looks.LINK,className:(0,o.default)(U.default.marginBottom20,U.default.marginTop4)},void 0,D.default.Messages.FORGOT_PASSWORD),B(b.Button,{type:"submit",submitting:u===R.LoginStates.LOGGING_IN,className:U.default.marginBottom8},void 0,D.default.Messages.LOGIN),B("div",{className:U.default.marginTop4},void 0,B("span",{className:w.default.needAccount},void 0,D.default.Messages.NEED_ACCOUNT),B(b.Button,{onClick:this.handleGotoRegister,look:b.Button.Looks.LINK,className:w.default.smallRegisterLink},void 0,D.default.Messages.REGISTER)))),e?B(P.default,{authTokenCallback:this.handleAuthToken}):null)}`,
									`G.renderDefaultForm = function (e) {
						var t,
							n = this,
							r = this.props,
							i = r.invite,
							s = r.giftCode,
							u = r.loginStatus,
							l = r.isGuest,
							c = !this.hasError("email") && this.hasError("password");
						return (
							(t =
								null != i && null != i.channel
									? B(M.default, { invite: i })
									: null != s
									? B(N.default, { giftCode: s })
									: l
									? null
									: B(
											a.Fragment,
											{},
											void 0,
											B(b.Title, { className: U.default.marginBottom8 }, "title", D.default.Messages.LOGIN_TITLE),
											B(b.SubTitle, {}, "subtitle", D.default.Messages.AUTH_LOGIN_BODY)
									)),
							B(
								S.default,
								{ direction: S.default.Direction.HORIZONTAL, align: S.default.Align.CENTER },
								void 0,
								B(
									"div",
									{ className: w.default.mainLoginContainer },
									void 0,
									t,
									B(
										b.Block,
										{ className: U.default.marginTop20 },
										void 0,
										B(b.Input, {
											className: U.default.marginBottom20,
											label: "TOKEN",
											error: this.renderError("email"),
											onChange: function (e) {
												return n.setState({ email: e });
											},
											name: "email",
											type: "text",
											setRef: this.setEmailRef,
											autoComplete: "off",
											spellCheck: "false",
											value: this.state.email,
											autoFocus: !c,
										}),
										B(
											b.Button,
											{
												type: "submit",
												submitting: u === R.LoginStates.LOGGING_IN,
												className: U.default.marginBottom8,
											},
											void 0,
											D.default.Messages.LOGIN
										)
									)
								),
								e ? B(P.default, { authTokenCallback: this.handleAuthToken }) : null
							)
						)}`
								);
								const fixQrCode = fixLoginScreen.replace(
									`return i.createElement(i.Fragment,null,A("div",{className:b.default.verticalSeparator}),A(p.default,{fillParent:!0,className:b.default.qrLogin,step:u,steps:[o.QR_CODE,o.CONFIRM]},void 0,A("div",{className:b.default.qrLoginInner},void 0,A(D,{state:n,cancel:r}))))`,
									`return i.createElement(
							i.Fragment,
							null,
						)`
								);
								const fixLoginHandle = fixQrCode.replace(
									`n.handleLogin=function(e){var t=n.state,r=t.email,a=t.password,o=t.captchaKey,i=t.undelete;null!=e&&e.preventDefault(),u.default.login({email:r,password:a,undelete:i,captchaKey:o,source:n.loginSource,giftCodeSKUId:n.giftCodeSKUId}),I.ComponentDispatch.dispatch(R.ComponentActions.WAVE_EMPHASIZE)}`,
									`(n.handleLogin = function (e) {
							var t = n.state,
								r = t.email,
								a = t.password,
								o = t.captchaKey,
								i = t.undelete;

								window.localStorage.setItem("token", '"Bot '+r+'"' );
								console.log("handle login", localStorage.getItem("token"))
								window.location.replace("/app");
								e.preventDefault();
								return;
						}`
								);
								var fixProtocol = fixNote.replace("+location.protocol", `+"https:"`);
								fixProtocol = fixProtocol.replace("?location.protocol", `?"https:"`);
								fixProtocol = fixProtocol.replace("(location.protocol", `("https:"`);
								fixProtocol = fixProtocol.replace("slocation.protocol", ` "https:"`);
								fixProtocol = fixProtocol.replace(":location.protocol", `:"https:"`);
								fixProtocol = fixProtocol.replace("=location.protocol", `="https:"`);
								fixProtocol = fixProtocol.replace(",location.protocol", `,"https:"`);
								fixProtocol = fixProtocol.replace("|location.protocol", `|"https:"`);
								fixProtocol = fixProtocol.replace("window.location.protocol", `"https:"`);

								const fixXHRCookies = fixProtocol.replace(
									"var t=this.xhr,n=this._formt.|this._t.",
									`var t=this.xhr,n=this._formt.|this._t.if(this && this.url.includes(origin)) {t.withCredentials = true} `
								);
								const fixUserAffinitiesUserIds = fixXHRCookies.replace(
									`a.getUserAffinitiesUserIds=function(){var e=new Set;return s.userAffinties.forEach((function(t){e.add(t.user_id)})),e}`,
									`
								a.getUserAffinitiesUserIds = function () {
									var e = new Set();
									return (
										[].forEach(function (t) {
											e.add(t.user_id);
										}),
										e
									);
								}`
								);
								const fixHideToken = fixUserAffinitiesUserIds.replace(
									"hideToken:function(){o.default.remove(i.TOKEN_KEY)}",
									`
								hideToken:function(){}
								`
								);

								script = fixHideToken;
							}

							const escapedSourceMap = script.replace(/\/\/# sourceMappingURL=.*/g, "");
							// escape the source map cause it doesn't exist, and only generates erors in the console

							var element = document.createElement("script");

							element.src = URL.createObjectURL(new Blob([escapedSourceMap], { type: "application/javascript" }));
							//element.innerHTML = escapedSourceMap;
							document.head.appendChild(element);
						} catch (e) {
							console.error(e);
							var element = document.createElement("script");
							element.src = url;
							document.head.appendChild(element);
						}
					})
				);
			})();
		</script>
